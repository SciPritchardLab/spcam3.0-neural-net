#include <misc.h>
#include <params.h>

module cloudbrain_module

!---------------------------------------------------------------------------------
! Purpose:
!
! Interface for Gentine-Pritchard machine learning scheme
! Let's rock the Casbah :)
! Author: Pierre Gentine and Mike Pritchard
!
!---------------------------------------------------------------------------------
  use shr_kind_mod,    only: r8 => shr_kind_r8
  use ppgrid,          only: pcols, pver, pverp
  use history,         only: outfld, addfld, add_default, phys_decomp
  use nt_FunctionsModule, only: nt_tansig
 use physconst,       only: gravit
  implicit none

  save

  private                         ! Make default type private to the module
! INSERT Pritch to Gentine: Please check these numbers. 
! Dimensions of neural net (must be consistent with numbers in define_neuralnet)
  integer, parameter :: hiddenlayerSize_wqv   = 20 ! Number of neurons (pritch to gentine: wasn't it 10?)
  integer, parameter :: hiddenlayerSize_wdse  = 20 ! Number of neurons (pritch to gentine: wasn't it 10?)
  integer, parameter :: hiddenlayerSize_rainsurf  = 20 ! Number of neurons (pritch to gentine: wasn't it 10?)
  integer, parameter :: hiddenlayerSize_qcl  = 20 ! Number of neurons (pritch to gentine: wasn't it 10?)
  integer, parameter :: hiddenlayerSize_qci  = 20 ! Number of neurons (pritch to gentine: wasn't it 10?)
  integer, parameter :: outputlayerSize       = 24 ! Number of vertical levels predictede by the NN
  integer, parameter :: nbhiddenlayers_wqv    = 1
  integer, parameter :: nbhiddenlayers_wdse   = 1
  integer, parameter :: nbhiddenlayers_rainsurf    = 1
  integer, parameter :: nbhiddenlayers_qcl    = 1
  integer, parameter :: nbhiddenlayers_qci    = 1
  integer, parameter :: inputlayerSize        = 74 ! Vertical dimension of training data. Pritch set to 30 to match pressure level vector sent by gentine
  !
! PUBLIC: interfaces
!
  public cloudbrain                 ! ML scheme
  public cloudbrainVerticalGrid
  public inputlayerSize
!
! Private data
!
contains

subroutine cloudbrain ( s,q,w,shf,lhf,ztodt,dsdt)
!----------------------------------------------------------------------- 
! 
! Purpose:
! Main driver for Gentine-Pritchard marchine learning convection scheme
! 
! Method: 
! performs deep convective adjustment based on deep learning !
! Author:Pierre Gentine and Mike Pritchard.
!
! This is contributed code not fully standardized by the CAM core group.
! All variables have been typed, where most are identified in comments
! The current procedure will be reimplemented in a subsequent version
! of the CAM where it will include a more straightforward formulation
! and will make use of the standard CAM nomenclature
! 
!-----------------------------------------------------------------------

! model state profiles pre-interpolated to NN-fixed-grid:
real (r8), intent(in) :: s(inputlayerSize) ! dry static energy
real (r8), intent(in) :: q(inputlayerSize) ! q
real (r8), intent(in) :: w(inputlayerSize) ! w (m/s)
real (r8), intent(in) :: shf,lhf ! model shf,lhf
real(r8), intent(in) :: ztodt         ! 2 delta t (model time increment)
real (r8), intent(inout) :: dsdt(inputlayerSize) ! NN-predicted tendency of DSE
real (r8), intent(inout) :: dqdt(inputlayerSize) ! NN-predicted tendency of qv
! (will be interpolated downstream back to GCM vertical grid)

! Essence of neural net (will be defined in define_neuralnet)
real(r8) :: mu_in_wdse(inputlayerSize) ! normalization input mean
real(r8) :: std_in_wdse(inputlayerSize)  ! normalization input standard deviation
real(r8) :: bias_input_wdse(hiddenlayerSize_wqv)
real(r8) :: bias_output_wdse(hiddenlayerSize_wqv)
real(r8) :: weights_input_wdse(hiddenlayerSize_wqv,inputlayerSize)
real(r8) :: weights_output_wdse(outputlayerSize,hiddenlayerSize_wqv)
real(r8) :: mu_in_wqv(inputlayerSize) ! normalization input mean
real(r8) :: std_in_wqv(inputlayerSize)  ! normalization input standard deviation
real(r8) :: bias_input_wqv(hiddenlayerSize_wqv)
real(r8) :: bias_output_wqv(hiddenlayerSize_wqv)
real(r8) :: weights_input_wqv(hiddenlayerSize_wqv,inputlayerSize)
real(r8) :: weights_output_wqv(outputlayerSize,hiddenlayerSize_wqv)
!-------

real(r8) :: input(inputlayerSize) ! master array to contain all input fields from GCM
real(r8) :: output(outputlayerSize) ! results from neural net given the input above.
real(r8) :: h(hiddenlayerSize_wqv) 

integer :: i,j

call define_neuralnet (mu_in_wdse, std_in_wdse, weights_input_wdse, bias_input_wdse, bias_output_wdse,weights_output_wdse)

    input(1:inputlayerSize)  = s(1:inputlayerSize)
    input(inputlayerSize+1:2*inputlayerSize)    = q(1:inputlayerSize)
    input(2*inputlayerSize+1:3*inputlayerSize)  = w(1:inputlayerSize)
    input(3*inputlayerSize+1)    = shf
    input(3*inputlayerSize+2)    = lhf

    ! Mike: this example is for wqv flux
    ! Normalize data
    input(:)     =  (input(:)-mu_in_wdse(:))/std_in_wdse(:)

    ! input layer weights+bias and then take tansig of result
    h(:) = 0.
    do i = 1,hiddenlayerSize_wdse
        h(i) = h(i) + bias_input_wdse(i)
        do j = 1,inputlayerSize
            h(i) = h(i) + weights_input_wdse(i,j)*input(j)
        end do
    h(i) = nt_tansig(h(i))
    end do

    ! only one first hidden layer for now
    !do k = 1,nbhiddenlayers_wqv-1
    !    h(:) = 0.
    !    do i = 1,hiddenlayerSize_wqv
    !        do j = 1,inputlayerSize
    !            h(i) = nt_tansig(bias(i,j) + weights(k,i,j)*input(j))
    !        end do
    !    end do
    !end do


    ! output layer
    output(:) = 0.
    do i = 1,outputlayerSize_wdse
        output(i) = output(i) + bias_output_wdse(i)
        do j = 1,hiddenlayerSize_wdse
            output(i) = output(i) + weights_output_wdse(i,j)*h(j)
        end do
    end do
    ! now we have the profile of wqv flux ;-) (24 sigma-levels for now)
    do i=1,pver
        dsdt(i) = 0.
    end do
    ! Pritch to gentine, where is dpp defined? What is the vertical grid of the output
    ! space? Based on dim sizes, it appears to be a different grid than the
    ! input.
    do i = 1,outputlayerSize-1
         ! Pritch commented this out becuase dpp undefined:
!        dsdt(i) = gravit*(2.*delt)/dpp(kk,i)*(output(i) - output(i+1)) ! tendency: TO MIKE: I don't know why they use 2*delta t
!thorughout for the time step instead of delta t... also I am not sure
!whther we should use gravit or rgrav for the conversion from z to Pa.
    end do


    call define_neuralnet (mu_in_wqv, std_in_wqv, weights_input_wqv, bias_input_wqv, bias_output_wqv,weights_output_wqv)

    input(1:inputlayerSize)  = s(1:inputlayerSize)
    input(inputlayerSize+1:2*inputlayerSize)    = q(1:inputlayerSize)
    input(2*inputlayerSize+1:3*inputlayerSize)  = w(1:inputlayerSize)
    input(3*inputlayerSize+1)    = shf
    input(3*inputlayerSize+2)    = lhf

    ! Mike: this example is for wqv flux
    ! Normalize data
    input(:)     =  (input(:)-mu_in_wqv(:))/std_in_wqv(:)

    ! input layer weights+bias and then take tansig of result
    h(:) = 0.
    do i = 1,hiddenlayerSize_wqv
        h(i) = h(i) + bias_input_wqv(i)
        do j = 1,inputlayerSize
            h(i) = h(i) + weights_input_wqv(i,j)*input(j)
        end do
        h(i) = nt_tansig(h(i))
    end do

! only one first hidden layer for now
!do k = 1,nbhiddenlayers_wqv-1
!    h(:) = 0.
!    do i = 1,hiddenlayerSize_wqv
!        do j = 1,inputlayerSize
!            h(i) = nt_tansig(bias(i,j) + weights(k,i,j)*input(j))
!        end do
!    end do
!end do


    ! output layer
    output(:) = 0.
    do i = 1,outputlayerSize_wqv
        output(i) = output(i) + bias_output_wqv(i)
        do j = 1,hiddenlayerSize_wqv
            output(i) = output(i) + weights_output_wqv(i,j)*h(j)
        end do
    end do
    ! now we have the profile of wqv flux ;-) (24 sigma-levels for now)
    do i=1,pver
        dqdt(i) = 0.
    end do
    ! Pritch to gentine, where is dpp defined? What is the vertical grid of the output
    ! space? Based on dim sizes, it appears to be a different grid than the
    ! input.
    do i = 1,outputlayerSize-1
    ! Pritch commented this out becuase dpp undefined:
    !        dsdt(i) = gravit*(2.*delt)/dpp(kk,i)*(output(i) - output(i+1)) ! tendency: TO MIKE: I don't know why they use 2*delta t
    !thorughout for the time step instead of delta t... also I am not sure
    !whther we should use gravit or rgrav for the conversion from z to Pa.
    end do





! END GENTINE ADDITIONS




   return
end subroutine cloudbrain










subroutine define_neuralnet_wqv (mu_in_wdse, std_in_wdse, weights_input_wdse, &
                                  bias_input_wdse,bias_output_wdse, weights_output_wdse)
real(r8), intent(out) :: mu_in_wdse(inputlayerSize)
real(r8), intent(out) :: std_in_wdse(inputlayerSize)
real(r8), intent(out) :: bias_input_wdse(hiddenlayerSize_wdse)
real(r8), intent(out) :: bias_output_wdse(hiddenlayerSize_wdse)
real(r8), intent(out) :: weights_input_wdse(hiddenlayerSize_wdse,inputlayerSize)
real(r8), intent(out) :: weights_output_wdse(outputlayerSize,hiddenlayerSize_wdse)


!normalization
mu_in_wdse(:)    = (/290.986482,291.160276,291.369437,291.671911,292.156644,292.824394,293.633178,295.239962,297.537474,300.072793,302.802806,305.694461,308.147839,310.152554,312.048464,314.177671,316.612056,319.356528,323.085734,327.468984,333.287859,340.230398,347.722565,360.059747,0.010734,0.010608,0.010383,0.009952,0.009274,0.008554,0.007877,0.006714,0.005130,0.003606,0.002393,0.001443,0.000843,0.000479,0.000258,0.000130,0.000066,0.000036,0.000014,0.000006,0.000004,0.000004,0.000004,0.000004,-0.000018,-0.000034,-0.000047,-0.000048,-0.000041,-0.000032,-0.000027,-0.000027,-0.000028,-0.000021,-0.000008,-0.000043,-0.000044,0.000023,0.000049,0.000050,0.000089,0.000077,0.000045,0.000023,0.000011,0.000006,0.000003,0.000000,12.156107,77.572286/)
std_in_wdse(:) = (/9.273619,9.264450,9.286544,9.357647,9.507541,9.703524,9.927421,10.369341,10.952799,11.571941,12.367152,13.542982,14.745508,15.703428,15.877918,14.971957,13.156540,10.906824,8.207128,5.985580,3.883993,2.831051,2.654340,2.244025,0.005378,0.005335,0.005246,0.005048,0.004748,0.004484,0.004244,0.003788,0.003070,0.002330,0.001758,0.001204,0.000779,0.000486,0.000285,0.000153,0.000081,0.000045,0.000019,0.000006,0.000002,0.000001,0.000001,0.000001,0.002870,0.005666,0.007888,0.009511,0.010851,0.012191,0.013545,0.015413,0.017053,0.018933,0.021285,0.023856,0.025488,0.026213,0.026707,0.026811,0.024668,0.015465,0.009132,0.005407,0.002946,0.001569,0.000833,0.000217,5.475639,36.830774/)
! NN biases and weights
bias_input_wdse(:) = (/ 0.262494,-0.207454,0.317270,0.232801,0.182853,-0.245235,0.198371,0.257751,0.203319,-0.230282,-0.179303,-0.222696,-0.287486,-0.084991,-0.185055,-0.208262,0.211695,0.288956,-0.153054,0.306501/)
bias_output_wdse(:) = (/ 0.384116,0.449207,0.375467,0.180099,0.052649,0.089606,0.173855,0.136309,0.064444,-0.073280,-0.120558,-0.407986,-0.413371,-0.500387,-0.449433,-0.540664,-0.464110,-0.426670,-0.010926,-0.159960,-0.015902,0.150204,0.221322,-0.143551/)
weights_input_wdse(:,:) = reshape((/  0.009499,-0.006357,0.001316,0.001011,-0.003611,-0.016645,-0.004912,0.024432,-0.003733,-0.009114,-0.000093,-0.013715,0.009661,-0.017397,0.003462,-0.001814,-0.000045,-0.002183,-0.001981,-0.002635,-0.001915,0.000912,0.002291,-0.000813,-0.031577,0.022680,-0.008499,-0.004304,-0.002499,0.002054,-0.008417,0.011714,-0.003870,-0.000671,0.000546,-0.001905,0.000932,-0.000685,-0.000006,-0.001155,0.002039,-0.001935,-0.001820,-0.000094,-0.000784,-0.000574,0.000291,0.000053,-0.000874,0.001403,0.003765,0.004269,0.002457,-0.008271,-0.011841,-0.000609,0.009369,0.000004,-0.005198,0.002736,0.000704,-0.002904,0.004355,-0.009203,0.005153,0.014076,-0.014071,-0.008431,0.000057,0.000826,-0.000576,-0.000056,0.001466,-0.003099,-0.013088,0.007785,-0.000781,-0.000738,0.003924,0.023652,0.007345,-0.034903,0.006028,0.012926,-0.000120,0.019964,-0.014560,0.025545,-0.004972,0.002413,-0.000055,0.003212,0.002761,0.003659,0.002771,-0.001247,-0.003275,0.001146,0.044831,-0.033137,0.012351,0.005585,0.003482,-0.002565,0.011532,-0.016502,0.005647,0.000763,-0.000784,0.002731,-0.001315,0.000990,0.000022,0.001575,-0.002783,0.002679,0.002631,0.000116,0.001102,0.000833,-0.000447,-0.000060,-0.001415,-0.002341,0.007819,0.007421,-0.011843,-0.009713,0.008626,0.013956,-0.026659,0.002953,-0.004761,0.003246,-0.002291,0.005074,-0.005303,0.005428,-0.007988,0.010132,-0.008901,0.004349,0.001963,-0.002191,-0.000386,-0.000037,-0.002109,0.004373,0.011558,-0.008210,-0.000382,0.003048,-0.003728,-0.020559,-0.005220,0.028782,-0.004579,-0.010792,-0.000614,-0.015717,0.011085,-0.020637,0.003945,-0.001996,-0.000006,-0.002705,-0.002220,-0.002932,-0.002167,0.001011,0.002633,-0.000953,-0.036851,0.027994,-0.010683,-0.003741,-0.002741,0.001365,-0.009254,0.013339,-0.004419,-0.000680,0.000517,-0.002174,0.001063,-0.000793,-0.000030,-0.001195,0.002132,-0.002071,-0.002105,-0.000105,-0.000838,-0.000659,0.000329,0.000056,0.001280,-0.004260,-0.016823,0.001720,0.034653,0.004041,-0.045462,0.027289,-0.008682,0.002206,0.001496,0.000624,-0.005812,0.007895,-0.009173,0.003803,-0.010057,0.025051,-0.012153,0.009507,-0.004152,0.000712,0.000685,0.000094,0.001658,-0.003485,0.016314,-0.012255,0.001485,0.004436,-0.005840,-0.027582,-0.010071,0.041011,-0.006441,-0.015408,-0.000433,-0.024278,0.017438,-0.031052,0.006055,-0.002738,0.000213,-0.003764,-0.003226,-0.004237,-0.003271,0.001438,0.003850,-0.001356,-0.053593,0.041038,-0.015512,-0.005434,-0.004109,0.003222,-0.013863,0.019454,-0.006551,-0.000993,0.000933,-0.003241,0.001609,-0.001191,-0.000031,-0.001757,0.003157,-0.003026,-0.003011,-0.000146,-0.001232,-0.000980,0.000525,0.000069,-0.001018,0.001100,0.000543,0.001256,0.004198,-0.007637,-0.008417,0.018591,-0.010490,-0.001320,0.004855,-0.000895,-0.011216,-0.001993,-0.005970,0.008939,-0.000716,-0.002741,0.006767,-0.008727,0.004105,0.000976,-0.001932,-0.000192,0.002379,-0.005009,0.013851,-0.009001,0.001824,0.000698,-0.004258,-0.025361,-0.007277,0.036141,-0.005472,-0.013239,-0.000100,-0.020078,0.014384,-0.026130,0.005180,-0.002506,0.000066,-0.003277,-0.002843,-0.003818,-0.002945,0.001298,0.003436,-0.001198,-0.046548,0.034580,-0.012733,-0.006040,-0.003749,0.002760,-0.012334,0.017299,-0.005878,-0.000748,0.000787,-0.002820,0.001364,-0.001002,-0.000047,-0.001622,0.002921,-0.002796,-0.002748,-0.000112,-0.001155,-0.000864,0.000467,0.000063,0.000195,0.002129,-0.002749,-0.001021,0.013628,0.011112,-0.004249,-0.030657,-0.005114,0.009252,-0.002939,0.000821,-0.004672,0.002310,0.001162,-0.004542,0.006930,-0.007537,0.007703,-0.005839,0.000182,0.005576,0.002025,0.000167,0.002135,-0.004518,-0.016386,0.012676,-0.001525,-0.005371,0.006060,0.028543,0.009787,-0.041492,0.007049,0.015340,0.000464,0.025129,-0.017901,0.032042,-0.006288,0.002700,-0.000306,0.003938,0.003234,0.004322,0.003286,-0.001458,-0.003904,0.001383,0.054243,-0.041506,0.015822,0.005073,0.003986,-0.002410,0.013225,-0.019533,0.006712,0.000996,-0.000929,0.003276,-0.001621,0.001206,0.000037,0.001774,-0.003164,0.003048,0.003041,0.000155,0.001230,0.000995,-0.000525,-0.000071,0.000802,-0.003648,-0.002544,0.006248,0.006112,-0.000678,-0.014315,0.010163,-0.002800,0.004214,-0.011333,0.018531,-0.017605,0.009572,0.012097,-0.004528,0.005209,-0.006429,0.003456,-0.001292,-0.000977,-0.000423,0.001333,0.000109,-0.002424,0.005067,0.014436,-0.008950,0.000515,0.000892,-0.003552,-0.023721,-0.009005,0.036105,-0.005789,-0.013711,0.000217,-0.020780,0.015291,-0.026542,0.005137,-0.002450,-0.000006,-0.003335,-0.002823,-0.003839,-0.002873,0.001284,0.003409,-0.001192,-0.047776,0.036258,-0.013613,-0.005941,-0.003388,0.003496,-0.012977,0.017442,-0.005840,-0.000875,0.000872,-0.002851,0.001421,-0.001093,-0.000024,-0.001596,0.002964,-0.002898,-0.002650,-0.000204,-0.001106,-0.000873,0.000465,0.000063,0.000455,0.001329,-0.003767,0.000696,0.011054,-0.008069,-0.026030,0.019388,0.002971,-0.007750,0.005386,0.001897,0.005881,-0.001090,-0.005636,-0.001374,0.020717,-0.017147,-0.013271,0.013006,0.003124,0.003335,0.000676,0.000082,0.002144,-0.004508,0.016269,-0.012778,0.001456,0.005753,-0.006176,-0.028351,-0.009384,0.040857,-0.007098,-0.015209,-0.000327,-0.024769,0.017328,-0.031563,0.006181,-0.002621,0.000308,-0.003910,-0.003182,-0.004251,-0.003223,0.001452,0.003828,-0.001364,-0.053664,0.041138,-0.015597,-0.004904,-0.003891,0.002252,-0.012913,0.019190,-0.006552,-0.001026,0.000926,-0.003233,0.001608,-0.001192,-0.000030,-0.001737,0.003096,-0.002998,-0.002990,-0.000155,-0.001201,-0.000971,0.000502,0.000074,-0.001011,0.003473,0.002897,-0.005817,-0.006333,0.000557,0.014680,-0.011926,0.004895,-0.003415,0.004152,-0.001938,-0.006499,0.011848,-0.003546,0.012221,-0.007653,0.006228,-0.006193,0.002644,0.000086,-0.000006,-0.001356,-0.000100,0.002387,-0.004978,0.014009,-0.008934,0.001182,0.001283,-0.004170,-0.025256,-0.008134,0.037071,-0.006094,-0.013487,-0.000032,-0.021499,0.015573,-0.027258,0.005323,-0.002532,0.000119,-0.003369,-0.002941,-0.003854,-0.002946,0.001306,0.003479,-0.001212,-0.047402,0.035116,-0.013142,-0.005848,-0.003627,0.002738,-0.012272,0.017490,-0.005938,-0.000825,0.000832,-0.002901,0.001414,-0.001062,-0.000029,-0.001646,0.002927,-0.002813,-0.002786,-0.000122,-0.001155,-0.000880,0.000471,0.000063,-0.000274,0.001140,-0.003458,-0.003544,0.006912,0.003328,-0.005110,-0.008122,0.016341,-0.022940,-0.001193,-0.001022,0.007801,-0.009254,0.007264,-0.007513,0.008200,-0.007710,0.005967,-0.001308,-0.001816,-0.000039,-0.001018,-0.000082,0.002170,-0.004578,-0.011685,0.007686,-0.000708,-0.000952,0.003173,0.019906,0.006974,-0.029932,0.004518,0.010787,0.000220,0.015633,-0.010678,0.020694,-0.004121,0.002106,0.000011,0.002651,0.002378,0.003026,0.002341,-0.001059,-0.002751,0.000967,0.038048,-0.027890,0.010260,0.004834,0.003115,-0.003133,0.010882,-0.014087,0.004556,0.000759,-0.000643,0.002289,-0.001090,0.000806,0.000057,0.001262,-0.002369,0.002331,0.002176,0.000129,0.000894,0.000712,-0.000377,-0.000052,0.001500,0.001664,0.002195,-0.003598,-0.012136,-0.002655,0.003917,-0.012609,0.014843,0.001621,-0.014174,0.011518,-0.003282,-0.001734,0.000572,0.007386,-0.018545,0.014514,0.003799,-0.008349,0.012532,0.000266,-0.001689,-0.000208,-0.001736,0.003688,-0.014657,0.009794,-0.001733,-0.002389,0.005088,0.025580,0.008900,-0.037003,0.005759,0.013795,0.000088,0.021591,-0.016720,0.028293,-0.005408,0.002452,0.000058,0.003384,0.003015,0.003961,0.003077,-0.001337,-0.003607,0.001266,0.048984,-0.035688,0.013120,0.005769,0.003769,-0.003194,0.012857,-0.017760,0.006123,0.000856,-0.000872,0.002954,-0.001464,0.001107,-0.000026,0.001779,-0.003001,0.002813,0.002936,0.000090,0.001229,0.000891,-0.000482,-0.000066,0.000443,-0.006140,-0.007907,0.002678,0.008531,0.002167,-0.017956,-0.003474,-0.008776,0.012640,0.002180,-0.002499,-0.000533,0.005968,-0.005288,-0.002358,0.013032,-0.014750,0.008519,-0.004414,0.007722,-0.009493,-0.006628,-0.000606,-0.002325,0.004787,-0.016397,0.012007,-0.001673,-0.004378,0.006268,0.028365,0.010312,-0.042300,0.006737,0.015863,0.000266,0.024924,-0.017532,0.032052,-0.006309,0.002788,-0.000252,0.003902,0.003324,0.004396,0.003394,-0.001479,-0.004004,0.001401,0.055070,-0.042060,0.015886,0.005640,0.004409,-0.003236,0.014098,-0.020075,0.006825,0.000986,-0.000971,0.003341,-0.001643,0.001212,0.000045,0.001840,-0.003285,0.003142,0.003136,0.000149,0.001282,0.001018,-0.000547,-0.000071,0.000579,-0.001853,0.000198,0.000337,-0.004266,0.006395,0.007712,-0.017659,0.010933,-0.003226,-0.000537,0.003932,-0.008235,-0.010219,0.005277,0.000999,0.000176,0.003581,-0.006914,0.008041,-0.003354,-0.001344,0.001610,0.000154,-0.002476,0.005187,-0.014176,0.011142,-0.001173,-0.004825,0.005169,0.024573,0.007867,-0.035064,0.005807,0.013450,-0.000053,0.020787,-0.014386,0.026770,-0.005167,0.002356,-0.000187,0.003331,0.002755,0.003645,0.002746,-0.001276,-0.003254,0.001175,0.046369,-0.035512,0.013481,0.004265,0.003446,-0.001774,0.010996,-0.016395,0.005565,0.000852,-0.000715,0.002723,-0.001338,0.001001,0.000020,0.001510,-0.002694,0.002593,0.002578,0.000131,0.001035,0.000824,-0.000421,-0.000065,0.000492,-0.002096,0.000344,0.002856,-0.001904,0.000914,-0.001403,-0.002839,0.009300,-0.017042,0.019635,-0.013073,-0.001271,0.002350,0.011382,-0.016346,0.000227,-0.002995,0.002156,-0.002783,0.002809,-0.000584,0.000174,-0.000004,-0.002053,0.004294,-0.015122,0.007877,-0.001778,-0.000736,0.005073,0.030200,0.010733,-0.044045,0.005688,0.014941,0.001377,0.026392,-0.021975,0.033862,-0.006198,0.003201,-0.000467,0.003913,0.003721,0.004798,0.004076,-0.001585,-0.004503,0.001507,0.053072,-0.035200,0.014109,0.010113,0.003272,-0.005428,0.016082,-0.021340,0.007421,0.000708,-0.000985,0.003698,-0.001907,0.001434,-0.000017,0.002068,-0.003764,0.003526,0.003667,0.000038,0.001561,0.001176,-0.000747,-0.000025,0.050819,0.063038,-0.067287,-0.077287,0.077176,0.063616,-0.124606,0.069007,-0.026982,0.001795,0.008399,-0.006471,0.002203,0.003874,-0.006409,0.000156,-0.000363,-0.001781,-0.009060,0.012649,-0.001190,-0.007869,-0.002837,-0.000164,-0.002463,0.005858,-0.013488,0.010901,-0.000827,-0.004263,0.003197,0.021916,0.009114,-0.033031,0.005339,0.011405,0.000733,0.017470,-0.012743,0.022553,-0.004328,0.002406,0.000187,0.002651,0.002673,0.003312,0.002582,-0.001119,-0.003052,0.001065,0.041098,-0.029367,0.011604,0.004809,0.002752,-0.004349,0.013076,-0.015620,0.005195,0.000747,-0.000670,0.002465,-0.001216,0.000897,0.000081,0.001350,-0.002405,0.002309,0.002571,0.000034,0.001028,0.000744,-0.000393,-0.000055,0.011186,0.006504,-0.032006,-0.037433,0.010093,0.034324,0.000272,-0.000410,-0.017701,0.014560,-0.011402,0.006918,-0.004829,-0.000904,0.003811,-0.005105,0.007566,-0.006023,0.002028,-0.014010,0.006059,0.003319,0.001435,0.000090,-0.001851,0.004064,-0.015662,0.010862,-0.001480,-0.002595,0.005440,0.026711,0.009272,-0.039713,0.005916,0.014906,0.000346,0.023318,-0.017139,0.030283,-0.005951,0.002657,-0.000227,0.003695,0.003159,0.004163,0.003194,-0.001400,-0.003769,0.001312,0.051926,-0.038950,0.014658,0.005903,0.003937,-0.003064,0.013134,-0.018799,0.006386,0.000915,-0.000913,0.003145,-0.001524,0.001134,0.000022,0.001795,-0.003161,0.003010,0.003004,0.000125,0.001239,0.000954,-0.000516,-0.000066,0.001694,-0.001368,-0.002657,0.000825,0.001410,0.003269,-0.005742,-0.001296,0.007151,-0.001842,-0.003441,-0.009397,-0.003923,0.016333,-0.021360,0.017864,-0.007248,0.001119,-0.002552,0.001098,0.000179,-0.000093,0.001355,0.000113,-0.002348,0.004929,0.015820,-0.011080,0.001474,0.002881,-0.005156,-0.027246,-0.009552,0.040322,-0.006382,-0.015160,-0.000042,-0.023381,0.016947,-0.030462,0.005986,-0.002637,0.000187,-0.003726,-0.003153,-0.004198,-0.003228,0.001414,0.003797,-0.001325,-0.052538,0.039777,-0.014891,-0.005833,-0.003873,0.002955,-0.013418,0.019077,-0.006472,-0.000934,0.000928,-0.003171,0.001541,-0.001145,-0.000040,-0.001789,0.003180,-0.003029,-0.003007,-0.000135,-0.001234,-0.000965,0.000523,0.000064,-0.001131,0.001722,0.001329,-0.001111,0.000435,-0.004469,0.000457,0.006937,-0.008347,0.009862,-0.008373,-0.011081,0.004929,-0.009729,0.016094,-0.017662,0.011801,-0.005005,0.001975,0.000898,0.000748,0.000593,-0.001162,-0.000100,0.002362,-0.004971,0.014819,-0.011779,0.001093,0.005526,-0.005463,-0.025678,-0.008152,0.036579,-0.006472,-0.013654,-0.000207,-0.021785,0.014806,-0.027694,0.005376,-0.002415,0.000239,-0.003503,-0.002844,-0.003792,-0.002845,0.001329,0.003387,-0.001226,-0.048268,0.037070,-0.014042,-0.004287,-0.003470,0.001680,-0.011352,0.017065,-0.005796,-0.000917,0.000773,-0.002868,0.001425,-0.001058,-0.000031,-0.001544,0.002759,-0.002672,-0.002664,-0.000138,-0.001061,-0.000861,0.000435,0.000069,-0.000694,0.002375,0.000544,-0.003964,-0.000702,0.000051,0.005858,-0.003738,-0.001793,0.006015,-0.010907,0.014969,-0.019734,0.017437,-0.014523,0.001435,-0.008157,0.004775,-0.005665,0.004038,-0.001938,0.000042,-0.000706,-0.000042,0.002123,-0.004457,-0.013730,0.008294,-0.000076,-0.001029,0.003295,0.022388,0.008604,-0.034266,0.005387,0.013169,0.000257,0.018481,-0.013933,0.025089,-0.004888,0.002395,0.000099,0.003037,0.002935,0.003612,0.002898,-0.001249,-0.003366,0.001169,0.045217,-0.031537,0.011561,0.005884,0.003283,-0.003793,0.012470,-0.016515,0.005611,0.000793,-0.000784,0.002729,-0.001310,0.000988,0.000031,0.001602,-0.002741,0.002628,0.002822,0.000050,0.001162,0.000859,-0.000484,-0.000056,0.003490,-0.003091,-0.012344,0.002747,0.025988,0.020091,-0.017447,0.003186,-0.001029,0.003515,-0.010232,0.008227,-0.001046,0.000178,-0.000553,-0.000604,0.002720,0.004044,-0.004978,-0.014501,0.025086,-0.003728,-0.007024,-0.000722,-0.002159,0.004431,0.012644,-0.009303,0.000303,0.004344,-0.004609,-0.022801,-0.006882,0.032383,-0.005501,-0.011993,-0.000018,-0.018943,0.013183,-0.024223,0.004675,-0.002172,0.000072,-0.003062,-0.002481,-0.003335,-0.002450,0.001168,0.002962,-0.001072,-0.041756,0.032035,-0.012344,-0.003801,-0.003276,0.001631,-0.010341,0.015109,-0.005097,-0.000767,0.000642,-0.002484,0.001211,-0.000912,-0.000004,-0.001393,0.002423,-0.002339,-0.002354,-0.000118,-0.000933,-0.000752,0.000372,0.000065,0.000415,0.000232,-0.006605,-0.001828,0.013944,0.001779,-0.015464,0.010175,-0.008144,0.008147,-0.004906,-0.003738,0.011097,-0.013439,0.005516,0.013778,-0.024962,0.007560,-0.010577,0.005616,-0.003448,0.000117,-0.000134,0.000016,0.001858,-0.003923/), (/hiddenlayerSize_wdse,inputlayerSize/))
 weights_output_wdse(:,:) = reshape((/  0.574406,-0.049949,-1.924616,0.097695,1.009557,-0.125841,-0.627109,0.234655,-0.865346,0.043432,-1.598465,-0.128305,-0.878312,1.572817,-1.374146,-0.204737,0.202601,0.014742,0.529543,-0.935043,0.544387,0.247457,-1.948624,0.091029,0.886984,-0.052096,-0.614503,-0.075346,-1.011393,-0.327797,-1.456880,-0.070417,-0.713696,0.922970,-1.799890,-0.118981,0.168240,0.084532,0.709299,-0.786811,0.331665,0.235206,-1.465259,0.094077,0.809318,0.199169,-0.628179,-0.528657,-0.923447,-0.832144,-1.266088,-0.080729,-0.557924,0.396551,-1.951005,0.053513,0.077082,0.078161,1.038720,-0.431692,-0.105882,-0.216002,-0.528974,-0.002397,0.690543,0.435118,-0.677822,-0.808332,-0.536925,-1.315539,-1.053736,-0.075670,-0.424902,0.152569,-1.513711,0.205621,-0.080981,0.038404,1.378205,0.013217,-0.578428,-0.705381,0.036327,-0.258886,0.378293,0.285001,-0.781183,-0.545396,-0.182658,-1.570619,-0.982183,0.069865,-0.389034,0.100300,-0.762910,0.156129,-0.180325,0.125548,1.531794,0.128737,-0.866519,-0.808148,-0.162206,-0.476312,-0.215164,-0.161657,-0.865410,0.015093,-0.200017,-1.575908,-1.097470,0.216056,-0.464087,0.024094,-0.209174,-0.078798,-0.075416,0.345887,1.439282,-0.173525,-0.914294,-0.688941,-0.475217,-0.312559,-1.003463,-0.317874,-0.772505,0.180660,-0.512819,-1.416213,-1.238874,0.014273,-0.542035,-0.062609,0.020277,-0.240640,0.202381,0.471516,1.173907,-0.467026,-0.556778,-1.225903,-0.036951,0.444321,-1.961011,0.395396,-0.230865,-0.583909,-0.814563,-0.837950,-1.118522,-0.735278,-0.365130,-0.011192,-0.039126,0.084110,0.479828,0.233154,0.691417,-0.276342,0.128520,-2.984399,-0.141001,-0.398459,-1.456600,0.159439,0.011755,-0.153300,-1.074848,0.169309,-0.445604,0.076071,-0.241423,-0.036191,-0.380016,0.454398,0.272431,0.376703,0.380699,-0.195117,0.074560,-2.178845,-0.080745,-0.454054,-0.276322,-0.183629,-0.023326,-0.250912,-3.013496,0.019803,0.341219,-0.147257,-0.644418,-0.012119,-0.176997,-0.545669,0.435185,0.073560,0.003368,0.158002,-0.143769,-1.005212,0.256912,0.307258,-0.012242,-0.670828,0.336897,0.554259,-1.858958,-0.320507,0.289298,-0.120317,0.887965,0.023551,-0.069484,-1.961759,-1.882856,-0.527435,-0.162186,-0.256953,-0.087899,-0.160490,-0.073135,-0.743482,-0.119339,0.427849,0.412043,-0.406674,-0.129033,0.201620,0.002386,-0.746341,-0.838364,0.000404,-0.008259,-2.353023,-2.430197,0.406968,0.066211,-0.198253,0.007688,0.158167,-0.055003,-2.261540,-0.082694,-0.365810,0.174920,-0.019287,0.264272,0.050658,0.035244,-2.337707,-0.845607,-0.012896,-0.050064,-0.646711,-1.106947,-1.103726,0.058892,0.144144,-0.071151,0.116859,0.253569,-1.710088,0.076145,1.315848,-0.038231,2.040152,-0.084547,-0.117429,0.063976,-2.263478,0.315058,-0.002100,-0.026877,0.404000,-0.059706,-0.394032,-0.027565,-0.422567,-0.079153,0.033976,0.079857,-0.477060,0.022702,2.076872,-0.126879,2.709591,-0.007040,0.148570,-0.093949,-0.250440,0.111777,0.008979,0.021768,-0.577204,0.693371,-1.969553,-0.024517,0.448827,-0.160971,0.052249,0.055421,0.811858,0.028321,1.179962,0.075434,2.717047,0.075163,-0.053867,0.045572,0.486422,-1.841831,0.000611,-0.018491,0.539976,-0.469318,-2.765813,-0.014266,-0.034010,0.525588,0.163085,0.814701,0.100634,-0.063373,0.236810,0.214330,1.585301,0.112863,-0.485311,0.112631,0.795600,-2.136372,0.013176,0.141181,-0.080543,0.496123,-2.352347,0.065232,-2.548644,0.104192,0.377661,1.897168,-0.291134,-0.084058,-0.559475,-0.844696,0.987637,-0.061175,0.743472,-0.300823,0.337629,-1.110563,0.043280,-0.126938,-0.702637,0.334024,-1.531510,-0.060455,-1.969341,-1.929881,-0.491270,1.049736,0.204547,0.249278,0.009553,-0.744125,-0.343818,0.361164,1.079523,-0.007066,-0.565448,-0.836800,0.076377,-0.493012,-0.488435,0.460106,-0.789414,-0.347046,-1.437168,-2.145053,0.199019,0.956095,-0.895529,0.049354,-0.292279,0.781263,0.491676,-0.125548,0.892929,-0.045347,0.866246,-0.262371,0.072996,-0.553579,-0.501372,1.137178,0.090291,-0.020920,-0.665181,-1.214823,0.291177,0.353471,0.012062,0.478041,-0.465118,1.215119,0.436789,-0.642325,1.414250,-0.432850,0.042788,0.550203,-0.063398,-0.065151,-0.251090,0.782486,-0.230509,0.663552,-0.459622,-0.456703,-0.011613,0.158195,0.413261,1.026308,-0.053480,0.981432,-0.464800,-0.834768,1.047975,-1.212400,-0.630727,0.611379,-0.154322,0.375881,0.298828,0.114949,-0.686447,0.235847,-0.395083,-0.338259,-0.115866,0.581977,-0.504724,1.283208,0.486361,0.853152,-1.199651,-0.897228,-0.014957,-2.052027,-0.030754,0.122234,-0.142802,0.477748,0.828019,-0.255778,-0.634779,-0.943882,-0.079715,-0.239898,-0.050971,0.536666,-0.721837,0.750395,0.453528,0.478749,-0.886660,-0.514531,-0.443756,-1.420699,0.332574,-0.128166,-0.061091,0.254760,0.625222,-0.231169,-0.270785,-0.997068,0.106024/), (/outputlayerSize,hiddenlayerSize_wdse/))

end subroutine define_neuralnet_wdse











subroutine define_neuralnet_wqv (mu_in_wqv, std_in_wqv, weights_input_wqv, &
                                bias_input_wqv,bias_output_wqv, weights_output_wqv)
real(r8), intent(out) :: mu_in_wqv(inputlayerSize)
real(r8), intent(out) :: std_in_wqv(inputlayerSize)
real(r8), intent(out) :: bias_input_wqv(hiddenlayerSize_wqv)
real(r8), intent(out) :: bias_output_wqv(hiddenlayerSize_wqv)
real(r8), intent(out) :: weights_input_wqv(hiddenlayerSize_wqv,inputlayerSize)
real(r8), intent(out) :: weights_output_wqv(outputlayerSize,hiddenlayerSize_wqv)


!normalization
mu_in_wqv(:)    = (/290.986482,291.160276,291.369437,291.671911,292.156644,292.824394,293.633178,295.239962,297.537474,300.072793,302.802806,305.694461,308.147839,310.152554,312.048464,314.177671,316.612056,319.356528,323.085734,327.468984,333.287859,340.230398,347.722565,360.059747,0.010734,0.010608,0.010383,0.009952,0.009274,0.008554,0.007877,0.006714,0.005130,0.003606,0.002393,0.001443,0.000843,0.000479,0.000258,0.000130,0.000066,0.000036,0.000014,0.000006,0.000004,0.000004,0.000004,0.000004,-0.000018,-0.000034,-0.000047,-0.000048,-0.000041,-0.000032,-0.000027,-0.000027,-0.000028,-0.000021,-0.000008,-0.000043,-0.000044,0.000023,0.000049,0.000050,0.000089,0.000077,0.000045,0.000023,0.000011,0.000006,0.000003,0.000000,12.156107,77.572286/)
std_in_wqv(:) = (/9.273619,9.264450,9.286544,9.357647,9.507541,9.703524,9.927421,10.369341,10.952799,11.571941,12.367152,13.542982,14.745508,15.703428,15.877918,14.971957,13.156540,10.906824,8.207128,5.985580,3.883993,2.831051,2.654340,2.244025,0.005378,0.005335,0.005246,0.005048,0.004748,0.004484,0.004244,0.003788,0.003070,0.002330,0.001758,0.001204,0.000779,0.000486,0.000285,0.000153,0.000081,0.000045,0.000019,0.000006,0.000002,0.000001,0.000001,0.000001,0.002870,0.005666,0.007888,0.009511,0.010851,0.012191,0.013545,0.015413,0.017053,0.018933,0.021285,0.023856,0.025488,0.026213,0.026707,0.026811,0.024668,0.015465,0.009132,0.005407,0.002946,0.001569,0.000833,0.000217,5.475639,36.830774/)
! NN biases and weights
bias_input_wqv(:) = (/ 1.927587,1.180897,-1.149110,0.963295,-0.989773,1.201468,-0.903159,-2.154161,-5.503177,-1.085833,1.052612,-1.424790,-0.995019,1.389948,-1.260604,-2.027357,1.647798,-5.247565,1.031696,1.193310/)
bias_output_wqv(:) = (/0.504903,0.262380,0.173545,0.238456,0.325363,0.333495,0.285711,0.211297,0.082452,-0.298124,-0.270238,-0.425623,-0.811910,-0.709951,-0.233222,0.275181,0.037273,0.085749,-0.149939,-0.458004,-0.338457,-0.242192,-0.201967,-0.038931/)
weights_input_wqv(:,:) = reshape((/  -1.234339,-1.402944,1.529578,2.883186,-2.043332,-2.588464,0.552732,0.703040,0.852019,1.248094,0.081314,-0.180732,0.074194,-0.828339,0.201402,0.227085,0.270093,0.028045,-0.125559,0.027995,0.018674,-0.004060,-0.011112,-0.005287,2.348984,-3.188979,1.722615,-0.393303,-0.259352,-0.404528,-0.555054,-0.169386,0.140025,0.189029,0.015718,0.048984,-0.012233,0.000967,-0.008940,0.009173,0.027201,-0.026864,0.024186,-0.010071,-0.009688,0.001058,0.015453,-0.014816,-0.079175,0.104476,-0.082285,0.052091,0.051252,-0.098061,-0.017034,0.040287,-0.118371,0.071122,-0.012867,-0.008230,0.030356,-0.006500,0.006660,-0.001951,0.003484,-0.000470,-0.018802,0.027088,-0.024529,0.025124,-0.012794,0.007060,-0.071231,0.036200,-0.137734,-0.827943,0.687171,-0.328590,0.579520,-0.347477,0.002043,0.028075,-0.180150,-0.379862,-0.025103,-0.267877,0.429068,0.163400,-0.046109,0.082701,-0.066469,0.157307,-0.023763,0.045318,0.009400,0.032964,0.017495,-0.006417,-0.136463,0.017304,0.172076,0.003528,0.127429,-0.553383,0.300157,-0.022206,-0.058837,-0.078010,-0.023460,-0.037418,0.010194,-0.017268,-0.001923,-0.002737,-0.014853,0.015239,-0.019737,0.007297,0.012483,-0.018618,-0.003657,0.006742,-0.000082,-0.069264,0.070835,0.005059,0.030062,-0.053421,-0.029595,0.052564,-0.029964,0.009667,-0.011389,0.007110,-0.002810,-0.003101,-0.000298,-0.006684,0.003451,-0.003202,0.008382,-0.011920,0.010127,-0.009548,0.005454,-0.004968,-0.037498,0.022690,0.086912,0.555807,-0.342776,0.243801,-0.872123,-0.108295,0.371014,0.388137,0.273761,0.277667,-0.023717,0.223602,-0.385660,-0.147135,0.066296,-0.192145,0.124109,-0.174357,0.015330,-0.044308,-0.017542,-0.018758,-0.002817,0.004749,0.301540,-0.076902,-0.063861,-0.027392,-0.010559,0.236140,-0.206928,0.110794,0.014907,0.055040,0.007376,0.021005,-0.007348,0.013250,-0.000090,0.005439,0.020641,-0.016654,0.014713,0.001127,-0.006728,0.012333,0.000431,-0.004373,0.029797,-0.004098,-0.051815,-0.022420,0.013685,0.068916,-0.012245,-0.062537,0.064171,-0.025752,0.018480,-0.008935,0.002164,0.007069,-0.005896,0.009236,-0.008773,0.006602,-0.005047,0.009206,-0.007020,0.005442,-0.001023,0.002795,-0.002161,-0.039429,-0.145353,-0.750497,-0.252208,1.559497,-0.462052,-0.530535,0.222441,0.253081,-0.268514,-0.067652,-0.015587,-0.139317,0.272497,0.087585,0.010044,0.122905,-0.039079,0.054328,0.002584,0.032550,0.025214,0.017944,0.006829,-0.007464,0.162559,-0.516152,0.126546,0.177275,-0.209100,-0.295241,0.199162,-0.050804,-0.016527,-0.033676,-0.003234,-0.009948,-0.000287,-0.003480,-0.003823,0.005210,-0.012630,0.009309,-0.000926,-0.005753,0.005166,-0.012801,-0.000237,0.004147,-0.012931,0.022185,-0.049525,-0.014300,0.037150,0.017780,0.010809,-0.051185,0.016439,0.021383,-0.019647,0.011498,-0.000754,-0.004857,0.001145,-0.002268,-0.000575,0.001217,0.000222,-0.006238,0.004459,-0.002482,0.000291,-0.000814,-0.028314,0.051999,0.100420,0.776613,0.359888,-1.811563,0.716647,0.539385,-0.265439,-0.270722,0.261919,0.050571,0.008163,0.137869,-0.269612,-0.080641,-0.025827,-0.129216,0.037187,-0.044506,-0.004776,-0.032546,-0.025570,-0.017074,-0.005737,0.007758,-0.103382,0.452057,-0.134542,-0.216490,0.266074,0.294821,-0.196912,0.052934,0.011149,0.032199,0.001513,0.007990,0.001087,0.002424,0.003259,-0.005332,0.011754,-0.008076,-0.000600,0.006727,-0.004417,0.011773,0.000302,-0.003879,0.007758,-0.043747,0.034666,0.006486,-0.042310,-0.014589,0.003158,0.053610,-0.030009,-0.012501,0.015249,-0.009435,0.001885,0.003910,-0.001085,0.001661,0.001202,-0.001784,0.000432,0.005682,-0.003878,0.002039,0.000094,0.000558,0.026036,-0.059118,-4.432821,3.138929,0.400296,-0.058795,-1.152520,-0.576032,0.816320,1.660506,-0.128822,-0.042079,-0.106649,-0.379744,0.371601,0.011294,0.080143,-0.005653,0.243823,0.026651,-0.081124,0.035763,0.010472,0.045872,0.079095,-0.015331,-0.208981,0.464688,0.142527,-0.255655,0.387600,-1.080648,0.387530,0.422649,-0.279858,-0.032992,-0.050896,-0.038098,-0.028774,0.014600,-0.016334,0.007468,0.044854,-0.041350,0.080173,-0.040216,0.023222,-0.039095,-0.006447,0.019394,-0.014312,-0.119301,0.004703,0.064969,0.185435,-0.117115,-0.146441,0.060020,-0.008633,-0.007125,0.023299,-0.011759,0.016802,0.005485,-0.011486,0.004009,-0.012018,0.012608,0.006356,-0.006121,-0.007501,0.008782,0.003113,0.002001,-0.173616,0.056553,0.566380,1.112299,-0.606101,-1.279181,0.997123,1.169365,-0.907078,-0.998287,0.189250,0.428952,0.107897,0.262908,-0.463788,-0.226021,-0.011765,0.020666,-0.040048,-0.051326,0.016106,-0.032549,-0.014353,-0.051367,-0.043991,0.012790,-0.109746,0.323793,-0.332321,-0.184793,0.013717,1.001593,-0.483312,-0.197010,0.150480,0.096083,0.035428,0.048897,-0.002531,0.007743,0.011413,-0.013217,0.005057,-0.007785,0.006971,-0.006420,-0.019659,0.030746,0.008392,-0.013945,-0.021507,0.119336,-0.060085,0.013078,-0.123024,0.053435,0.106321,-0.044828,-0.011476,0.034698,-0.019256,0.004900,0.002472,-0.006185,0.007195,-0.000985,0.009445,-0.008444,-0.009159,0.015614,-0.012639,0.011682,-0.009481,0.005584,0.097905,-0.028828,3.589001,-1.457861,-2.460498,-1.925606,1.002771,2.633034,0.774686,-0.705822,-0.471679,-1.242942,-0.365278,0.169587,-0.049170,0.700616,-0.017688,-0.360604,-0.130073,-0.110651,0.069964,-0.011697,-0.037553,-0.005747,0.046579,0.003320,-0.614386,1.059587,-1.145298,0.369111,0.455528,0.231903,0.699413,0.121361,-0.205663,-0.208985,-0.031220,-0.066828,0.008948,-0.002808,0.015936,-0.028615,0.001665,0.004655,-0.024791,0.010216,0.016712,-0.011214,-0.006954,0.010628,0.157365,-0.079517,-0.072262,-0.017108,-0.093650,0.189290,0.022664,-0.113339,0.188050,-0.110314,0.048463,-0.014005,-0.021212,0.014533,-0.017705,0.003352,-0.007206,0.000840,0.020882,-0.021449,0.008157,-0.012089,0.003657,-0.005808,-0.018087,-0.124414,1.865760,-0.197835,-6.137801,-0.367501,0.964908,5.362046,2.723876,-0.902170,-3.300797,-1.497882,4.377338,-0.438181,0.741339,-5.073705,-1.406671,-1.507419,-1.308614,-4.324252,-1.995454,-1.637689,-1.642058,0.701641,1.825992,-0.378017,2.044446,6.705079,0.691060,-2.239821,-1.605243,-0.558140,1.907515,2.619619,-0.021191,1.627655,2.311993,1.010800,-1.869384,-0.538737,1.628339,-2.097167,2.100770,-1.895663,2.602828,-1.072016,0.405122,-0.105996,0.107144,-0.074443,-0.209757,0.342578,0.114582,-0.176170,-0.135002,-0.079761,0.162586,0.183794,-0.175303,0.063692,-0.050829,-0.067629,0.206114,-0.290600,0.060372,0.163120,-0.293431,0.188793,-0.112055,0.232538,-0.182009,0.104716,-0.043363,-0.012024,0.496644,-0.530456,1.287802,0.665275,0.315574,-0.649072,1.038994,1.269274,-0.322313,-1.884558,-1.001535,0.676108,0.030583,0.949401,0.595723,-0.318989,-1.153631,1.184539,0.087595,-0.893101,-0.185468,0.102593,-0.010016,0.021561,-0.051740,0.043733,-3.391688,2.652338,0.428289,-0.085235,0.480330,0.880727,-0.725121,-0.338591,-0.218489,0.082546,0.109757,0.049283,0.042963,-0.011723,-0.012947,-0.016131,0.044182,-0.052539,-0.035379,0.014950,0.003386,-0.004591,0.005743,-0.005728,-0.100480,0.086953,0.048630,-0.149904,0.298566,-0.210791,-0.065449,0.122478,0.020722,-0.016387,0.084545,0.037953,0.059623,0.057932,0.052330,-0.016685,0.039985,-0.003706,0.008799,0.030626,0.006824,-0.006878,0.016768,0.008435,0.591215,-0.679857,-0.044915,-0.865940,-0.510064,2.003396,-0.952573,-0.637030,0.506335,0.367019,-0.194778,-0.120338,-0.055978,-0.162607,0.295368,0.081148,0.034229,0.096458,-0.039544,0.043493,-0.005215,0.035215,0.021104,0.026026,0.013932,-0.008435,0.177318,-0.442295,0.171761,0.232504,-0.232625,-0.459850,0.280280,-0.020221,-0.045045,-0.045297,-0.015731,-0.018098,0.001213,-0.006310,-0.004422,0.005385,-0.008762,0.007760,-0.004427,-0.001292,0.008469,-0.015338,-0.002649,0.005074,0.015355,0.016154,-0.020974,-0.042952,0.022511,-0.005378,-0.001940,-0.011735,0.019816,0.009915,-0.005903,0.004999,-0.000247,-0.000117,-0.001707,-0.001246,-0.002409,0.002086,0.002555,-0.007268,0.005700,-0.004398,0.002481,-0.001893,-0.045566,0.041418,0.065641,0.795063,-0.454072,0.178026,-0.150979,0.027483,0.317459,-0.105830,0.066995,0.280881,0.069647,0.289361,-0.466537,-0.128434,0.074204,-0.074153,0.113602,-0.233522,0.080433,-0.060333,0.001848,-0.038382,-0.018322,0.003808,0.333036,-0.479752,-0.068855,0.011024,-0.151575,0.550599,-0.273315,0.047775,0.041620,0.077643,0.047325,0.045322,-0.016554,0.027209,-0.002161,0.010292,0.010802,-0.016538,0.028400,-0.015432,-0.013439,0.014148,0.009435,-0.005779,-0.058842,0.099973,-0.102755,0.059193,0.016822,0.002848,-0.013546,-0.017359,0.023756,-0.001359,0.003836,-0.011019,0.024053,0.006284,0.003124,0.005843,-0.007938,0.008536,-0.012659,0.011681,-0.012451,0.012645,-0.008902,0.006888,0.067556,-0.025297,1.431016,0.562214,-0.063581,0.213627,0.243813,0.901502,0.101201,-1.774775,-0.887067,0.670629,0.051304,0.886488,0.499817,-0.347499,-1.016484,1.110206,0.117555,-0.898174,-0.169661,0.090813,-0.016553,0.031537,-0.040201,0.032622,-3.067846,2.398703,0.507604,-0.001316,0.368058,0.775497,-0.631348,-0.353473,-0.229728,0.082185,0.098433,0.042831,0.040059,-0.013944,-0.011896,-0.013370,0.052029,-0.055880,-0.027702,0.010457,0.006859,-0.008997,0.010984,-0.009883,-0.066449,0.060603,0.051638,-0.195297,0.315289,-0.186418,-0.051127,0.088501,0.033262,-0.014284,0.080902,0.036999,0.060262,0.059546,0.048871,-0.015273,0.039023,-0.004611,0.011726,0.027504,0.010329,-0.008175,0.016675,0.007242,0.562452,-0.657384,0.244122,-0.624920,0.362749,-0.364344,0.778065,0.463026,-0.498138,-0.966054,-0.252315,-0.255858,0.114633,-0.234006,0.409063,0.123231,-0.107281,0.223207,-0.091593,0.199751,-0.089137,0.062936,0.002536,0.026160,-0.002405,-0.005798,-0.619420,0.467068,0.124892,0.041470,0.055981,-0.109759,0.154620,-0.238889,-0.013446,-0.059357,-0.002813,-0.026778,0.014842,-0.023966,0.007077,-0.018621,-0.014876,0.014678,-0.023588,0.003323,0.007952,-0.009637,0.002794,-0.002060,-0.012955,-0.057382,0.093432,0.010893,0.028574,-0.086383,-0.006297,0.055160,-0.034826,0.001131,0.002150,0.007356,0.002900,0.005661,0.013938,-0.015100,0.018121,-0.014951,0.010926,-0.008942,0.009278,-0.009326,0.003653,-0.004247,0.055599,-0.020640,0.133233,0.778424,-0.203920,-0.423951,0.132991,0.311131,0.028871,-0.343869,0.101930,0.302372,0.080701,0.261418,-0.451386,-0.151208,0.051452,-0.093960,0.118783,-0.152481,0.045650,-0.050492,-0.008437,-0.040098,-0.021791,0.006094,0.224981,-0.284763,-0.076578,-0.066009,-0.067833,0.628857,-0.318261,0.003488,0.065599,0.079686,0.042997,0.042056,-0.012165,0.021262,0.002900,0.001461,0.010501,-0.014361,0.022366,-0.011789,-0.014412,0.017937,0.009346,-0.008080,-0.050450,0.066594,-0.079727,0.072820,0.007357,0.007447,-0.017742,-0.025714,0.034242,-0.005829,0.021221,-0.013654,0.011283,0.003870,0.003580,0.003371,-0.003744,0.003719,-0.010862,0.011954,-0.012700,0.012036,-0.008537,0.005892,0.068114,-0.028250,-0.027476,0.803880,-0.459667,0.002692,0.141962,-0.072800,0.356548,0.296119,-0.042562,0.211221,-0.058594,0.301830,-0.305951,-0.047365,0.032632,0.012129,0.085648,-0.355308,0.171154,-0.079779,0.011767,-0.036073,-0.007938,0.000680,0.472138,-0.698680,-0.087370,-0.007969,-0.102453,0.362757,-0.184566,0.147614,-0.013688,0.066611,0.042456,0.037649,-0.017773,0.031293,-0.010829,0.022160,0.007049,-0.015419,0.028807,-0.017187,-0.010056,0.005302,0.010841,-0.001497,-0.074476,0.125512,-0.100165,0.061388,0.012010,-0.028873,-0.013568,0.028082,-0.011886,0.016885,0.001644,-0.001735,0.013283,-0.005651,0.003550,0.010870,-0.010108,0.016224,-0.016089,0.009826,-0.008776,0.012901,-0.009752,0.006816,0.057348,-0.015272,0.017478,-0.726551,0.378581,-0.270063,0.112451,0.175013,-0.477646,-0.101123,-0.032504,-0.238161,-0.024371,-0.328269,0.433254,0.096028,-0.060077,0.027652,-0.104974,0.306745,-0.119317,0.068704,-0.010041,0.036900,0.013096,-0.002314,-0.357162,0.587169,0.042920,-0.012338,0.159001,-0.448801,0.213985,-0.096442,-0.014767,-0.070423,-0.044634,-0.046181,0.019092,-0.031269,0.007443,-0.017762,-0.009631,0.016782,-0.030175,0.017288,0.011572,-0.009574,-0.009299,0.002899,0.068101,-0.121529,0.108639,-0.053984,-0.016810,0.010565,0.008263,-0.002576,0.001828,-0.024735,0.009306,0.027669,-0.027124,-0.008012,-0.004525,-0.007621,0.009512,-0.012348,0.013957,-0.011338,0.011342,-0.012737,0.008946,-0.007175,-0.062944,0.021380,1.865441,-0.798708,-2.390014,-0.505148,2.071124,-0.483827,-0.137492,0.032699,-1.721583,1.282615,1.602658,0.778376,-1.410066,0.426953,-2.998926,-1.069992,-1.880675,-3.717639,-1.619047,-1.675769,-1.401104,0.564644,1.600460,-0.270599,2.436333,5.154605,1.526287,-2.366648,-1.640771,-0.368623,0.533316,2.246798,0.609047,1.840299,1.903679,1.074004,-1.770016,-0.511317,1.534019,-2.052291,1.952025,-1.793025,2.417154,-0.890030,0.311251,-0.094650,0.113960,-0.069024,-0.225102,0.365363,0.098900,-0.153689,-0.130977,-0.102500,0.167863,0.204874,-0.190003,0.058928,-0.050639,-0.081397,0.194323,-0.269361,0.067383,0.141137,-0.243087,0.158895,-0.099123,0.211273,-0.161793,0.089555,-0.035178,-0.013996,0.527039,-0.570119,-0.079501,-0.849209,-0.446316,2.083593,-1.003391,-0.560955,0.381383,0.284240,-0.188389,-0.035884,-0.037325,-0.129169,0.263552,0.049008,0.043464,0.110006,-0.022813,0.038049,-0.007017,0.031053,0.023915,0.021540,0.009436,-0.008650,0.199894,-0.533735,0.195049,0.233564,-0.274816,-0.343227,0.207139,-0.043668,-0.031283,-0.029790,-0.005099,-0.010217,-0.000910,-0.003091,-0.003832,0.005297,-0.008276,0.006095,-0.000476,-0.004481,0.006048,-0.013417,-0.000487,0.003612,0.001492,0.029834,-0.032318,-0.029102,0.035083,-0.001711,0.008934,0.000828,0.012841,-0.007741,0.007339,-0.001426,-0.001098,0.001664,0.001187,-0.001378,-0.002111,0.002115,0.000693,-0.005420,0.003817,-0.002454,0.000722,-0.000869,-0.030848,0.044471,-0.090933,-0.769554,-0.219554,1.192151,-0.482969,-0.548901,0.267587,0.416216,-0.134645,-0.263542,-0.071662,-0.207362,0.371990,0.130407,-0.005886,0.084207,-0.095956,0.094905,-0.019516,0.041826,0.015790,0.035090,0.019537,-0.007608,-0.073667,0.018898,0.075892,0.166964,-0.057030,-0.596106,0.329012,-0.001898,-0.063247,-0.065276,-0.034502,-0.033098,0.006995,-0.014182,-0.004335,0.002703,-0.009413,0.011183,-0.013858,0.006131,0.012421,-0.017598,-0.007031,0.007467,0.037615,-0.026778,0.035317,-0.066732,0.003215,0.000897,0.021236,0.004032,-0.040123,0.020013,-0.004923,0.007209,-0.004215,-0.000353,-0.003828,-0.002037,-0.000141,-0.000598,0.007775,-0.010865,0.010230,-0.009251,0.006367,-0.004249,-0.059872,0.033947/), (/hiddenlayerSize_wqv,inputlayerSize/))
weights_output_wqv(:,:) = reshape((/ -0.964698,-0.449968,-0.029774,-3.350806,-3.352803,0.062313,0.406865,-0.437370,1.613458,-0.009019,0.140795,0.570804,0.015469,0.034481,-0.610421,0.112061,0.053216,-1.485352,-0.185159,1.073200,-0.669680,1.032105,0.594395,-3.194807,-3.211212,0.195564,0.686631,-0.434883,1.524097,0.075960,-0.548724,0.441478,-0.071190,0.003905,-0.307431,0.355223,0.011615,-1.450366,0.254432,1.002210,-0.597815,2.206678,1.192152,-2.688720,-2.977480,0.262847,0.854380,-0.466880,1.767404,0.076253,-1.478099,0.214924,-0.067454,0.012289,-0.038288,0.527960,-0.115751,-1.754713,0.767620,0.879943,-0.755232,2.843546,1.741410,-1.774038,-2.429288,0.317870,0.991287,-0.470600,1.848868,0.079070,-2.313747,0.101392,-0.069992,0.061280,0.063379,0.566470,-0.172476,-1.875196,1.317219,0.840073,-1.116219,3.095010,2.115556,-0.970000,-1.731751,0.390509,1.196627,-0.572564,1.805531,0.090770,-2.737491,0.137470,-0.084868,0.091753,-0.036937,0.581656,-0.163033,-1.852638,1.854283,0.904982,-1.472220,3.258873,2.243639,-0.551459,-0.995876,0.468892,1.442125,-0.778112,1.716063,0.099020,-2.646390,0.209122,-0.096339,0.057617,-0.204883,0.658461,-0.142938,-1.777835,2.319352,0.886791,-1.756854,3.411007,2.169254,-0.527067,-0.360145,0.527035,1.621037,-1.055681,1.624402,0.100630,-2.108824,0.220367,-0.098543,-0.014990,-0.315521,0.780361,-0.119347,-1.701511,2.646297,0.619941,-2.117712,3.406244,1.974318,-0.889024,0.108081,0.524701,1.587525,-1.534579,1.521282,0.129467,-0.538029,0.101719,-0.124828,-0.027581,-0.313381,0.938434,-0.007044,-1.615531,2.504150,-0.339492,-2.270652,3.175497,2.306288,-0.865972,-0.324175,0.478348,1.442657,-1.802399,1.139462,0.223176,1.035659,-0.518114,-0.217245,0.276127,0.286043,0.990583,-0.206376,-1.230451,1.034262,-0.591483,-1.883422,3.071900,2.405726,-0.600280,-0.357009,0.465868,1.463145,-1.804096,0.679013,0.282308,0.755487,-1.611572,-0.272706,0.449091,2.103725,1.190726,-0.702279,-0.770996,0.253087,1.556911,-1.285720,1.294821,1.452652,-0.433049,0.084558,0.232340,0.621413,-1.288456,0.306640,0.362150,0.146329,-0.358749,-0.351312,0.585370,2.060650,1.665503,0.931989,-0.406283,0.475836,2.120933,-1.081435,1.375618,1.753727,-0.198101,-0.104879,0.253725,0.732185,-1.124018,0.161519,0.480446,0.076069,2.414711,-0.477563,0.849295,-0.497408,1.884605,2.144228,-0.275356,0.087486,1.352881,-0.961834,1.411233,2.207555,-0.207871,-0.138829,0.240746,0.760572,-1.072674,0.011562,0.630887,0.075794,2.273532,-0.647593,1.322710,-1.166919,1.026648,0.770673,-0.131055,0.031602,1.224777,-0.743574,0.422078,2.274676,-0.094255,-0.012562,0.129803,0.390017,-0.841403,-0.028426,0.790805,-0.039797,0.596444,-0.821558,1.839363,-0.767155,0.820816,-0.583192,-0.079967,0.203087,1.152955,-0.501952,-0.373139,2.453785,0.209173,-0.047532,0.074496,0.200809,-0.643979,-0.053931,0.884552,-0.111715,-0.533383,-0.926597,2.288551,-1.011171,1.782247,-0.845379,-0.035385,0.109351,0.639284,-0.283734,-0.626384,2.590557,0.534461,-0.215598,0.058170,0.201426,-0.557871,-0.120595,0.850883,-0.171191,-1.229749,-0.892354,2.421290,-1.546046,3.068111,-0.656761,0.066197,-0.201011,-0.024844,-0.152818,-0.394649,1.870152,0.509245,-0.204239,0.023285,0.162797,-0.493366,-0.122563,0.523548,-0.171203,-1.191945,-0.548241,1.659301,-1.228138,2.636758,-0.425611,0.105263,-0.260008,-0.242003,-0.174811,-0.505761,1.755742,0.519603,-0.135763,0.001124,0.100196,-0.556807,-0.099753,0.490102,-0.152704,-1.330215,-0.509294,1.603816,-1.163488,2.666840,-0.478952,0.072820,-0.201272,-0.284901,-0.078135,-0.568265,1.195049,0.108414,0.079914,-0.054887,-0.082394,-0.417426,0.015999,0.450767,-0.029056,-0.870985,-0.468907,1.314012,-0.782230,2.072845,-0.343295,-0.065678,0.174690,-0.135656,-0.023957,-0.218669,0.275678,-0.097677,0.129016,-0.039019,-0.130426,0.081950,0.026444,0.202211,0.058579,-0.033163,-0.207047,0.505348,-0.163484,0.648706,-0.167918,-0.084375,0.201676,0.069899,-0.124791,-0.105472,-0.133254,-0.019362,0.038962,0.008982,-0.072619,0.186002,0.079936,0.109755,0.044625,0.024318,-0.099055,0.032899,-0.014664,0.235788,-0.076461,-0.006969,0.024321,0.012942,-0.126892,-0.073483,-0.179240,-0.031642,0.042249,0.000627,-0.048314,0.184568,0.127991,0.086199,0.023784,-0.005949,-0.082268,-0.029402,-0.012100,0.142442,-0.041146,0.054588,-0.018850,-0.002498,-0.121989,-0.054118,-0.174891,-0.026370,0.032342,-0.024722,-0.027822,0.172634,0.132438,0.072382,0.015667,-0.000982,-0.078309,-0.026344,-0.005404,0.120786,-0.039669,0.072177,-0.021168,-0.006673,-0.027522,-0.023345,0.003129,-0.020411,0.020813,-0.021005,0.016710,0.032515,0.035121,0.015817,-0.018379,0.022419,0.002224,-0.022884,0.018986,0.032445,-0.025366,0.031097,-0.021567,-0.019670/), (/outputlayerSize,hiddenlayerSize_wqv/))
end subroutine define_neuralnet_wqv











subroutine define_neuralnet_qcl (mu_in_qcl, std_in_qcl, weights_input_qcl, &
bias_input_qcl,bias_output_qcl, weights_output_qcl)
real(r8), intent(out) :: mu_in_qcl(inputlayerSize)
real(r8), intent(out) :: std_in_qcl(inputlayerSize)
real(r8), intent(out) :: bias_input_qcl(hiddenlayerSize_qcl)
real(r8), intent(out) :: bias_output_qcl(hiddenlayerSize_qcl)
real(r8), intent(out) :: weights_input_qcl(hiddenlayerSize_qcl,inputlayerSize)
real(r8), intent(out) :: weights_output_qcl(outputlayerSize,hiddenlayerSize_qcl)


!normalization
mu_in_qcl(:)    = (/290.986482,291.160276,291.369437,291.671911,292.156644,292.824394,293.633178,295.239962,297.537474,300.072793,302.802806,305.694461,308.147839,310.152554,312.048464,314.177671,316.612056,319.356528,323.085734,327.468984,333.287859,340.230398,347.722565,360.059747,0.010734,0.010608,0.010383,0.009952,0.009274,0.008554,0.007877,0.006714,0.005130,0.003606,0.002393,0.001443,0.000843,0.000479,0.000258,0.000130,0.000066,0.000036,0.000014,0.000006,0.000004,0.000004,0.000004,0.000004,-0.000018,-0.000034,-0.000047,-0.000048,-0.000041,-0.000032,-0.000027,-0.000027,-0.000028,-0.000021,-0.000008,-0.000043,-0.000044,0.000023,0.000049,0.000050,0.000089,0.000077,0.000045,0.000023,0.000011,0.000006,0.000003,0.000000,12.156107,77.572286/)
std_in_qcl(:) = (/9.273619,9.264450,9.286544,9.357647,9.507541,9.703524,9.927421,10.369341,10.952799,11.571941,12.367152,13.542982,14.745508,15.703428,15.877918,14.971957,13.156540,10.906824,8.207128,5.985580,3.883993,2.831051,2.654340,2.244025,0.005378,0.005335,0.005246,0.005048,0.004748,0.004484,0.004244,0.003788,0.003070,0.002330,0.001758,0.001204,0.000779,0.000486,0.000285,0.000153,0.000081,0.000045,0.000019,0.000006,0.000002,0.000001,0.000001,0.000001,0.002870,0.005666,0.007888,0.009511,0.010851,0.012191,0.013545,0.015413,0.017053,0.018933,0.021285,0.023856,0.025488,0.026213,0.026707,0.026811,0.024668,0.015465,0.009132,0.005407,0.002946,0.001569,0.000833,0.000217,5.475639,36.830774/)
! NN biases and weights
bias_input_qcl(:) = (/ 0.606391,-4.230594,-0.172005,-2.187613,-1.369462,0.220232,-1.954435,-0.463454,0.884664,2.285581,1.394887,2.080720,-0.049087,-1.687296,5.714188,1.036279,1.769432,-3.050180,0.704711,-6.900342/)
bias_output_qcl(:) = (/-41.107317,-28.742844,-29.310031,-25.360573,-26.564042,-36.928713,-23.092628,-31.448079,-29.568055,-31.454045,-16.445774,-26.589765,-24.517378,-18.230116,-30.994629,-35.562557,-23.449918,-14.101127,-24.099098,-62.587564,-35.535961,-16.586749,-25.379922,-19.206532/)
weights_input_qcl(:,:) = reshape((/  1.910401,-4.267545,-1.013599,-2.296970,1.100577,3.182028,-1.488813,-1.152686,-3.871423,3.943809,-2.787400,-0.245897,-1.746489,3.319566,1.503098,-0.724138,-4.894279,5.770832,-2.343840,-0.613035,0.244088,0.323572,0.681665,-0.198143,2.646677,-1.075513,-0.303363,-1.044483,3.844014,-0.023490,-1.152205,-0.110440,-0.992178,1.488016,-0.308474,0.241948,-0.002157,-0.415936,0.307071,0.886097,-0.849898,-0.463261,0.127293,0.110653,0.399296,-0.622720,0.854036,-0.156360,-0.212444,0.622791,-1.129451,0.906026,-1.101540,1.650814,-0.851317,-0.003480,0.570187,-0.536022,0.551120,-1.021138,0.749732,-0.597387,0.710212,-0.713921,0.102572,0.064025,0.300512,-0.283405,-0.370007,0.549338,-0.444279,0.111589,-0.316103,1.324437,-3.276893,0.490150,-2.255812,-3.721208,5.515307,5.007641,-3.694660,2.851096,2.006901,-1.256764,-5.119571,0.054239,-2.917202,6.598294,3.218858,1.271955,0.545881,0.898382,1.783640,-3.510882,-1.308464,0.671396,-4.430049,1.067148,-5.208520,-1.996814,2.776641,1.412461,-3.512909,1.223796,2.231607,4.166684,-2.258543,-0.330132,2.511201,-2.974123,0.477650,-2.532203,-2.386649,-1.242635,-1.517045,-0.868741,-1.298080,6.045919,-0.125570,-1.633306,1.456510,-1.945530,0.547435,0.519002,-0.574930,1.447005,-1.994802,1.011781,-0.418806,0.038096,0.064469,0.126054,0.195496,-0.237458,-0.274814,0.471760,-0.412646,0.369135,0.353146,-0.584235,-0.024243,-0.090918,-0.036223,0.158039,0.233366,-0.493860,0.369649,-0.117872,0.654031,-0.731121,-0.395054,-1.654046,-1.593077,-1.417839,4.329676,-0.539046,-3.204191,0.438166,3.547982,-0.151429,-1.163379,3.508003,-6.500220,-3.171968,5.826105,6.268116,-4.835436,0.764988,0.119914,-0.532868,1.280580,-0.579445,1.124672,-0.340786,-2.762172,3.094583,1.060258,-1.324487,-1.069640,-2.386685,4.372522,-1.632452,1.597798,1.128342,-1.681216,-3.168566,3.232376,-2.642354,2.548267,-1.177506,0.965093,-1.114609,-0.630470,2.125782,-0.704611,-0.857845,-0.204709,1.754851,-2.294982,0.941434,0.719052,-0.077989,-0.230495,0.013581,0.147080,-0.149424,-0.172573,-0.214292,0.789060,-0.184768,-0.098193,0.047557,-0.186809,-0.625629,-0.062527,0.587488,0.584139,-0.869435,0.033413,0.052872,0.126968,0.218785,2.274084,-5.069745,-1.261658,2.391290,1.532282,0.286992,0.740919,0.274372,-2.149385,0.424423,4.851125,-3.047659,-0.010640,1.821775,-4.828375,-0.758653,5.099935,-2.506585,4.570429,-1.263205,-1.635340,0.876298,0.469615,0.425201,-3.339857,-1.111130,-0.027802,1.593783,1.782891,-1.774453,1.827628,-2.148924,1.388285,-1.058100,-0.728617,0.869471,-0.387107,0.613797,0.400567,-0.994249,0.883931,-0.311232,0.559159,-0.870945,0.110300,-0.330932,-0.020759,0.602644,-0.292167,1.076761,0.471980,-1.706256,2.683470,-2.574934,0.719959,0.146589,-0.142362,-0.217174,-0.570862,0.396686,-0.159463,0.379369,-0.153485,0.194232,-0.054385,-0.142008,-0.066024,-0.345633,0.279613,0.033460,0.075855,0.277919,-0.395345,-0.377613,1.144991,0.456690,-1.328261,-0.707365,-3.766392,2.853933,1.441783,4.256237,-2.615356,-0.923058,1.274315,-1.112261,0.708505,-1.882097,-0.472306,0.651955,-0.948225,3.176751,-1.169640,-0.335502,0.462645,-0.357547,1.887053,-0.745837,-3.202537,0.642474,-0.600367,-0.467920,0.120147,0.495384,0.069156,0.241131,1.525074,-0.636845,1.436337,1.092288,-1.114144,-0.466769,-0.116425,0.013250,0.533041,-0.352785,-0.588994,0.156943,0.155977,-0.000466,0.000882,-0.356263,-0.073128,0.846955,-0.171801,-1.133062,1.952093,-1.532586,0.296886,-0.126261,-0.188639,0.531450,-0.052622,-0.557701,0.877278,-0.327393,0.123363,-0.124081,-0.825242,-0.244922,0.346806,0.508846,0.159189,-0.899867,1.079480,-0.371412,0.055923,0.464450,-0.696811,0.129552,-1.740742,-1.205020,-0.256888,0.792104,1.089405,2.236518,-0.687063,2.362438,-0.286120,-1.167272,0.442370,-2.799631,2.235241,-1.898900,-1.693261,-0.520350,-0.032507,-0.055393,-2.097677,0.348384,0.851903,0.609131,-1.332213,0.729212,1.579360,-2.525137,1.892216,2.378730,-0.403992,-0.534314,-0.946057,0.898201,-0.062212,-0.710341,1.089229,0.462974,-0.096392,-0.809781,0.140579,-0.018167,1.266392,-0.527118,0.905717,0.161523,-1.509695,1.130337,0.098526,-0.421126,0.442358,0.839401,-1.353816,-0.495758,0.821407,-0.185805,0.514995,-0.260838,0.066232,-0.642368,0.152369,0.145996,0.122255,0.546133,-0.500980,0.176156,-0.048262,-0.499447,0.262321,0.195693,-0.370844,0.161464,-0.497107,0.602499,1.929343,1.176752,-0.914940,-2.555330,-3.117540,7.001760,0.868848,-1.566098,7.264768,-7.628830,3.976772,1.315676,-1.890867,-2.283533,-1.921034,-0.862943,1.483227,-1.999151,3.655109,-3.256517,0.757823,0.600592,1.074099,-0.143033,-4.951424,1.211166,3.502201,-6.501197,5.600005,-1.047096,-4.128560,4.044197,0.663784,-0.462331,-0.580005,-0.336376,1.193755,1.705731,-2.810962,0.299953,0.209596,-1.243614,-0.196361,-0.489943,0.801088,-0.762017,1.109667,-0.642933,1.253639,-1.518901,0.256960,0.878443,-0.432296,-0.657311,0.959489,-0.436006,-0.482635,0.296018,0.159116,0.181888,-0.064912,-0.281003,0.180636,-0.262499,0.640731,-0.366046,0.224733,-0.423708,0.155981,0.518016,-0.397814,0.131347,0.260972,-0.470057,2.338874,-1.518775,0.411118,0.330436,-1.539454,-1.478369,-0.014578,3.692513,-1.197640,1.746515,0.791377,2.481908,-1.161023,1.789034,-3.051682,-1.857435,-1.119067,-0.529745,-0.710114,-1.204958,1.237091,-0.647471,1.254527,-0.098290,0.300237,-0.337527,-0.810253,0.821608,-1.900308,1.614315,2.199444,-1.524161,0.686980,0.258064,1.014677,-2.141903,0.760037,-0.642905,-0.110480,-0.895445,0.698111,0.185665,0.546299,1.169401,0.440500,-0.551289,0.311228,0.575137,0.035492,-1.300824,1.640629,0.529012,-1.836217,1.671751,-1.601311,0.830412,0.272327,-0.224999,0.011601,-0.161523,-0.183406,0.874571,-0.942083,0.665065,-0.536203,-0.369707,-0.229379,0.673707,-0.302343,0.507682,-0.634919,0.130720,0.390106,-0.487249,2.772533,-2.847898,-3.346508,-1.673611,-1.073741,2.461622,0.426949,1.704966,-4.328947,0.437495,1.839639,-3.789019,-0.452530,-2.209150,3.842214,-7.660159,1.168232,4.353134,2.097458,-0.635993,-0.280307,-0.762866,-1.079478,1.479505,3.912592,-4.051916,3.484724,-2.018373,0.616850,-1.178653,0.645152,0.630071,2.961783,-2.448766,-1.354642,1.691380,0.417699,0.455655,1.161319,0.973054,-1.141416,-0.240953,2.741815,-0.127200,0.255201,-0.586153,1.774682,1.132123,-0.420716,0.756139,-0.437615,-0.595728,1.397989,0.594562,-2.776233,1.509258,-0.431736,0.010872,0.766035,-0.556932,0.877902,-0.382579,0.238050,0.446854,-0.073582,0.399000,0.128520,-0.764676,0.040517,0.017537,0.549876,-0.998581,-0.837476,0.920092,0.043594,2.245485,-2.365383,-2.188861,-0.932875,-1.355034,3.986704,-5.708694,4.050894,-1.117816,0.671704,4.093703,-0.858292,-0.363497,-0.031824,0.706704,1.018457,0.487947,-1.634907,-1.676515,1.868736,-0.776654,0.479865,-0.045671,-1.969324,2.344265,-0.395522,-3.441390,4.862832,1.695295,-4.823287,0.395545,0.555775,-0.191317,-0.863704,0.346532,-0.002913,0.984964,-0.311172,0.563318,-0.116608,-0.013392,-0.552341,0.811937,-0.453272,0.555487,-0.609125,0.329970,0.286916,-0.888314,0.533202,-0.208517,0.814331,-0.942111,0.077339,0.259990,-0.481174,0.896458,-0.460629,0.129374,-0.419220,0.191074,-0.008579,0.096456,0.154553,-0.283403,0.218436,-0.448516,0.297947,0.292195,-0.116597,-0.231424,-0.352618,0.164565,2.644558,-0.187567,-2.762221,0.326198,1.465152,1.663963,1.423469,3.318395,-2.474140,-2.804933,1.189482,-2.436559,1.463837,-2.829940,-2.780639,0.302365,-1.314591,0.757845,1.855790,-3.351979,0.790064,-0.119074,1.289759,-0.397884,-2.490370,1.639019,0.935765,0.812786,-0.461963,-0.347966,2.160379,-0.213431,0.735794,-1.112502,0.795557,0.025680,0.403388,-0.501837,0.449179,-0.545945,-0.328007,0.056410,0.582504,-0.224193,-0.058729,-0.290567,0.473537,0.269559,0.031818,0.491322,-0.496486,-0.321263,1.516363,-1.581042,0.634170,-0.137368,-0.050180,0.091514,0.241292,-0.168900,0.353576,-0.557014,0.309988,0.055038,-0.001233,-0.107989,0.246245,-0.047337,-0.333658,0.420433,-0.415473,0.419072,0.330584,-0.128768,3.533870,-0.258397,-1.567689,-2.015637,-0.544355,0.251217,-1.005944,-0.251261,3.824653,-4.798766,7.006265,1.880565,-0.926072,4.215446,-11.565619,0.240237,4.235761,-2.946303,-0.642102,2.481255,-0.320965,-0.819561,1.723764,0.470265,-0.767876,0.546649,-0.571061,0.547587,0.826277,-0.254034,-0.570144,-0.497623,0.010235,-0.385450,-0.064742,0.611099,-0.071810,-0.686961,0.498047,-0.883475,1.346568,-0.769490,-0.725874,1.041143,-0.094252,-0.011360,0.059326,-1.195019,-0.745360,0.655450,0.075877,-0.098290,1.188928,-1.923540,0.591688,0.687539,-0.779636,0.663529,-0.626680,0.428851,-0.447766,1.191829,-0.906001,0.612944,-0.663705,0.655862,-0.844172,1.496628,-1.458070,0.805818,-0.084256,0.094441,-0.045373,0.013689,1.600050,-2.760988,0.802174,-1.289036,-0.887803,1.416790,-1.748985,7.830450,-1.075505,-2.634900,5.485459,-0.037644,-2.511929,-3.624149,-0.611168,0.699033,1.364713,-2.373624,3.927945,-1.427492,-0.340061,0.834384,0.000912,-0.541616,-3.620767,-1.492274,0.689808,0.950808,0.404762,1.010628,-2.647193,3.743199,-1.004540,1.147975,0.582527,-1.060595,0.527201,-0.824061,0.005259,-0.187467,0.282535,-0.146596,0.230505,0.544556,-0.197909,0.364715,-0.111868,-0.315882,0.509382,-0.625315,-0.461116,1.018874,-0.991507,0.530600,0.545092,-0.606676,0.133924,-0.187049,0.119893,-0.662459,0.423126,-0.180029,0.515380,-0.578382,0.218699,-0.234344,0.349340,-0.484113,0.112942,0.267595,-0.300621,0.238486,-0.070664,-0.000315,-0.940468,1.122734,2.882400,-0.951123,-3.241319,2.154572,-4.152990,2.688186,0.197974,-1.635025,2.047327,3.296124,-3.081574,4.321364,-4.715602,1.489884,-2.505585,2.809053,-1.023275,0.181901,0.743138,-0.535710,-0.405634,-0.138794,-1.840016,4.153277,-2.838696,1.137329,0.489638,0.453319,-2.973890,2.433975,-0.531913,0.227996,-1.223538,0.531914,-0.463597,0.073453,-0.175681,0.257111,-0.066436,0.446344,-0.055768,-0.042866,-0.242293,-0.094669,0.367242,-0.632218,-0.056036,-0.055277,-0.158953,0.052320,0.517466,-0.597078,0.474950,0.034659,-0.277189,0.226914,-0.348345,0.391678,-0.232247,0.043584,0.056547,-0.150972,0.056334,-0.125914,0.090516,0.087720,-0.223873,0.339712,-0.037473,-0.155159,0.339056,-0.530887,-6.459723,0.361850,1.843834,0.840631,0.260739,-0.361987,0.563283,3.908354,0.431324,1.461960,-3.778829,2.598047,1.143261,-5.391311,-2.179670,0.131315,-2.112815,-1.632542,0.769326,-0.735766,-1.658477,3.907741,1.631982,1.126147,3.966413,0.109129,-1.995318,1.604876,-0.915378,-0.828095,3.549596,-1.963100,1.033431,-1.896608,0.839665,0.504031,-1.479299,2.635941,0.514044,0.092530,-1.147381,3.370491,3.764411,-0.898456,-1.327929,-2.937115,-0.476387,-0.235384,-1.099106,2.142454,-0.071400,-1.288795,0.625584,1.510710,-2.091089,0.276124,0.364621,-0.063257,0.488619,0.168557,-0.055937,0.650877,-0.124088,1.276925,-1.297379,-0.084171,0.120493,-0.372924,0.311833,-0.918179,1.067218,-0.586306,-1.980163,1.896380,-4.390299,-0.866796,1.610064,3.256789,3.185789,1.727612,-1.110412,-1.354579,-0.078762,-1.152834,-0.928046,-3.183576,1.543528,-0.528622,1.872632,1.645042,1.936033,-3.646074,3.911350,-0.661740,0.346962,0.563367,-0.999807,-0.398222,-0.341440,-0.297497,0.772824,2.451596,-2.914927,-2.006780,1.636112,-0.877915,0.072014,0.407500,-1.400451,0.206548,0.508201,0.006538,0.117217,-0.214192,-0.078290,-0.071718,-0.386392,0.626569,-0.041315,-0.347699,-0.426919,0.441316,0.022908,1.006163,-1.679253,1.074260,-1.076634,0.958239,-0.385270,0.212703,-0.526123,0.048672,0.197458,0.152935,-0.093729,-0.141168,0.074302,0.084000,-0.173830,0.316527,0.052344,-0.491464,0.411793,-0.314579,0.474910,-0.165209,-0.356652,-0.072929,-0.827132,4.678454,-5.201088,0.143729,3.610620,-3.588889,5.780979,-1.103535,-3.103036,4.021543,-1.599811,-3.181871,0.662944,-1.952232,-0.399671,3.050076,-0.259712,-1.904066,-0.660862,0.108595,0.428733,0.290578,0.995415,-0.931861,-1.590270,-1.873192,0.895931,-1.620951,4.191002,-3.202321,2.184735,-0.122888,0.618426,-1.011429,0.479558,0.857237,-0.926771,0.221703,0.107249,-0.069426,-0.178515,-0.288240,0.198382,-0.968553,0.182998,0.785696,0.064894,-0.489561,0.369577,0.563312,-0.634251,0.434491,-0.120048,-0.562841,-0.008623,0.185766,-0.198593,0.232078,-0.437763,-0.013888,0.675435,-0.923289,0.821652,-0.582109,0.766863,-0.683882,0.995271,-0.766967,0.463115,-0.320040,0.292150,-0.072858,-0.169231,0.941223,4.971692,-0.464981,-2.697817,-5.199862,-2.109077,1.239050,-1.138227,2.363215,0.443512,-5.025936,-0.861281,1.997173,1.552580,4.067589,8.094352,-1.120698,-4.975302,0.038881,4.022458,-0.443211,-1.911104,1.624892,3.769743,-1.138753,3.922732,-2.445834,-6.603136,-2.423256,-1.421976,-4.937451,2.244340,2.532581,-5.148863,2.020607,-0.060377,-1.892851,0.134853,-1.059823,0.751893,-0.905811,0.667818,-4.923226,-0.422059,-5.529005,0.764387,-2.387750,-1.201254,-0.039870,-0.661047,1.888567,0.438320,-1.379033,1.470456,-0.006834,0.040933,0.537376,0.522698,-0.221320,-0.081631,-0.709781,-0.049758,0.471655,0.615518,0.113992,-0.432804,0.671097,-0.277203,0.428536,0.117957,-0.374015,1.006113,0.078716,0.399081,-0.360041,0.070929,-0.202574,2.169618,1.887222,-1.565062,-4.247001,-1.722180,-0.608207,-1.097941,-3.853884,-1.161472,5.158589,1.271626,0.973835,3.013263,0.992906,0.141737,-5.710379,0.037938,0.978749,1.273645,-1.376529,2.664922,0.666969,-0.473915,-3.050172,5.631602,1.176328,-0.358265,3.790279,-3.040821,-1.157797,-3.187359,3.823892,-3.024636,1.748117,0.069376,-1.273775,0.058275,-0.204897,0.352940,0.148341,-0.535407,0.110818,0.594131,0.264421,-1.201961,0.824400,-0.573967,-0.779186,1.258598,0.684388,-1.757623,1.520613,0.174362,-0.707017,0.098447,0.486732,-0.784286,0.356380,-0.225892,-0.180373,0.335210,0.033196,-0.778080,0.520947,-0.561402,1.103247,-1.845813,2.214696,-1.317382,0.317470,0.733165,0.172760,0.369547,1.454067,3.575253,1.578070,0.700543,-0.537189,-1.408398,-2.614772,-1.119258,-1.799219,4.124188,-0.608261,2.990259,-2.075757,1.260100,3.741478,2.175831,-6.855022,2.133458,-3.410277,2.813135,-2.284824,0.277337,0.488409,4.354276,-0.464396,-1.830437,0.499542,-0.441708,-4.205391,4.102537,-3.029249,0.774536,0.037767,-0.786407,-0.119050,0.796511,-0.449795,-0.251241,0.021897,0.083972,0.642302,-0.350864,0.546108,-0.455929,-0.000477,-0.572130,0.206381,-0.397582,1.291762,-0.942779,-0.080895,-0.533522,1.538696,-1.578926,1.838294,-0.948491,0.211622,-0.108824,0.211964,-0.379041,0.254581,-0.211601,0.190728,0.055057,-0.255040,0.311235,-0.271724,0.236946,-0.101676,-0.055933,-0.089098,-0.276350,0.540796/), (/hiddenlayerSize_qcl,inputlayerSize/))
weights_output_qcl(:,:) = reshape((/ -2.384199,3.190223,-2.888287,-3.637831,4.961092,13.982201,-0.722868,4.620052,3.323554,3.218867,10.600944,-5.341702,-0.027507,22.319902,-7.421440,4.536647,-5.340056,-1.384666,3.343766,-4.541293,-5.412948,14.995178,-10.571532,0.685300,10.088010,15.021902,-1.301839,-17.239623,-14.398992,-18.162361,-12.676263,-0.314440,-12.051077,13.980686,2.394792,-8.369705,-12.854694,-13.719198,-6.313309,17.658387,-0.991798,-2.415201,-10.818261,1.251346,9.165657,6.581260,14.637160,0.544737,-8.925362,0.332908,-5.126556,-4.911255,1.541600,2.654889,-17.595180,-12.133231,-2.960989,2.060240,-8.314673,12.780227,5.386358,10.075741,-4.491488,9.055013,12.220663,1.595516,-9.931078,-5.018014,5.041309,0.157297,4.503864,-14.849214,5.242518,11.552669,-4.455027,-4.986265,-7.881690,-0.584752,-6.730464,-0.455210,-3.182685,-0.879617,1.065472,2.659462,3.411173,9.753927,3.937094,0.369224,2.846815,-2.796134,-4.338097,-10.008161,1.011427,4.385273,0.700845,-7.827173,-4.469654,6.907770,0.662299,-2.772554,23.237971,3.990934,-2.190532,26.000201,24.001796,0.936597,13.568831,-3.271433,16.733637,-15.032580,-20.972240,-4.924111,-37.367125,1.627832,-22.751388,6.474983,-4.391352,-5.659188,1.167904,7.984314,0.159040,-1.112454,3.307451,4.743733,-11.274565,3.280160,2.412452,-0.205201,-2.600754,-3.070938,-10.897799,-0.439716,-1.715581,3.510714,-2.901275,-3.176277,6.196427,-3.779663,-4.525447,9.607233,-22.029595,4.717367,-0.933738,6.567190,-1.207201,-8.257288,-3.157535,9.183050,5.131474,-16.268831,-4.345962,-14.988149,3.377099,22.315004,0.809187,0.090071,19.055473,0.596839,-0.449514,6.992940,13.650457,3.661527,-3.809535,42.929937,27.372314,18.799775,17.548767,-6.986834,10.342996,-11.692871,-17.014484,7.991371,-34.107773,12.378913,-8.262437,-28.884965,-11.111016,-1.190144,-15.259160,25.024444,5.242231,-2.002874,-0.031074,-5.668130,9.059678,16.171517,8.554250,5.006437,1.968451,-9.956167,-2.923550,-5.437880,5.072194,15.671999,-4.059870,9.051649,-6.102479,-0.172120,-14.067622,-1.215261,-4.574116,1.161162,2.568252,7.655864,4.802508,13.080080,3.016024,-1.014565,1.560075,-8.397578,-11.204390,-10.015916,2.616468,2.935370,-6.460388,-6.859424,-12.340931,6.955290,-9.527578,2.575042,2.991659,1.089279,4.811622,7.806643,12.744921,5.424672,1.923294,0.031715,-1.303776,2.793932,0.556946,3.064958,-12.830090,12.218922,-8.798142,-7.022094,-4.449725,-3.862610,-12.401447,17.373405,-4.265762,0.191047,8.361908,-4.166783,3.501060,5.511780,7.145808,-8.457310,-0.853956,-5.906618,-1.310111,-13.591880,-7.841030,-2.404275,-1.176068,0.244476,-12.537358,0.133221,6.539019,2.567253,-2.439308,4.442985,0.671434,-1.610998,2.405111,3.892210,2.205750,2.305539,3.322598,-2.128672,-2.810569,-7.853205,-0.693271,8.391124,-6.966443,-5.162796,-5.934501,-0.243830,-2.399793,2.458033,1.313102,3.165905,-5.493762,7.864597,6.343242,3.203839,-2.208588,-4.876781,-1.846253,1.181893,-8.276121,7.040896,-5.169888,-0.936758,-2.779368,-13.693375,0.464404,-2.667568,-6.391836,-2.460092,-5.322445,6.954387,6.432745,3.762485,-0.051482,13.869240,5.251628,-1.105890,-3.663644,-8.891572,7.163285,1.820153,-13.044797,11.241047,-3.687415,-4.014006,-15.665298,-2.296661,2.122230,-5.979325,-6.680262,2.210598,-5.148902,-2.637919,13.151630,11.269243,5.868523,-6.838847,2.791070,-9.572037,11.233301,-5.697322,0.680627,9.010001,-6.630576,-1.557486,-6.888163,3.160741,3.561084,12.995602,-1.736193,-0.680356,-4.581407,1.571770,1.902096,-1.040430,-0.196470,-1.256479,-1.646235,-2.107748,-0.682508,-0.933547,-1.502251,0.782620,-4.177619,-4.317409,-2.904236,-0.953240,-1.107210,0.613386,5.713187,6.643433,-0.617630,3.179970,-13.769864,-6.178021,10.862189,12.813559,0.167551,-16.126310,-4.598581,0.242703,3.672033,9.454399,0.049471,5.174012,2.049595,-6.339099,0.740911,4.185801,-26.814048,-3.078929,-0.389262,-3.277161,10.211104,-4.346446,1.277667,-12.349712,-4.914782,4.313238,7.001608,-25.012071,2.239444,-24.318196,-12.345175,-40.394327,-21.644565,4.185356,8.699331,4.974620,-1.177169,-2.305551,-0.090143,0.660601,-3.051011,6.737016,1.905858,1.478656,-4.833241,-3.242133,-1.764283,1.069297,-0.311744,1.125530,6.583797,3.675685,-5.092384,-1.028548,0.628807,-0.237089,-0.035408,1.435216,-0.745329,0.129429,-0.759118,1.079397,1.873745,-0.031460,-2.709014,-0.742799,-1.473480,-2.083297,-0.949067,1.554080,-1.481585,-1.484594,-0.670667,0.964436,-0.247256,0.241696,-5.179188,5.804675,10.832725,6.073144,15.271147,7.621062,0.411415,3.646982,-1.564305,-14.557393,-9.030527,-1.494947,-10.697292,-4.914596,-12.973684,-6.128677,4.305837,-6.394162,-10.465960,18.716385,-1.903438,2.362243,1.332560,2.682208,1.570786,0.151543,3.557175,0.473832,1.088826,-0.157777,1.070173,-3.876858,-1.941125,1.322948,0.535120,-0.976684,-1.777749,0.288749,2.166398,0.470500/), (/outputlayerSize,hiddenlayerSize_qcl/))
end subroutine define_neuralnet_qcl





subroutine define_neuralnet_qci (mu_in_qci, std_in_qci, weights_input_qci, &
bias_input_qci,bias_output_qci, weights_output_qci)
real(r8), intent(out) :: mu_in_qci(inputlayerSize)
real(r8), intent(out) :: std_in_qci(inputlayerSize)
real(r8), intent(out) :: bias_input_qci(hiddenlayerSize_qci)
real(r8), intent(out) :: bias_output_qci(hiddenlayerSize_qci)
real(r8), intent(out) :: weights_input_qci(hiddenlayerSize_qci,inputlayerSize)
real(r8), intent(out) :: weights_output_qci(outputlayerSize,hiddenlayerSize_qci)


!normalization
mu_in_qci(:)    = (/290.986482,291.160276,291.369437,291.671911,292.156644,292.824394,293.633178,295.239962,297.537474,300.072793,302.802806,305.694461,308.147839,310.152554,312.048464,314.177671,316.612056,319.356528,323.085734,327.468984,333.287859,340.230398,347.722565,360.059747,0.010734,0.010608,0.010383,0.009952,0.009274,0.008554,0.007877,0.006714,0.005130,0.003606,0.002393,0.001443,0.000843,0.000479,0.000258,0.000130,0.000066,0.000036,0.000014,0.000006,0.000004,0.000004,0.000004,0.000004,-0.000018,-0.000034,-0.000047,-0.000048,-0.000041,-0.000032,-0.000027,-0.000027,-0.000028,-0.000021,-0.000008,-0.000043,-0.000044,0.000023,0.000049,0.000050,0.000089,0.000077,0.000045,0.000023,0.000011,0.000006,0.000003,0.000000,12.156107,77.572286/)
std_in_qci(:) = (/9.273619,9.264450,9.286544,9.357647,9.507541,9.703524,9.927421,10.369341,10.952799,11.571941,12.367152,13.542982,14.745508,15.703428,15.877918,14.971957,13.156540,10.906824,8.207128,5.985580,3.883993,2.831051,2.654340,2.244025,0.005378,0.005335,0.005246,0.005048,0.004748,0.004484,0.004244,0.003788,0.003070,0.002330,0.001758,0.001204,0.000779,0.000486,0.000285,0.000153,0.000081,0.000045,0.000019,0.000006,0.000002,0.000001,0.000001,0.000001,0.002870,0.005666,0.007888,0.009511,0.010851,0.012191,0.013545,0.015413,0.017053,0.018933,0.021285,0.023856,0.025488,0.026213,0.026707,0.026811,0.024668,0.015465,0.009132,0.005407,0.002946,0.001569,0.000833,0.000217,5.475639,36.830774/)
! NN biases and weights
bias_input_qci(:) = (/ -5.684510,-0.255536,-0.826359,1.511782,1.492374,2.783102,1.331897,2.999079,2.566873,6.106173,-6.039749,4.086212,0.510476,5.207262,2.857624,-0.723101,3.316282,-1.720715,-1.473080,3.817359/)
bias_output_qci(:) = (/-11.008792,-10.697483,-7.989786,-20.457010,-14.627553,-26.181540,-9.420407,-12.151063,-13.606091,-11.446532,-24.888894,-14.715036,-14.503497,-6.888314,-19.319198,-8.620894,-11.651866,-10.376168,-19.162564,-12.400294,-7.563166,-17.469338,-37.554352,-21.324965/)
weights_input_qci(:,:) = reshape((/ -3.669911,-0.481416,0.795555,-3.894354,-3.558903,-3.478718,1.725364,-1.864027,-4.776889,-3.854087,0.645375,-2.186241,0.773236,-6.229679,-0.988553,2.958992,-2.538265,4.287781,1.923414,-4.596280,3.321593,0.798276,1.591219,-4.385620,-2.921104,-6.107242,-1.944929,0.700047,-1.363570,-2.610290,1.795838,-1.562158,0.616974,-6.710750,-0.116868,2.268145,-4.066885,0.253443,0.854401,-4.260186,1.549858,-1.710057,0.955029,-1.729906,-0.279911,-2.550240,0.114421,2.828452,-3.077996,-3.476368,-0.447388,-0.204572,0.080252,-3.637699,-0.643644,1.732410,-3.784654,1.386728,0.135669,-4.482247,1.467532,6.914989,-10.070628,7.906679,4.654016,2.606862,2.482368,2.666091,-2.064171,0.570339,-0.479118,-16.311733,-2.622965,-21.183178,-3.283026,2.538691,-4.332829,3.384055,1.334929,-4.765742,3.307067,0.420905,3.764733,0.540771,3.009836,-6.229219,2.439726,-0.350894,-7.145582,-1.707741,3.902632,-6.910006,1.018115,-5.029610,-0.560927,2.595609,-0.063684,0.060793,2.816095,-0.718719,-0.662702,-3.837968,1.864108,-6.708515,-2.839488,-6.542491,-2.571582,2.509357,-6.108531,3.509712,-2.353699,-2.773207,-1.564991,-2.250262,-1.731678,-6.293560,-1.822946,0.415999,-1.318485,6.111244,2.524011,-1.896963,0.434934,-1.630117,0.327564,-4.690598,2.401249,1.970196,-4.410533,-1.836593,0.140317,-4.784700,-2.318648,-3.945455,-0.004739,1.202643,-3.748457,-0.287429,-0.507499,-3.590982,0.736071,-1.296897,9.030701,-2.500174,-2.868460,1.550029,2.040502,1.310042,-8.886230,7.142150,1.851495,-1.926638,0.906915,-3.765061,0.305923,9.197084,-7.644548,-0.779591,0.874583,-5.462917,1.354206,-0.397234,1.384635,-2.198320,-3.900575,-2.532824,-1.313648,6.178860,-6.521625,3.997077,-0.901330,-3.726031,2.298797,-7.043730,-3.308564,-3.748117,-11.351277,1.231005,2.187655,-7.860205,6.553677,-0.174910,-2.747493,-2.278529,1.687172,-5.509254,-2.233344,0.735921,-5.345811,-5.668423,-1.434075,-3.539583,1.158336,-12.810604,1.383956,-3.516910,-1.334282,2.842662,0.255783,-9.826001,-0.305779,6.708997,-1.550290,-3.311545,-3.697283,-5.097875,5.377824,0.172244,4.176931,3.020453,-3.683684,-6.663013,-0.075461,-0.238464,-1.704841,-0.696771,-4.990202,7.278390,5.868024,-2.251431,5.979885,-1.776919,-3.588835,-1.136285,1.519957,-4.638523,3.186923,-2.165493,-8.642143,-0.488850,6.286424,-4.452642,1.164198,-6.185438,1.478962,0.893923,-3.812312,0.733807,0.349458,-8.888230,4.539380,4.308478,1.472079,-1.874451,-1.472552,-3.582002,-0.077279,4.722977,-1.056897,-5.672885,1.501249,-0.295420,-2.223663,-2.589120,0.154919,-3.164792,-6.640298,1.374278,0.001388,-4.835398,0.535986,-0.552754,0.687056,-0.585075,-0.486475,-1.822904,0.394279,0.173881,-1.958663,-0.802969,0.028018,-1.381883,-0.185181,-1.905547,-1.502829,1.013100,-2.271833,0.626328,0.026009,-1.893716,8.650241,5.686665,-1.311266,2.071196,0.046720,-2.240904,2.081240,10.166204,1.297711,-2.058841,-2.862220,-7.338765,-0.051351,-5.565150,4.041415,-3.133656,-9.624104,7.378620,0.526114,-5.553996,2.399111,-3.428542,3.955757,-4.406459,-1.731541,-3.671178,0.019422,2.921389,-2.519955,-3.761908,1.141039,-0.295547,-0.368504,-3.646639,0.234231,4.701641,-7.523762,1.889708,4.241398,-6.527148,1.927893,-0.506745,-3.714148,-4.269476,0.242636,-9.204574,-0.939756,4.718504,-0.921104,-2.172100,3.360380,4.079188,3.059494,-5.284869,-2.266450,-1.993546,-8.294381,-3.739152,2.823219,-8.191334,3.620867,-4.201801,-0.075131,-2.250877,-0.777805,-2.687526,-1.945620,3.797537,-3.333071,-5.657685,0.430992,-0.635894,-0.532567,-5.354613,-3.509316,0.338325,-4.397768,-1.512554,0.364247,-2.574770,0.815804,-5.615491,10.449074,2.659004,0.814096,-4.560047,-9.834039,-5.857590,-6.751251,-12.871999,-2.015748,-16.857161,4.521400,-1.501209,-4.080808,-0.104240,-12.860074,-6.868417,-1.491067,-12.149615,-0.331358,-2.403877,3.228024,-1.494102,6.782294,-6.165837,-2.851589,3.998357,-4.589384,-5.521273,4.161122,-1.158312,-1.514484,-11.286064,-2.008639,5.442196,-11.381597,0.750290,-0.643517,-4.515007,1.738934,-0.713587,0.593392,-1.337194,-0.300845,-3.353310,0.437163,1.758868,-2.854291,-2.060260,-0.123790,-2.749269,-0.333248,-4.800913,-2.123835,3.031630,-2.122402,1.458773,0.666020,-2.770734,7.983293,-8.497972,8.696291,-0.406663,7.115772,-17.051439,-3.896953,4.868623,-3.343937,-4.207026,-6.402156,-1.934313,0.178688,-25.388247,-10.282633,3.048655,-11.169698,-5.896670,7.094571,-14.699699,9.347077,-6.064016,-23.374285,-3.811136,8.020459,-5.499789,-1.392978,6.334403,-15.891055,-4.853768,5.892521,-9.683605,2.167764,-22.971950,3.167089,-1.251428,5.797422,3.710733,-7.498089,-4.481690,-1.663672,0.338184,-6.236022,4.700684,-0.339834,2.380274,-10.876244,-6.123771,-7.451903,-7.071879,-0.493040,0.173184,3.225965,-2.603247,-5.512028,1.037076,-10.293262,0.046116,-3.753517,-9.834293/), (/hiddenlayerSize_qci,inputlayerSize/))
weights_output_qci(:,:) = reshape((/ 0.331679,-0.157652,0.248248,-0.180188,0.290406,-0.195329,-0.216722,-0.234231,-0.101436,-0.084677,-0.137355,-0.194908,0.455525,-0.098474,0.144463,-0.185674,0.063271,0.357297,-0.309307,-0.378748,0.282731,-0.134892,0.214311,-0.153536,0.249603,-0.160276,-0.178523,-0.201457,-0.086892,-0.070913,-0.117088,-0.166430,0.383100,-0.081646,0.124312,-0.156501,0.053136,0.302662,-0.263398,-0.346886,0.289207,-0.138443,0.221873,-0.157239,0.257942,-0.158162,-0.176959,-0.208683,-0.090064,-0.071683,-0.120125,-0.171002,0.389252,-0.081876,0.128648,-0.158538,0.053593,0.308285,-0.270630,-0.375445,0.309922,-0.148926,0.240444,-0.168879,0.280336,-0.162450,-0.183186,-0.226074,-0.097011,-0.076142,-0.128950,-0.184020,0.416412,-0.086442,0.139583,-0.167389,0.056199,0.329179,-0.293080,-0.427776,0.309278,-0.150030,0.243930,-0.168474,0.282950,-0.154928,-0.176424,-0.228113,-0.097830,-0.075327,-0.130463,-0.184499,0.415827,-0.084798,0.140685,-0.165554,0.054499,0.326792,-0.296145,-0.458361,0.287242,-0.140257,0.229180,-0.156071,0.264151,-0.136337,-0.156800,-0.213460,-0.091558,-0.068782,-0.122682,-0.171936,0.386592,-0.077125,0.131873,-0.152551,0.048975,0.302349,-0.276234,-0.458839,0.261865,-0.128388,0.210263,-0.141846,0.241290,-0.116426,-0.135386,-0.195182,-0.083932,-0.061581,-0.112558,-0.156973,0.351455,-0.068706,0.120929,-0.137074,0.042673,0.274647,-0.252304,-0.455563,0.226148,-0.111608,0.182557,-0.121713,0.207825,-0.093374,-0.109540,-0.168976,-0.073032,-0.052224,-0.097895,-0.136226,0.303949,-0.057809,0.104781,-0.116421,0.034526,0.236145,-0.218621,-0.432938,0.179273,-0.089653,0.145564,-0.095446,0.164112,-0.070124,-0.082095,-0.135729,-0.059447,-0.041636,-0.078528,-0.108120,0.244190,-0.045559,0.084669,-0.092215,0.026918,0.186087,-0.174580,-0.366934,0.122155,-0.062504,0.100674,-0.063609,0.111804,-0.046631,-0.054461,-0.095932,-0.042626,-0.029233,-0.053832,-0.073203,0.172210,-0.031719,0.059719,-0.063438,0.019445,0.126575,-0.120481,-0.256096,0.092557,-0.047916,0.077727,-0.046222,0.083436,-0.032353,-0.038524,-0.076622,-0.034071,-0.022966,-0.041930,-0.054648,0.139855,-0.024959,0.047221,-0.050060,0.015918,0.096829,-0.092034,-0.193082,0.071328,-0.036998,0.062013,-0.034314,0.061323,-0.020065,-0.024930,-0.062346,-0.027326,-0.018023,-0.033867,-0.041253,0.115931,-0.019908,0.038017,-0.040529,0.012623,0.075536,-0.070298,-0.163511,0.064412,-0.034030,0.059750,-0.031152,0.051343,-0.013585,-0.017695,-0.061154,-0.025291,-0.015457,-0.032071,-0.037620,0.112279,-0.017604,0.036348,-0.038872,0.011776,0.070006,-0.062337,-0.182578,0.051543,-0.027738,0.050784,-0.025967,0.036763,-0.009026,-0.012437,-0.050435,-0.019986,-0.009742,-0.027768,-0.030747,0.088362,-0.011183,0.029437,-0.032769,0.008518,0.055999,-0.046074,-0.187086,0.046651,-0.024653,0.045644,-0.023044,0.029084,-0.005664,-0.008975,-0.045138,-0.017602,-0.007647,-0.025198,-0.026870,0.079889,-0.008927,0.026640,-0.028535,0.006117,0.050940,-0.037958,-0.188903,0.041612,-0.021511,0.040567,-0.019899,0.019368,0.000060,-0.002852,-0.038936,-0.014560,-0.004305,-0.023368,-0.023179,0.070700,-0.005452,0.022907,-0.024400,0.002580,0.045555,-0.028623,-0.211880,0.040513,-0.022555,0.043396,-0.020292,0.011032,0.008763,0.006639,-0.038484,-0.013639,0.000411,-0.024422,-0.023674,0.066312,0.000004,0.021863,-0.021575,-0.002297,0.043349,-0.023265,-0.308324,0.080792,-0.040425,0.067003,-0.034474,0.016089,0.012898,0.006739,-0.061893,-0.021547,-0.007936,-0.025974,-0.040682,0.116717,-0.003478,0.029279,-0.021817,-0.009888,0.088223,-0.033223,-0.379874,0.100221,-0.043224,0.075701,-0.037731,-0.003061,0.008213,-0.006398,-0.083679,-0.023923,-0.008040,-0.024299,-0.048779,0.150935,0.002030,0.020548,-0.031783,-0.008454,0.121779,-0.016482,-0.345691,0.154686,-0.016366,0.083214,-0.032384,-0.108732,0.045785,0.015450,-0.144371,-0.033487,-0.004255,-0.007992,-0.043713,0.209184,0.001525,0.010832,0.005596,0.023388,0.122566,0.046270,-0.250862,0.161936,-0.013485,0.071974,-0.039852,-0.134752,0.066064,0.020851,-0.159875,-0.045441,0.013646,0.002595,-0.023819,0.217512,0.003500,0.023673,0.026054,0.031887,0.102423,0.052725,-0.237793,0.095340,-0.005634,0.045104,-0.034572,-0.104657,0.060211,0.006613,-0.115260,-0.040004,0.024972,0.011324,-0.008216,0.157837,-0.007379,0.028934,0.013992,0.017564,0.061988,0.033770,-0.170607,0.005706,-0.000035,0.003316,-0.002674,-0.008134,0.004657,0.000324,-0.008333,-0.003274,0.002037,0.000795,-0.000629,0.012013,-0.000634,0.002823,0.001104,0.001460,0.004466,0.002369,-0.012937,-0.002013,0.000001,-0.001194,0.000961,0.002931,-0.001671,-0.000118,0.002984,0.001183,-0.000728,-0.000277,0.000231,-0.004324,0.000223,-0.001033,-0.000404,-0.000535,-0.001606,-0.000850,0.004654/), (/outputlayerSize,hiddenlayerSize_qci/))
end subroutine define_neuralnet_qci



subroutine define_neuralnet_rainsurf (mu_in_rainsurf, std_in_rainsurf, weights_input_rainsurf, &
bias_input_rainsurf,bias_output_rainsurf, weights_output_rainsurf)
real(r8), intent(out) :: mu_in_rainsurf(inputlayerSize)
real(r8), intent(out) :: std_in_rainsurf(inputlayerSize)
real(r8), intent(out) :: bias_input_rainsurf(hiddenlayerSize_rainsurf)
real(r8), intent(out) :: bias_output_rainsurf(hiddenlayerSize_rainsurf)
real(r8), intent(out) :: weights_input_rainsurf(hiddenlayerSize_rainsurf,inputlayerSize)
real(r8), intent(out) :: weights_output_rainsurf(1,hiddenlayerSize_rainsurf)


!normalization
mu_in_rainsurf(:)    = (/290.986482,291.160276,291.369437,291.671911,292.156644,292.824394,293.633178,295.239962,297.537474,300.072793,302.802806,305.694461,308.147839,310.152554,312.048464,314.177671,316.612056,319.356528,323.085734,327.468984,333.287859,340.230398,347.722565,360.059747,0.010734,0.010608,0.010383,0.009952,0.009274,0.008554,0.007877,0.006714,0.005130,0.003606,0.002393,0.001443,0.000843,0.000479,0.000258,0.000130,0.000066,0.000036,0.000014,0.000006,0.000004,0.000004,0.000004,0.000004,-0.000018,-0.000034,-0.000047,-0.000048,-0.000041,-0.000032,-0.000027,-0.000027,-0.000028,-0.000021,-0.000008,-0.000043,-0.000044,0.000023,0.000049,0.000050,0.000089,0.000077,0.000045,0.000023,0.000011,0.000006,0.000003,0.000000,12.156107,77.572286/)
std_in_rainsurf(:) = (/9.273619,9.264450,9.286544,9.357647,9.507541,9.703524,9.927421,10.369341,10.952799,11.571941,12.367152,13.542982,14.745508,15.703428,15.877918,14.971957,13.156540,10.906824,8.207128,5.985580,3.883993,2.831051,2.654340,2.244025,0.005378,0.005335,0.005246,0.005048,0.004748,0.004484,0.004244,0.003788,0.003070,0.002330,0.001758,0.001204,0.000779,0.000486,0.000285,0.000153,0.000081,0.000045,0.000019,0.000006,0.000002,0.000001,0.000001,0.000001,0.002870,0.005666,0.007888,0.009511,0.010851,0.012191,0.013545,0.015413,0.017053,0.018933,0.021285,0.023856,0.025488,0.026213,0.026707,0.026811,0.024668,0.015465,0.009132,0.005407,0.002946,0.001569,0.000833,0.000217,5.475639,36.830774/)
! NN biases and weights
bias_input_rainsurf(:) = (/ 1.994674,2.664735,10.715821,0.708252,-0.724675,-1.189933,2.415242,0.066069,1.227078,-0.211272,1.885258,1.646204,-0.005617,-7.324562,-8.903205,-1.832727,1.065180,0.039754,-0.888577,0.569932/)
bias_output_rainsurf(:) = (/0.782148/)
weights_input_rainsurf(:,:) = reshape((/ -0.840036,1.988340,-2.436202,-0.265816,1.339671,-1.843830,2.557355,-2.296450,-0.155496,-0.422234,0.328454,-0.068968,0.340775,-0.616838,0.462824,-0.450367,0.344662,0.337024,0.522775,-0.111180,-0.058406,0.119096,-0.201058,-0.026067,1.119593,-1.303478,0.274997,-0.178096,0.087365,-0.711301,0.958143,-0.446895,-0.426402,0.203076,-0.379841,0.173783,-0.004259,-0.010050,0.028948,-0.013251,-0.067897,0.081925,-0.044433,-0.045096,0.069470,-0.084149,0.060031,0.047483,0.067088,-0.197102,0.095178,0.112912,-0.065287,-0.030762,0.006146,-0.008331,0.014483,-0.006289,0.009038,-0.014176,-0.000068,0.007298,-0.000708,0.009992,-0.019915,0.000419,-0.002932,-0.012439,0.017069,-0.039030,0.027887,-0.005554,-0.082633,0.090349,1.151869,-0.401577,-2.632572,-0.748355,-0.270995,0.857668,0.879803,0.221838,0.026858,0.633780,2.227606,1.706485,0.742626,1.775840,-1.327705,0.844852,-0.338356,-0.330157,1.214853,-0.299203,-0.136150,-0.725161,-0.315969,0.650838,-2.237293,2.775456,1.580188,-4.064155,0.068801,-0.127138,0.519987,-0.144159,-0.056548,-0.501296,-0.314068,0.155822,-0.176695,-0.054019,-0.250001,-0.250657,-0.143001,-0.981260,0.757354,2.831541,0.224722,0.978356,-0.773091,0.113832,0.055113,-0.067303,-0.267029,0.456489,-0.154628,-0.007080,-0.086041,0.056695,0.054054,0.009888,-0.023192,0.045061,-0.043052,-0.008300,0.042844,-0.070712,0.062035,0.004455,0.007444,-0.052202,0.025572,0.013099,-0.019073,0.007365,-0.348061,0.618923,-0.011180,2.173985,7.031716,9.725632,3.616382,-6.608159,-11.692703,-2.659935,5.068171,-0.683408,-6.611512,-0.890128,-3.625126,7.429004,-0.584713,2.475958,1.562477,3.753360,0.742178,1.382257,0.263428,-5.448836,5.216746,0.104477,6.672664,-11.902794,-14.019479,11.144532,6.194153,3.174693,-5.161010,-4.889423,0.941176,-0.868969,2.968837,-2.960546,0.965194,-0.243970,0.271258,0.909621,1.351459,-0.770598,-6.485600,12.952012,0.190197,-0.534025,-1.552878,0.410355,-0.176314,0.364084,-0.374862,0.359127,-0.465218,0.697819,-0.723983,0.590594,-0.336167,0.196537,-0.072603,0.143555,0.047131,-0.361101,0.448561,-0.257722,0.259463,0.143027,-0.099864,0.030520,-0.022630,0.090253,-0.075489,0.019383,-0.375962,0.447398,-0.396567,0.696672,-0.116281,0.709211,-0.811375,0.673295,0.076972,2.276149,0.947366,0.560022,-0.601927,0.705964,-4.118278,-1.506784,0.608816,0.646972,1.619079,0.293292,0.580937,-0.202732,0.191660,-0.121855,-0.134319,-0.115875,-0.378050,2.727780,1.224798,-2.944952,-2.402712,-1.759103,0.823954,-0.025215,-0.026712,-0.348209,-0.761923,0.426545,-0.115354,0.073679,0.039303,0.173614,-0.405903,0.401526,-0.281391,0.129067,-0.001653,-0.058725,0.064929,-0.008161,0.175931,-0.351119,0.083274,0.065010,-0.040267,0.137500,-0.195952,0.038718,-0.021721,0.144974,-0.024706,0.031255,-0.014018,0.025495,-0.027350,-0.018701,0.003853,0.010445,-0.028783,-0.009734,-0.000590,0.013529,-0.023877,0.037485,-0.344142,1.130798,0.987551,-2.776301,-0.508809,1.408513,0.216770,0.511410,-0.778431,-1.823177,-1.344653,-0.658731,0.639544,-0.805807,4.504720,1.256029,-0.637762,-0.302189,-1.720388,-0.399358,-0.489770,0.191609,-0.189171,0.093711,0.135512,0.116427,0.299407,-3.495183,-0.870091,3.212278,2.452565,2.116050,-1.231605,0.274561,-0.017990,0.312845,0.742955,-0.426085,0.127727,-0.075687,-0.044203,-0.165229,0.406156,-0.408843,0.296780,-0.139068,0.006985,0.067863,-0.060548,-0.000459,-0.186119,0.391815,-0.102443,-0.098815,0.068963,-0.152411,0.197926,-0.037176,0.027612,-0.147537,0.028734,-0.028345,0.013149,-0.020210,0.025315,0.016643,-0.004532,-0.008058,0.025623,0.013550,-0.002606,-0.010535,0.022565,-0.039361,0.287497,-1.151191,2.355578,-4.057644,1.020997,2.824464,1.065523,-3.750143,-0.414060,3.170983,-0.093354,-0.050769,-0.620295,0.029528,0.057387,-0.180119,0.618288,0.154818,0.035381,-0.352821,-0.057135,-0.028876,0.065434,0.070827,0.000215,0.004379,1.365440,-2.128309,0.097314,0.921516,-0.381727,-1.358179,0.283273,0.316220,0.048328,-0.059565,0.018117,0.021586,-0.038270,0.018367,-0.006549,0.021386,0.010419,0.003953,0.022850,-0.010941,0.024511,-0.028401,-0.009364,0.006306,0.044162,0.114666,-0.264718,0.151903,-0.100124,0.099681,-0.033153,-0.017017,0.007529,-0.037437,0.006095,-0.018631,0.008703,-0.003083,-0.008958,0.003629,0.010946,-0.000891,-0.021459,0.028823,-0.016791,0.006544,-0.002288,0.000855,-0.006366,-0.140274,1.040489,-0.245260,-1.758500,-2.270493,0.949138,-0.205482,0.687155,0.333270,0.469986,0.733764,2.164140,1.639689,0.680386,1.693957,-1.335874,0.700627,-0.393515,-0.345759,1.059075,-0.253939,-0.120293,-0.565763,-0.380913,0.579906,-1.618602,2.959323,1.342477,-4.153748,0.282457,-0.449036,0.324682,-0.179030,0.108627,-0.532363,-0.269110,0.101938,-0.196699,-0.082077,-0.205005,-0.179726,-0.250467,-0.557482,0.611316,2.444008,0.183171,0.902283,-0.761336,0.125821,0.053676,-0.055261,-0.282428,0.468384,-0.154628,-0.017945,-0.067906,0.047778,0.051771,0.008247,-0.026151,0.042849,-0.042524,-0.010478,0.040158,-0.068332,0.063039,-0.001741,0.008993,-0.050321,0.013408,0.023523,-0.029479,0.012073,-0.410968,0.719052,0.085953,-0.821807,0.505606,-0.020522,1.379145,0.293894,-2.164038,1.374352,0.528353,-0.591250,-0.067133,-1.354758,0.740375,-1.235478,-0.592726,1.300087,0.537590,-0.489567,0.275260,-0.073014,0.042375,0.108662,0.035408,-0.070393,0.471707,0.235287,0.357066,-0.292801,-0.416829,-1.337524,0.395140,0.433117,-0.172408,0.055583,-0.263472,0.012558,-0.092601,0.017686,-0.000702,0.020451,-0.079190,0.086338,-0.001523,-0.016922,0.083424,-0.078612,0.020424,0.002316,0.116361,-0.067631,-0.195545,0.255785,-0.117775,0.009790,-0.009290,0.026883,-0.004424,0.012085,-0.014946,-0.014432,-0.011585,0.011898,-0.018986,0.002558,-0.005147,0.006020,-0.026090,0.017839,-0.004100,0.003424,-0.011782,0.007202,-0.350968,0.215029,-0.933655,-3.878880,0.917299,1.312921,1.809470,3.745218,-1.986271,1.033537,-0.315808,-0.152446,-0.187060,0.292578,-1.226651,-1.361192,0.267207,1.217562,0.473796,-0.146219,0.641470,-0.080078,0.010726,-0.126068,-0.083856,-0.077104,-1.195034,0.426470,1.429482,-1.132769,0.066858,-0.973796,0.065178,0.329065,-0.076794,-0.317951,-0.582170,0.290803,-0.056074,0.051247,-0.006620,0.119857,-0.219880,0.175767,-0.118794,0.027258,0.020067,-0.022550,0.087666,-0.041526,0.084689,-0.065692,-0.134091,0.123195,-0.018844,0.067889,-0.133378,0.028722,-0.009215,0.065181,-0.002784,0.016588,-0.009660,0.028377,-0.020064,-0.012708,-0.003181,0.014028,-0.023139,-0.007652,-0.002250,0.008901,-0.009959,0.014009,-0.347937,0.618425,-4.068707,-1.212269,3.936972,1.015111,-2.351548,-3.090555,2.978103,0.483942,1.124820,0.906191,-0.641074,-1.815195,0.595308,-0.235847,-0.968600,-0.883393,-0.761991,1.014619,-0.733813,-0.106660,0.540325,-0.238180,0.502770,-0.168922,0.927473,2.667740,0.584861,-0.538127,1.235539,-2.106424,-1.036136,1.347955,0.221270,0.021312,0.514993,-0.404128,0.072058,-0.073936,0.071722,-0.111500,0.151374,-0.180492,0.022959,0.051000,-0.087733,0.020523,0.009916,-0.102988,0.183088,-0.005865,-0.275177,-0.174930,0.345796,0.150205,-0.211528,-0.019589,-0.007396,0.016026,0.001130,-0.046295,0.018359,-0.023070,0.011771,0.001681,-0.038821,0.058922,-0.055978,0.080338,-0.017057,0.011836,-0.025673,0.004333,-0.493724,0.265264,-4.570537,1.656654,-0.417251,2.683724,0.311768,-5.419639,-2.395887,2.073622,2.490399,-0.564456,-0.703793,-0.622335,0.074283,-0.163835,0.438944,1.103729,-0.181442,-0.590094,-0.506020,1.013326,-0.455832,-0.328415,0.257722,-1.132054,1.980279,4.363523,-3.180373,1.503674,0.125471,-2.102219,0.445313,-0.826268,0.697521,-0.121475,0.539977,-0.497881,0.189942,-0.191383,-0.040347,0.080014,0.048402,-0.170688,-0.129039,0.302198,-0.055340,-0.248916,1.069455,0.378789,-0.171715,0.406319,-0.304085,-0.128776,0.391225,-0.215336,-0.052033,0.084697,0.047214,-0.084216,0.020419,0.013451,-0.020536,0.061418,-0.042523,0.050601,-0.053669,0.061079,-0.032975,0.081413,-0.101726,0.066320,-0.059922,0.020685,-0.665239,1.155208,-10.547415,-3.975758,3.146520,6.040654,-1.593324,-5.291112,-1.364549,1.555599,5.249202,1.605238,2.163220,2.224329,-0.463450,0.631106,-2.342702,0.716109,0.526769,-3.717372,0.695757,0.719599,-0.224502,0.094614,0.385866,-0.262253,7.786315,-6.442141,3.069376,-0.261441,1.147921,-2.943575,-0.212613,-1.146044,0.684834,0.504887,0.124226,-0.002109,-0.033791,-0.061919,-0.070223,-0.033064,0.247983,-0.275801,0.081876,0.017757,-0.033896,0.096382,-0.121941,-0.012523,0.153300,-0.053265,-0.054201,-0.130673,-0.068794,0.248952,-0.115958,-0.075244,0.006232,0.041778,-0.052306,-0.014160,0.030803,-0.036169,-0.006663,-0.031728,-0.021687,0.035708,-0.003230,-0.022444,-0.004940,0.034374,-0.036439,0.004484,-1.136610,0.779701,-0.639447,0.251334,-0.386407,0.484152,-1.316755,0.232314,2.196192,-1.978025,-0.470895,0.623644,-0.019788,1.727960,-0.790144,1.526773,0.661295,-1.285239,-0.765706,0.621509,-0.365453,0.082124,-0.053844,-0.082817,-0.063146,0.072887,0.251439,-1.377093,0.010197,0.436317,0.620832,1.266188,-0.513314,-0.592415,0.147910,-0.055235,0.319138,0.001221,0.116615,-0.030053,0.008318,-0.032679,0.117726,-0.126599,0.008313,0.005884,-0.078792,0.068579,-0.008951,-0.002896,-0.129529,0.134638,0.127051,-0.266769,0.146980,0.010738,-0.010822,-0.036268,0.004001,-0.017398,0.019620,0.011912,0.014280,-0.010328,0.019998,0.000348,0.000537,-0.004078,0.022222,-0.016516,0.006575,-0.007331,0.016593,-0.010306,0.338252,-0.247883,-2.512901,-2.066676,-3.518652,-1.667563,6.190916,4.295959,-1.464966,-1.639878,-2.395769,1.830353,0.031921,1.532084,-2.860648,0.066255,1.215267,-2.001342,-1.910877,-5.268197,-5.195238,-0.448689,-3.614173,1.508648,2.262820,-0.519058,-0.541895,7.000339,4.176950,-1.676719,0.055237,-0.912291,0.639594,3.979963,0.612171,3.011655,2.483128,-0.459734,0.432059,-3.446508,2.643698,-1.108822,-0.404558,-0.219877,3.112260,-1.089588,0.369169,0.086931,0.064494,-0.167410,-0.049136,0.122754,-0.196390,0.297783,-0.237842,0.057439,0.138878,-0.101129,0.043243,-0.042673,-0.057685,0.066102,-0.161146,0.101557,-0.381162,0.446202,-0.439311,0.072186,0.035969,0.097780,-0.110303,0.082812,-0.062620,0.025160,0.928598,-0.879892,-3.146180,-2.150855,-2.066432,-3.549131,2.291786,10.923930,4.172997,-0.408621,-1.647521,-3.808318,8.057395,-0.304289,2.477189,-10.849204,-4.923729,2.468492,-1.160262,-9.152013,-4.632428,-1.213871,-3.359196,1.323712,3.047406,-0.725355,0.128725,5.881639,6.376421,0.860848,-2.437686,-3.021871,1.241757,6.818842,0.353444,1.702466,3.590063,-1.248870,0.989459,-4.940029,3.375113,-1.472726,0.736290,-0.282604,3.157879,-1.209526,0.443116,0.125206,-0.102038,-0.105022,-0.021261,0.114984,-0.256613,0.352759,-0.295838,0.105302,0.107756,-0.079633,0.025355,-0.020441,-0.070250,0.042076,-0.151816,0.136568,-0.361034,0.409703,-0.521716,0.135562,-0.007803,0.149583,-0.150829,0.109847,-0.075004,0.021495,1.336729,-1.396672,0.570887,2.393177,-0.195188,-1.390439,-1.014003,4.083247,2.940451,-1.427223,-2.692339,0.493760,1.062680,0.548438,-0.143678,0.214090,-0.388333,-1.264699,0.272727,0.431512,0.721396,-1.015180,0.427549,0.365411,-0.260451,1.143959,-3.597714,-2.128737,2.610373,-1.366777,-0.506954,1.777429,-0.061887,0.924441,-0.708518,0.089782,-0.566778,0.516945,-0.217080,0.221111,0.034050,-0.081567,-0.043814,0.172148,0.130428,-0.318087,0.057286,0.237494,-1.094314,-0.379935,0.202707,-0.484028,0.376498,0.134743,-0.436387,0.224136,0.058790,-0.090410,-0.040789,0.088038,-0.023743,-0.011845,0.020521,-0.061783,0.040647,-0.050388,0.053822,-0.061788,0.039038,-0.088921,0.105005,-0.060685,0.054934,-0.018173,0.553016,-1.084801,0.101824,-1.459577,-0.021090,3.465542,-0.343312,-3.678001,1.652391,-0.106051,0.131347,0.081280,-0.102404,-0.286994,-0.004784,-0.171384,0.170064,-0.387012,0.227569,0.244826,0.079285,-0.029914,0.014582,0.026984,-0.047221,0.008804,0.789759,-0.835884,0.439685,0.341618,-0.437587,-1.113951,0.773623,-0.173288,-0.064349,0.061249,-0.122730,0.047299,-0.012368,0.001652,0.012089,-0.011538,-0.013250,0.021485,-0.014075,-0.005645,0.019324,-0.020008,0.013201,-0.000279,0.046897,-0.080851,-0.004183,0.077672,-0.025905,-0.002469,-0.017885,-0.003776,-0.000688,-0.000634,0.001074,-0.012630,0.002258,-0.001644,0.002072,0.004339,-0.013443,0.006212,-0.008249,0.003474,0.003151,-0.010996,0.009801,-0.003093,-0.110509,0.077222,9.941551,-5.250503,-2.248335,0.349378,-1.638853,-1.652346,0.478384,1.881270,0.426760,-0.489809,1.554463,-2.983039,0.396353,-1.948090,-2.117480,0.621032,1.050094,-0.180468,0.218671,-0.347375,0.284590,-0.235106,-0.330772,0.036958,1.836386,1.011724,0.546921,-2.108451,-0.372367,-1.627313,1.030277,1.009534,-0.474334,0.379072,-0.180201,-0.102571,0.193947,-0.204170,0.227522,-0.184990,0.141848,-0.205470,-0.016375,0.000505,-0.099038,0.158907,0.079136,-0.122077,0.285382,-0.508161,0.138517,0.097459,-0.138132,0.310449,-0.384413,0.205616,-0.103818,0.126157,-0.059971,-0.003304,-0.020280,-0.004307,0.023756,-0.038999,-0.046849,0.060273,-0.047322,0.030383,0.043859,-0.043937,0.006450,0.002305,-0.074090,0.222233,-1.234898,5.074882,-2.211042,-5.118894,-0.191404,1.663168,0.481051,2.933417,-0.211857,-0.037099,0.558655,-0.867084,0.651961,-1.542735,0.714855,0.325719,0.432795,-0.719811,-0.113123,-0.171189,0.248818,0.047061,0.070566,-0.035285,0.008670,2.088632,-1.957945,-0.447343,0.062243,-0.564495,0.042399,0.772928,-0.051037,0.088750,-0.018658,-0.064251,-0.027276,-0.029746,0.048808,-0.004430,0.027902,-0.025928,0.033522,-0.011944,-0.020857,0.016603,-0.058788,0.001960,0.140130,0.106298,-0.457334,0.251345,-0.178870,0.241434,-0.099737,0.020871,-0.014318,-0.025284,0.017296,-0.030275,0.004040,0.003889,-0.022083,-0.001682,0.018678,0.002543,-0.036908,0.061330,-0.036898,0.022510,-0.025102,0.017383,-0.237964,0.035408,-3.945677,6.157711,-2.202371,-1.289028,-1.414034,0.736054,0.867179,-1.029262,0.585963,-0.017357,1.207254,-1.279511,0.434001,-0.976544,-0.747543,0.110866,0.598753,-0.065543,0.045582,-0.110031,0.111229,-0.018607,-0.088766,0.008696,-0.162911,2.969293,-0.566368,-1.131672,-0.029880,-0.802818,0.589537,-0.055241,-0.170938,0.245277,-0.102465,-0.044720,0.056172,-0.082772,0.090287,-0.090623,0.084004,-0.098061,0.007537,-0.007257,-0.029019,0.051061,-0.003419,-0.035772,0.128337,-0.166495,-0.036973,0.094240,-0.054151,0.114600,-0.136033,0.065716,-0.037378,0.044623,-0.011618,-0.013797,-0.008036,0.006466,0.002022,-0.005930,-0.030521,0.024119,-0.023928,0.021458,0.001816,-0.005372,-0.002898,0.005071,-0.335392,0.286883/), (/hiddenlayerSize_rainsurf,inputlayerSize/))
weights_output_rainsurf(:,:) = reshape((/ 0.832414,3.090742,-0.383174,-1.700066,-1.501130,1.944594,-3.159245,-2.466599,1.139987,0.194276,-1.351931,-0.131841,-2.019632,-2.780790,2.443139,-1.312317,-3.180496,-0.362731,-0.814820,1.553856/), (/1,hiddenlayerSize_rainsurf/))
end subroutine define_neuralnet_rainsurf





subroutine cloudbrainVerticalGrid(pnet)
real(r8), intent(out) :: pnet(inputlayerSize)

pnet = (/ 3.64346569404006, 7.59481964632869, 14.3566322512925,24.6122200042009, 38.2682997733355, 54.5954797416925, 72.0124505460262,87.8212302923203, 103.317126631737, 121.547240763903, 142.994038760662,168.225079774857, 197.908086702228, 232.828618958592, 273.910816758871,322.241902351379,379.100903868675,445.992574095726, 524.687174707651, 609.778694808483, 691.389430314302, 763.404481112957, 820.858368650079,859.53476652503, 887.020248919725, 912.644546944648, 936.198398470879, 957.485479535535, 976.325407391414, 992.556095123291 /)

end subroutine cloudbrainVerticalGrid

end module cloudbrain_module
