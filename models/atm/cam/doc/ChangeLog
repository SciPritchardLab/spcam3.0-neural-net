===============================================================

cam2_0_2_dev56
Originator: rosinski ( Jim Rosinski)
Date: Mon Dec 29 15:35:44 MST 2003
Model: CAM
Version: CAM2.0_2.dev56
One-line Summary: Enable restarting coupled model from dev51 restart file.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes (done by mvertens)
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes (in coupled mode they now look like dev51 restart files)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Modified coupled-mode CAM restart file to be identical to dev51.
o NOTE: Standalone and SOM restart files are NOT the same.

===============================================================
===============================================================

cam2_0_2_dev55
Originator: jmccaa ( James McCaa)
Date: Mon Dec 22 14:11:07 MST 2003
Model: CAM
Version: CAM2.0_2.dev55
One-line Summary: Tuning mods for finite volume 2x2.5.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes - new-climate for FV
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

Model parameters have been adjusted for runs using the finite volume
dycore.  Changes occurred in the following routines:
cldwat.F90
cloud_fraction.F90
gw_drag.F90
vertical_diffusion.F90
moistconvection.F90
zm_conv.F90

The turbulence mountain stress parameterization is now turned off.  Also, 
the parameters governing gravity wave drag are now the same for FV as for
the spectral dycores.

===============================================================
===============================================================

cam2_0_2_dev54
Originator: pworley ( Patrick H Worley)
Date: Thu Dec 18 09:27:25 MST 2003
Model: CAM
Version: CAM2.0_2.dev54
One-line Summary: Improved existing and added SMP-aware physics load balancing schemes
cam-bugs Requests resolved: none
Requires change in build system: maybe
To exploit alternative EUL and SLD latitude decomposition, need to add -DMIRROR_DECOMP to Makefile
Substantial timing or memory changes: Yes - benchmarks by Rory Kelley indicate that new opt=0 load balancing improves performance
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Tom Henderson
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

1) Added Henderson, et al's modification to call spmdinit_dyn after runtime_options,
   so that future modifications can use namelist input to decide how to decompose
   dynamics data structures.
    added: control/decompinit.F90
    modified: control/cam.F90, control/spmdinit.F90
2) Added Henderson, et al's modification to move duplicate code (ceil_2, pair)
   to a new spmd_util module.
    added: control/spmd_utils.F90
    modified: dynamics/eul - realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90
              dynamics/sld - realloc4.F90, realloc7.F90, scan2.F90, spmd_dyn.F90
              physics/cam1 - phys_grid.F90
3) Determined number of SMPs and process/SMP map. For EUL and SLD, equidistributed extra 
   latitudes (when mod(NLAT/npes) /= 0) over the SMPs. (This is useful when using option 1
   load balancing. See below.)
    modified: control/spmdinit.F90, dynamics/eul/spmd_dyn.F90, dynamics/sld/spmd_dyn.F90,
              dynamics/fv/spmd_dyn.F90
4) For EUL and SLD, added an option to assign latitudes to processes so that southern 
   hemisphere latitudes and their "mirrors" in the northern hemisphere are assigned 
   to consecutive processes. This is useful when using load balancing options 1 and 3 (see below).
   Currently, this is a compile time option. It will be changed to a runtime option
   in the near future. To enable now, the CPP token MIRROR_DECOMP must be added to the
   FPPFLAGS in the Makefile.
    modified: dynamics/eul - spmd_dyn.F90, bndexch.F90; dynamics/sld - spmd_dyn.F90, bndexch.F90
5) Redesigned load balancing options and implementation. The new options are
    -1: each latitude line is a single chunk, same as 1D dynamics decompositions.
        (UNCHANGED)
     0: split local longitude/latitude blocks into chunks,
        while attempting to create load-balanced chunks.
        (IMPROVED) 
     1: split SMP-local longitude/latitude blocks into chunks,
        while attempting to create load-balanced chunks.
        (NEW)
     2: load balance chunks with respect to diurnal and
        seaonsal cycles and wth respect to latitude, 
        and assign chunks to processor 
        in a way that attempts to minimize communication costs
        (UNCHANGED)
     3: load balance chunks with respect to diurnal and
        seasonal cycles (but not latitude), and assign chunks to 
        processor in a way that attempts to minimize communication 
        costs
        (NEW)

     The implementation was significantly modified. The heuristic for
     load balancing is now identical for options 0-3. The only difference
     between the options is which processes are allowed to communicate 
     when load balancing.`

     Performance comparisons on the IBM indicate that the new option 0 is an improvement
     over the old option 0. The other options (especially option 3) are now
     competitive with option 0, but are not noticeably better. These results are for T85L26
     on 128 processors of Bluesky, and different results may hold on other systems or
     for other problem sizes.

      modified: physics/cam1/phys_grid.F90
           
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev53
Originator: hender ( Tom Henderson)
Date: Mon Dec 15 11:55:00 MST 2003
Model: CAM
Version: CAM2.0_2.dev53
One-line Summary: Improve and extend prototype of new run-time options module.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, anchorage-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton.  Design reviewed by Eaton and Rosinski
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:
Files removed:
models/atm/cam/src/control/comhd.h
models/atm/cam/src/control/parse_namelist.F90
models/atm/cam/src/control/preset.F90

Files added:  
models/atm/cam/src/control/comhd.F90
models/atm/cam/src/control/runtime_opts.F90

Files Modified:
models/atm/cam/src/dynamics/eul/courlim.F90
models/atm/cam/src/dynamics/eul/grcalc.F90
models/atm/cam/src/dynamics/eul/hdinti.F90
models/atm/cam/src/dynamics/eul/hordif.F90
models/atm/cam/src/dynamics/eul/spegrd.F90
models/atm/cam/src/dynamics/sld/courlim.F90
models/atm/cam/src/dynamics/sld/grcalc.F90
models/atm/cam/src/dynamics/sld/hdinti.F90
models/atm/cam/src/dynamics/sld/hordif.F90
models/atm/cam/src/dynamics/sld/spegrd.F90
models/atm/cam/src/physics/cam1/aerosol_intr.F90
models/atm/cam/src/physics/cam1/phys_grid.F90
models/atm/cam/src/control/cam.F90
models/atm/cam/src/control/history.F90



===============================================================
===============================================================

cam2_0_2_dev52
Originator: rosinski ( Jim Rosinski) and John Truesdale
Date: Fri Dec 12 15:56:44 MST 2003
Model: CAM
Version: CAM2.0_2.dev52
One-line Summary: Improve handling of surface fractions, especially in coupled mode (SOM and CCSM)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Rosinski, Truesdale
Restart files change: yes
Changes answers: no (bit-for-bit) except SOM which is roundoff. There is a #define in somoce.F90
                 that if defined will make SOM bfb. If the "puny" criterion of ice_srf.F90 is
                 ever met (aice <= puny = 1.e-12) then there is a possibility that prescribed-ice 
                 mode could be good only to roundoff, but we were unable to generate such a case.
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Install a more permanent fix to erroneous surface fraction calculations
than the quick fix of dev50.  The original bug which dev50 addressed was that
surface fractions were being changed in an incorrect way by calls to
update_srf_fractions in coupled mode (both SOM and CCSM).  At various points
during a timestep, variable ICEFRAC contained either ice fraction of the grid
box or ice fraction of the non-land portion of the grid box.  Routine
update_srf_fractions implicity assumed it was being called to convert a
non-land fraction into a grid box fraction.  In coupled mode,
update_srf_fractions was being called by ccsmrcv every timestep after
receiving surface fraction information from the coupler.  Since ICEFRAC held
ice fraction of the grid box at this point, an erroneous calculation thus
resulted.  The dev50 quick fix was to install ifdefs around the ICEFRAC
recomputation in update_srf_fractions.  In the more permanent fix, array AICE
always represents ice fraction of the non-land portion of the grid box, and
ICEFRAC always represents the ice fraction of the entire grid box.

The updating of surface fractions and verifying their validity is now
segregated into two subroutines, comsrf.F90 routines update_ocnice and
verify_fractions, respectively.  ccsm_msg.F90 routines ccsmrcv and
ccsm_msg_getalb now call verify_fractions, instead of a routine which will
actually change the surface fractions.  If update_ocnice is ever called in
coupled mode it will result in an endrun() call.  Instead, ccsmrcv and
ccsm_msg_getalb now contain explicit code to compute new fractions
(correctly) rather than make calls to update_ocnice.  This resetting should
be unnecessary, but was retained to obtain bit-for-bit reproducibility with
earlier libraries and to avoid concerns about restartability.  We believe the
calls to update_srf_fractions were originally installed to address bizarre
restartability issues in the coupled model.  Ultimately the recomputation of
fractional information (especially landfrac every timestep) should be removed
from these routines. These spots are currently delimited with "bit-for-bit"
comments.

For further details see details on the CAM checkin list.
===============================================================
===============================================================

cam2_0_2_dev51
Originator: mvr ( Mathew Rothstein)
Date: Mon Dec  8 11:29:27 MST 2003
Model: CAM
Version: CAM2.0_2.dev51
One-line Summary: add -Q to Makefile for IBM, added XLSMPOPTS back into run-ibm.csh
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:


>> Makefile:  
>>  Add "-Q" for ~1% speedup.  
>> 
>> run-ibm.csh:
>> Add XLSMPOPTS do avoid thread-stack limits that cause seg-fault when 
>> prognostic sulfates, carbon, sea salt, and dust are all turned on.  
>> 
>>   ## suggestion from Jim Edwards to reintroduce XLSMPOPTS on 11/13/03
>>   setenv XLSMPOPTS "stack=256000000"

===============================================================
===============================================================

cam2_0_2_dev50
Originator: jmccaa ( James Mccaa)
Date: Wed Dec  3 15:35:26 MST 2003
Model: CAM
Version: CAM2.0_2.dev50
One-line Summary: Small change to prevent CAM from incorrectly modifying sea ice fractions in SOM/CCSM mode.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

A small change was made to comsrf.F90 to prevent CAM from incorrectly 
modifying sea ice fractions in SOM/CCSM mode.  This corrects an error 
introduced in dev47, and therefore the tags dev47, dev48, and dev49 
should not be used for SOM or CCSM runs.

===============================================================
===============================================================

cam2_0_2_dev49
Originator: hender ( Tom Henderson)
Date: Tue Nov 18 12:26:08 MST 2003
Model: CAM
Version: CAM2.0_2.dev49
One-line Summary: New T85 surface data set with pre-computed fields, fixed SST data sets at T85 and T170, T85 tuning.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

- Modified DefaultCLMEXPNamelist.xml to point to new T85 surface data set from
  Jim McCaa.  This data set contains pre-computed surface fields and cuts more
  than 10 minutes off of T85 initialization.

- Modified DefaultCAMEXPNamelist.xml to point to new climatological sst files
  for T85 and T170 from Jim McCaa.
  Details from Jim McCaa:
  On Fri, 31 Oct 2003, Jim McCaa wrote:
> These two files are intended to replace broken climatological sst files for
> T85 and T170, respectively, in /fs/cgd/csm/inputdata/atm/cam2/sst.
>
>  /fs/cgd/data0/jmccaa/sst_HadOIBl_bc_128x256_clim_c031031.nc
>  /fs/cgd/data0/jmccaa/sst_HadOIBl_bc_256x512_clim_c031031.nc
>
>
> The defaults xml file should be updated to point to these new files,
> replacing> any entries pointing to either of
>  /fs/cgd/csm/inputdata/atm/cam2/sst/sst_HadOIBl_bc_128x256_clim_c020812.nc
>  /fs/cgd/csm/inputdata/atm/cam2/sst/sst_HadOIBl_bc_256x512_clim_c020812.nc
>
> This will primarily affect anyone trying to run Jim R.'s defineqflux
> program,
> i.e. anyone trying to set up a T85 or T170 SOM run.
>
> I produces these new files using the old ones and the command:
> ncks -d time,0,11 <oldsstfile.nc> <newsstfile.nc>

- T85 tuning in cloud_fraction.F90 from Jim McCaa:
49c49
<           rhminl = .92
---
>           rhminl = .91


===============================================================
===============================================================

cam2_0_2_dev48
Originator: rosinski ( Jim Rosinski)
Date: Tue Nov 11 09:12:51 MST 2003
Model: CAM
Version: CAM2_0_2_dev48
One-line Summary: Save memory in aerosol code by holding in-core only 2 time levels of data.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes. per MPI task memory saved @ T42 = 190 MB/ntask
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit), except only roundoff under PC/pgf90
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Revised aerosol reading to be like SST and ozone, keeping in-core only 2
  time levels of data to save memory.  Initialization should speed up lots,
  since 2 time levels of aerosol data are read in instead of 12.  

  It is now feasible from a memory use standpoint to run T85 using 2 MPI
  tasks on a machine with 2 GB of memory.

  BYPASS ifdef was removed since the speedup renders it unnecessary.

  Minor mods were made to sst and ozone interpolation routines for clarity
  and consistency.

  There are still some differences between the new code and ozone/SST
  handling.  There is no "aercyc = .false." namelist option.  Date info is
  gotten from an internal Fortran "data" statement rather than read from a
  boundary dataset.  Existing routine "aerosol_initialize" takes the role of
  what otherwise would be called "aerini" (instead of being named like
  "sstini" and "oznini"), and is called from "inti" instead of "initext".
  There is a new routine "aerint" in aerosols.F90 a la "sstint" and "oznint"
  which is called from "advnce".  Like these routines it reads in a new time
  slice of data when needed.  But the actual time interpolation is done in
  "get_aerosol".  The reasons for these differences have mainly to do with
  maintaining minimal intrusiveness, and the fact that there are plans
  to modify the way time and vertical interpolation of aerosols is done.


===============================================================
===============================================================

cam2_0_2_dev47
Originator: jet ( John Truesdale)
Date: Wed Nov  5 15:41:05 MST 2003
Model: CAM
Version: CAM2.0_2.dev47
One-line Summary: cam usage of  boundary dataset ice fraction made consistant with HADISST data.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no

Substantial timing or memory changes: no
Requires change in run script: no

Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: yes. Ice extent is now reduced around land. 

Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

After computing the ice area of the original datasets and comparing it to
the ice area produced by our t42 model, it became apparent that CAM was
over estimating the ice area. The ice fraction on the boundary dataset was
intrepreted as being the fraction of ice covering an entire gridbox.  A more
accurate way of determining the ice coverage is to regard the boundary
dataset ice fraction as the fraction of ice covering the *non-land* portion
of the grid box.  So

gridbox ice fraction = boundary dataset ice fraction * (1-land fraction)

The ice area produced by cam with this change is now very close to the
original datasets and to the ice area produced by CSM.  The overall effect
is a reduction of ice coverage in those grid boxes with some land fraction.

This change is a one line mod to comsrf.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev46
Originator: pworley ( Patrick H Worley)
Date: Tue Nov  4 15:26:37 MST 2003
Model: CAM
Version: CAM2.0_2.dev46
One-line Summary: Decreased memory requirements in dynamics/eul/inidat and added new load balancing scheme to phys_grid (same as dev39).
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes - decreased number of full 3D fields needed in inidat from 9+(pcnst+pnats) to 4
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux cluster
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes (same as dev39)
Changes made:

	The cam2_0_2_dev39 commit failed (on Sep. 29, 2003). This commit reintroduces those changes.
	The following is identical to the dev39 documentation ...

        1) restructured dynamics/eul/inidat.F90 to minimize the memory requirements.
           In the original version, masterproc allocates (9+pcnst+pnats) 3D fields 
           and 16 2D fields. It then reads in or generates the initial data,
           scatters the data, and finally deallocates the arrays. In the revised
           version, subsets of arrays are allocated, initialized, scattered, and
           deallocated together, decreasing the maximum memory requirements to 4 3D fields.
           Note that I implemented the logic that Brian Eaton used in FV inidat (for WACCM)
           to treat each species in q3 separately.

        2) added a new load balancing algorithm in physics/cam1/phys_grid.F90.
           The original global balancing algorithm (opt = 1) eliminates
           imbalances due to the diurnal and seasonal cycles. However, it still
           assigns all polar latitdues to the same processors, the mid-latitudes
           to the same processors, and the equatorial latitudes to the same processors.
           The new algorithm (opt = 2) mixes up the latitudes as well, achieving
           almost perfect load balance. It comes at a cost of increased communication cost
           compared to opt = 1, and may or may not be a performance enhancer for 
           a given system, problem size, and processor count.
						        
        3) added an option to physics/cam1/phys_grid.F90 to implement the transpose_block_to_chunk
           and transpose_chunk_to_block routines using point-to-point MPI commands rather 
           than mpi_alltoallv. This has been important on some systems in the past,
           and is included here as an aid to experimentation. This option is currently
           disabled in the code.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev45
Originator: hender ( Tom Henderson)
Date: Fri Oct 31 11:24:43 MST 2003
Model: CAM
Version: CAM2.0_2.dev45
One-line Summary: Performance optimization for IBM.
cam-bugs Requests resolved: none
Requires change in build system: yes
Fortran compiler optimization for IBM "xlf90" has changed from 
"-O2 -qmaxmem=-1 -Q" to "-O3 -qstrict".  The "-lmass" library is now 
linked in unless DEBUG is on.  
Substantial timing or memory changes: yes, it runs ~5% faster.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Jim McCaa
Restart files change: no
Changes answers: Yes, same-physics
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Changed optimization in Makefile for IBM.
Changed "sanity checks" in pcond() (cldwat.F90) to make IBM compiler 
happy (bfb).  
Changed "rliq1 sanity check" in pcond() (cldwat.F90) to use Jim McCaa's 
fix (bfb).  

===============================================================
===============================================================

cam2_0_2_dev44
Originator: jmccaa ( James McCaa)
Date: Fri Oct 31 09:48:06 MST 2003
Model: CAM
Version: CAM2.0_2.dev44
One-line Summary: T85 tuning, removal of many default history file fields, modification of dif4 initialization.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit at all resolutions except T85)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
This tag supplies three changes to the model:

1) The tuning of the T85 Eulerian model has been modified through the
   addition of the relative humidity cloud threshold ramp in
   cloud_fraction.F90.  Tuning parameters were also modified in
   zm_conv.F90, moistconvection.F90, and cldwat.F90.   

2) The number of fields on the default monthly history files has been
   reduced substantially.  All fields continue to be available via the
   fincl namelist facility.  Also, default daily history files have
   been eliminated.  

3) The initialization of the diffusion parameters dif4 and dif2 have
   been moved out of build-namelist and into the model.  The default
   dif4 value for T85 has been modified.

The files that were modified are:
>> M models/atm/cam/bld/DefaultCAMEXPNamelist.xml
>> M models/atm/cam/src/control/history.F90
>> M models/atm/cam/src/control/preset.F90
>> M models/atm/cam/src/dynamics/eul/dycore.F90
>> M models/atm/cam/src/dynamics/sld/dycore.F90
>> M models/atm/cam/src/physics/cam1/cldcond.F90
>> M models/atm/cam/src/physics/cam1/cldwat.F90
>> M models/atm/cam/src/physics/cam1/cloud_fraction.F90
>> M models/atm/cam/src/physics/cam1/gw_drag.F90
>> M models/atm/cam/src/physics/cam1/moistconvection.F90
>> M models/atm/cam/src/physics/cam1/vertical_diffusion.F90
>> M models/atm/cam/src/physics/cam1/zm_conv.F90

===============================================================
===============================================================

cam2_0_2_dev43
Originator: rosinski ( Jim Rosinski)
Date: Wed Oct 29 14:02:46 MST 2003
Model: CAM
Version: CAM2.0_2.dev43
One-line Summary: cos(lat) now applied to LANDM field offline.  Since all IC files now require this
                  field (LANDM_COSLAT), new IC fields were generated.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes. Same-to-roundoff T42.  Changes answers other resolutions (due to LANDM).
Changes to CLM land-model: None (except sfc datasets must be generated).
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Migrated multiplication of LANDM field by cos(lat) offline.  One reason to do this was that
model-written IC files were invalid, due to erroneous multiple applications of the above-mentioned
cosine function.  Also, for horizontal resolutions other than T42 there was an  undesirable
resolution-dependent behavior of the LANDM specification algorithm.  In the new approach,
linear interpolation to the target resolution is done from a "master" LANDM dataset, which was
built at T42 (per pjr).  The resulting LANDM_COSLAT field now looks similar regardless of resolution.

The "master" LANDM_COSLAT dataset lives in /fs/cgd/csm/inputdata/atm/cam2/hrtopo/landm_coslat.nc
It is read in by offline tool "definesurf", which has been modified to read it.

Since new IC files are now required for all resolutions, it was decided to introduce consistency 
to these files by using the newest 10-minute hi-res topography dataset when creating them.  The
newest topography file is /fs/cgd/csm/inputdata/atm/cam2/hrtopo/topo10min.merged_c030506.nc
As a consequence of using this new file, existing resolution-specific surface datasets and IC 
files for CLM also are invalid.  Thus for many resolutions (though not T42), CLM must be spun
up for any runs done with cam2.0.2.dev43 and beyond.  These changes are reflected in the xml
files which are used to build CAM and CLM namelists.

===============================================================
===============================================================

cam2_0_2_dev42
Originator: rosinski ( Jim Rosinski)
Date: Tue Oct 28 16:02:07 MST 2003
Model: CAM
Version: CAM2.0_2.dev42
One-line Summary: Eliminate global TS print from physpkg and other minor speedups.
                  Add T85 and 2x2.5 aerosol datasets to xml file.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Minor speedup (see below).
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

o Eliminated global TS calculation and printout from physpkg.  This code was left over 
from long ago and the output is now more easily obtainable by other means.  Minor speedup.

o Moved calculation of tsice_rad to threaded region.  Minor speedup on IBM, potentially
more significant when OMP_NUM_THREADS is a larger number (e.g. SGI). Unfortunately this 
calculation is needed to create v2 IC files so it cannot be eliminated entirely.  But it is 
only needed when an IC file is generated, not every timestep.  So further speedup is 
possible.

o Made srfflx_state_reset callable by chunk to enable fusing threaded loops.

o Added reference to T85 and 2x2.5 aerosol datasets to CAM namelist xml file.

===============================================================
===============================================================

cam2_0_2_dev41
Originator: jmccaa ( James Mccaa)
Date: Thu Oct 23 15:54:52 MDT 2003
Model: CAM
Version: CAM2.0_2.dev41
One-line Summary: Climate tuning mods for T42 and T85.

cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes, new-climate
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Modifications have been made to allow the code to run using different
physics tuning parameters for different dycores and resolutions.
The values of these parameters have been adjusted following numerous 
sensitivity experiments.

The file cldfrc.F90 has been converted to a module named cloud_fraction.F90, and
an initialization routine has been added.
The files closure.F90, guang.h, and q1q2.F90 have merged into zm_conv.F90.
Minor code modifications have been made to allow greater optimization levels on 
the IBM.

Changed files:
>> M models/atm/cam/src/advection/slt/hordif1.F90
>> M models/atm/cam/src/control/cam.F90
>> M models/atm/cam/src/control/history.F90
>> M models/atm/cam/src/control/preset.F90
>> M models/atm/cam/src/control/spmdinit.F90
>> M models/atm/cam/src/dynamics/eul/dycore.F90
>> M models/atm/cam/src/dynamics/fv/dycore.F90
>> M models/atm/cam/src/dynamics/sld/dycore.F90
>> M models/atm/cam/src/physics/cam1/cldnrh.F90
>> M models/atm/cam/src/physics/cam1/cldwat.F90
>> M models/atm/cam/src/physics/cam1/geopotential.F90
>> M models/atm/cam/src/physics/cam1/inti.F90
>> M models/atm/cam/src/physics/cam1/moistconvection.F90
>> M models/atm/cam/src/physics/cam1/pkg_cld_sediment.F90
>> M models/atm/cam/src/physics/cam1/radae.F90
>> M models/atm/cam/src/physics/cam1/sulchem.F90
>> M models/atm/cam/src/physics/cam1/tphysbc.F90
>> M models/atm/cam/src/physics/cam1/zm_conv.F90
>> M models/csm_share/shr_vmath_mod.F90

Removed files:
>> R models/atm/cam/src/physics/cam1/cldfrc.F90
>> R models/atm/cam/src/physics/cam1/closure.F90
>> R models/atm/cam/src/physics/cam1/guang.h
>> R models/atm/cam/src/physics/cam1/q1q2.F90

Added files:
>> A models/atm/cam/src/physics/cam1/cloud_fraction.F90

===============================================================
===============================================================

cam2_0_2_dev40
Originator: rosinski ( Jim Rosinski)
Date: Wed Oct 22 16:54:16 MDT 2003
Model: CAM
Version: CAM2.0_2.dev40
One-line Summary: Move horizontal aerosol interpolation offline.  Modify print_memusage for readability and portability.
cam-bugs Requests resolved: none
Requires change in build system: yes: resolution-specific aerosol dataset required
Substantial timing or memory changes: yes: faster, uses less memory
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Andrew Conley
Restart files change: no
Changes answers: Yes (same-to-roundoff)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes

Changes made:

o Moved horizontal aerosol interpolation to CAM grid offline.  The main reason for
this was to speed up initialization and reduce memory usage when running CAM.  At T42 
using 2 MPI tasks, the memory hi-water mark for MPI task 0 is reduced by about 50%.  
Memory reduction for MPI task 1 is around 20%.

Since the boundary aerosol dataset is now resolution-specific, the amount of speedup vs. 
dev39 will be resolution-dependent, with lower resolutions seeing the biggest benefit.  
There will also be some speedup during the time-integration phase due to reordering loops
and array structure for cache efficiency in aerosol routine vert_interpolate.  Since 
the aerosol initialization code still reads a full 12 months of data, the startup time 
overhead and memory overheads are not insignificant.  We may want to further restructure
the code to read in aerosols the same way as SST and Ozone, keeping just 2 bounding
months of data in-core at any given time.  In the meantime, if time spent reading
the aerosol boundary data still proves to be an annoyance, things can be sped up dramatically
if the aerosol dataset is made local rather than read from an NFS-mounted file system.
Alternatively, #define BYPASS is still available from earlier libs.

The new boundary dataset generation code lives in cam/tools/interpaerosols.  A
README in that directory explains the procedure to generate an aerosol boundary
dataset at the target model resolution.  Resolution-specific aerosol datasets have
already been created for resolutions needed by test-model, and some other common
resolutions.

Mods were also made to the main CAM Makefile.  LAPACK/BLAS routines are only used by the
aerosol initialization procedure, so library references to these routines now only
exist in the offline code.


o Rewrote utility routine print_memusage for readability of output and portability.  It now
works on Linux as well as SGI and IBM.  The point of the routine is to print
memory use information at whatever point in the code the user wishes.  On most machines
the numbers printed refer to hi-water mark, but on Linux they refer to current use (i.e.
on Linux the numbers do not necessarily increase monotonically with time).  Also on
most machines, the printed numbers refer to KB of memory used.  But this is not necessarily
true on all machines (e.g. Linux).  Refer to "man getrusage" on most machines, and "man proc"
on Linux machines for details.  The output from print_memusage now goes to Fortran unit 0,
which in most cases translates to stderr.  So memory use information can be segregated from
stdout by for example: (cam < namelist >! out) >&! err.  This code is far from perfect, e.g.
printed output can still be jumbled between MPI tasks.


Misc. notes:

o To get bit for bit vs. dev39, created a 64-bit aerosol dataset, pasted lon and lat
coordinate variables from a dev39 run into the input/output file required by interpaerosols.
Under pgf90 this is bfb.  Unfortunately this procedure did not yield bfb results on IBM or SGI.

o Input aerosol dataset variable names and output history variable names are as before, but
with an "_V" appended to their name.  This reflects the fact that these variables have 
undergone a vertical sum. The different names will also cause the model to crash if an 
incorrect boundary dataset is used.

===============================================================
===============================================================

cam2_0_2_dev39
Originator: pworley ( Patrick H Worley)
Date: Mon Sep 29 13:44:01 MDT 2003
Model: CAM
Version: CAM2.0_2.dev39
One-line Summary: Decreased memory requirements in dynamics/eul/inidat and added new load balancing scheme to phys_grid.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes - decreased number of full 3D fields needed in inidat from 9+(pcnst+pnats) to 4
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

	1) restructured dynamics/eul/inidat.F90 to minimize the memory requirements.
	   In the original version, masterproc allocates (9+pcnst+pnats) 3D fields 
	   and 16 2D fields. It then reads in or generates the initial data,
	   scatters the data, and finally deallocates the arrays. In the revised
	   version, subsets of arrays are allocated, initialized, scattered, and
	   deallocated together, decreasing the maximum memory requirements to 4 3D fields.
	   Note that I implemented the logic that Brian Easton used in FV inidat (for WACCM)
	   to treat each species in q3 separately.

	2) added a new load balancing algorithm in physics/cam1/phys_grid.F90.
	   The original global balancing algorithm (opt = 1) eliminates
	   imbalances due to the diurnal and seasonal cycles. However, it still
	   assigns all polar latitdues to the same processors, the mid-latitudes
	   to the same processors, and the equatorial latitudes to the same processors.
	   The new algorithm (opt = 2) mixes up the latitudes as well, achieving
	   almost perfect load balance. It comes at a cost of increased communication cost
	   compared to opt = 1, and may or may not be a performance enhancer for 
	   a given system, problem size, and processor count.
	   
        3) added an option to physics/cam1/phys_grid.F90 to implement the transpose_block_to_chunk
	   and transpose_chunk_to_block routines using point-to-point MPI commands rather 
	   than mpi_alltoallv. This has been important on some systems in the past,
	   and is included here as an aid to experimentation. This option is currently
	   disabled in the code.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev38
Originator: hender ( Tom Henderson)
Date: Mon Sep 22 11:46:03 MDT 2003
Model: CAM
Version: CAM2.0_2.dev38
One-line Summary: Bug fix for prognostic aerosols, SE improvements.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Phil Rasch, Brian Eaton, Erik Kluzek
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Fixed bugs and added namelist variables to control prognostic aerosols.  
(Bug fix for prognostic aerosols was provided by Phil Rasch.)  
Improved design of parse_namelist(), prototype implementation is included 
subject to review.  So far design and implementation have been reviewed 
only by Brian Eaton and Erik Kluzek.  
Brought physics performance tuning parameters out to CAMEXP namelist.  

New namelist variables are:  

PHYSICS CONTROLS

AERO_SULFUR
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on sulfur prognostic aerosols.

AERO_FEEDBACK_SULFUR
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of sulfur prognostic aerosols. May
only be true if AERO_SULFUR is also true.

AERO_CARBON
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on carbon prognostic aerosols.

AERO_FEEDBACK_CARBON
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of carbon prognostic aerosols. May
only be true if AERO_CARBON is also true.

AERO_SEA_SALT
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on sea salt prognostic aerosols.

AERO_FEEDBACK_SEA_SALT
Type:   Logical
Default:  .FALSE. 
Description:   If true, turn on feedback of sea salt prognostic aerosols. May
only be true if AERO_SEA_SALT is also true.


PERFORMANCE TUNING

PHYS_LOADBALANCE
Type:  Integer
Default:   0
Description:   Select different options for organization of physics chunks.
Each uses a different scheme for static load balancing. 

PHYS_CHNK_PER_THD
Type:   Integer
Default:  1
Description:  Select target number of chunks per thread. Must be positive


CHANGED FILES:
  cam1/models/atm/cam/doc/UsersGuide/UG-20.html
  cam1/models/atm/cam/src/dynamics/eul/inidat.F90
  cam1/models/atm/cam/src/dynamics/sld/inidat.F90
  cam1/models/atm/cam/src/dynamics/fv/inidat.F90
  cam1/models/atm/cam/src/physics/cam1/aerosol_intr.F90
  cam1/models/atm/cam/src/physics/cam1/carbon_intr.F90
  cam1/models/atm/cam/src/physics/cam1/dust_intr.F90
  cam1/models/atm/cam/src/physics/cam1/phys_grid.F90
  cam1/models/atm/cam/src/physics/cam1/radctl.F90
  cam1/models/atm/cam/src/physics/cam1/seasalt_intr.F90
  cam1/models/atm/cam/src/physics/cam1/sulchem.F90
  cam1/models/atm/cam/src/physics/cam1/sulfur_intr.F90
  cam1/models/atm/cam/src/physics/cam1/wetdep.F90
  cam1/models/atm/cam/src/control/cam.F90
  cam1/models/atm/cam/src/control/comhd.h
  cam1/models/atm/cam/src/control/parse_namelist.F90



===============================================================
===============================================================

cam2_0_2_dev37
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Sep 17 16:30:30 MDT 2003
Model: CAM
Version: CAM2.0_2.dev37
One-line Summary: Transpose and other FV improvements
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no (unless test_model did that)
Code reviewed by: myself, Will Sawyer
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

This update accomplishes improvements to the finite-volume transposes and to
the FV dycore itself, as undertaken by Art Mirin and Will Sawyer. Specifically:

(A) The irregular communication routines of the mod_comm library
have been placed in their own module (mod_irreg), to enable use of a unified
version of mod_comm in CAM2 and FVGCM (NASA Goddard). This facilitates making use
of ongoing improvements at Goddard (such as support for SHMEM).

(B) The transpose calls directly reference mod_irreg routines as opposed to
going through the Pilgrim layer. This is true for use of mpi derived types as
well as contiguous buffers. Pilgrim's main function is to set up communication
patterns; mod_irreg then accomplishes the transposes.

By default, the transposes gather/scatter data from/to contiguous buffers. We
have found mpi derived types to be very slightly superior on the IBM.
One can implement use of mpi derived types at compile time by activating the line
"FPPFLAGS   += -WF,-DUSE_MPI_TYPES" in the AIX section of the Makefile.
Support for one-sided (MPI2) communications when using MPI derived types has not
yet been implemented.

(C) There have been other miscellaneous improvements to Pilgrim / mod_comm.

(D) The Held-Suarez, Rayleigh friction and high-pressure mode have been removed
from the FV dycore.

(E) The FV version of inidat.F90 has been rewritten to minimize use of global 3D
arrays.

(F) Additional sectional timing diagnostics have been added, as well as an additional
optional timing barrier in the physics.

(G) There have been other miscellaneous improvements.

The following routine was added:
   cam1/models/utils/pilgrim/mod_irreg.F90

The following routines were deleted:
   cam1/models/atm/cam/src/dynamics/fv: hswf.F90, highp2.F90, dry_adj.F90, rayl_fric.F90

The following routines were modified:
   cam1/models/utils/pilgrim: Makefile, mod_comm.F90, parutilitiesmodule.F90
   cam1/models/atm/cam/bld/Makefile
   cam1/models/atm/cam/src/physics/cam1/physpkg.F90
   cam1/models/atm/cam/src/dynamics/fv: cd_core.F90, d2a3dikj.F90, dp_coupling.F90,
        dynamics_vars.F90, dynpkg.F90, geopk.F90, inidat.F90, inital.F90, mapz_module.F90,
        p_d_adjust.F90, pft_module.F90, pmgrid.F90, restart_dynamics.F90, spmd_dyn.F90,
        stepon.F90, te_map.F90, uv3s_update.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev36
Originator: jmccaa ( James McCaa)
Date: Fri Sep 12 14:32:06 MDT 2003
Model: CAM
Version: CAM2.0_2.dev36
One-line Summary: Merge of physics tuning branch onto cam_dev branch.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers:Yes -- new climate
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The following changes apply to all dycores:
* The fall velocity of large (400 micron) ice crystals has been reduced
   from 3.5 m/s to 1 m/s.
* There is a lapse-rate reduction of the SST used for stratus diagnosis
   when the sea surface elevation is not 0.
* The temperature ramp used to compute the effective radius of warm
   clouds over land now goes from -20 C to 0 C.
* The land fraction ramp over the ocean goes from cos(lat) near the
   coast to 0 at 1000 km from the coast.
* The effective radius and CCN of warm clouds over land now depend
   on snow depth (linear ramp from 0 to 0.1 m liquid water equivalent).
* The evaporative efficiency for rain falling from cumulus has been
   lowered from 3.0e-6 to 2.0e-6.
* Formulae for cloud fraction associated with moist convection have
   been changed.
* Adjustments have been made to the aerosol optics.

The following modifications only apply to the finite volume dycore:
(They are in addition to the changes described above.)
* A new energy fixer has been added.
* The parameterization of gravity wave drag has been modified.
* A new parameterization of orographic form drag has been added.
* The Hack scheme now detrains cloud liquid.
* Evaporation efficiency for stratiform rain has been halved.
* Evaporation efficiency for convective rain has been halved.
* Formulae for cloud fraction associated with moist convection have
   been changed.

The following modififications have been made to keep the standalone
CAM consistent with recent coupled runs:
* The snow fraction on land as a function of snow depth has been
   changed.
* Both visible and near-ir albedos of snow on sea ice have been
   lowered by 0.02.
* Albedos of bare sea ice have been lowered by 0.10 for visible and
   0.06 for near-ir.

There is one infrastructure change:
* ncar_batch.csh now overrides any previously set values of the environment
   variables INC_NETCDF and LIB_NETCDF to point to 64 bit versions

===============================================================
===============================================================
cam2_0_2_dev35
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Sep 10 10:37:47 MDT 2003
Model: CAM
Version: CAM2.0_2.dev35
One-line Summary: fix clm bug that caused problems at very high mpi task number
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Forrest Hoffman
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
 Fixed bug in clm code (lnd_grid.F90) that caused problems to occur at very
 high mpi task number	  
===============================================================
===============================================================

cam2_0_2_dev34
Originator: hender ( Tom Henderson)
Date: Tue Sep  2 12:41:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev34
One-line Summary: AIX 64-bit addressing and a bunch of other stuff
cam-bugs Requests resolved: 98, (127), 128
Requires change in build system: AIX build now uses 64-bit addressing
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, contributors
Restart files change: no
Changes answers:  Yes (same-to-roundoff for AIX, bfb for all others)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
  Bunch-o-fixes II:
 - Jim Edwards' performance fix for estblf
   - wv_saturation.F90
 - change Makefile (etc.) to use 64-bit on AIX
   - Modified Makefile, run-ibm.csh, CAM_lab.pm
 - From Jim McCaa
   The code already exists in history.F90, but is CPPed out.  So, what I'm
   requesting is to remove the two CPP lines, thereby enabling the code.
   They are:
 line 2501: #if  ( defined CNTL_FORSOM )
 line 2506: #endif
   This won't affect answers, but will add fields to the monthly history
   tape.
 - From John Truesdale:
   In diagnostics.F90 the outfld call for TSICERAD needs to be removed (per
   Jerry O.)  In tphysbc.F90 the DQCOND outfld call needs to be removed
   (duplicate of outfld call using dcconnam).
 - Jim Rosinski kindly offered to add a summary message to cprnc indicating
   how many fields were compared and how many passed bfb.
   - only one file changed:
     /fs/cgd/data0/rosinski/newcprnc/cam1/models/atm/cam/tools/cprnc/cpr.F
 - Fixed bug in fv 2D decomposition (From Art Mirin)
   - Changed dp_coupling.F90 for fv
 - Fixed CAM bug #98 (originally reported by Woo Sun Yang)
   - Francis Vitt (ACD) provided the bug fix for writing staggered 'US' grid
     from history.F90.
 - Attempted to remove undocumented Lahey compiler option from Makefile as
   suggested by Jim Rosinski
 "For some reason the default CAM Makefile includes an undocumented compiler
  flag (-CcdRR8) when using lf95 on the PC.  The documented flag --dbl used
  to suffice for auto-promotion of real to real*8, and has been removed.
  Does anyone know why this was changed?  If not, I propose changing back to
  the documented flag if identical answers can be obtained.  Undocumented
  flags are a bad idea all around, I think.
  JR"
   - Can't make this change because "--dbl" promotes real*4's too (which
     will break MPI communications and history output).
   - Corrected misleading comments about this in Makefile.
 - Implemented Brian Eaton's fix for incorrect override of qmin from namelist
   - Modified all three flavors of initcom.F90
 - Removed ccm366 physics from Default*Namelist.xml.
 - Added new data file for Jerry Olson to DefaultCAMEXPNamelist.xml.
    eul/ncdata_vers=2:  cami_0000-09-01_64x128_L26_c030624.nc
    sld/ncdata_vers=2:  cami_0000-09-01_64x128_L26_c030624.nc
    eul/ncdata_vers=1:  cami_0000-09-01_64x128_L26_030506.nc
    sld/ncdata_vers=1:  cami_0000-09-01_64x128_L26_030506.nc
 - Fix CAM bug #128 (fv build problems on Compaq and SGI) with bug fixes
   from Tony Craig and Wei Yu.
   - Modified cd_core.F90, and ccsm_msg.F90 (physpkg.F90 already fixed)

  dev34 is bfb vs. dev33 on non-AIX machines, but
  roundoff on AIX machines.  AIX perturbation growth of cam2_0_2_dev33 is
  nearly identical to error growth of difference between cam2_0_2_dev33 and
  cam2_0_2_dev34 for all three dycores.  roundoff is entirely due to change
  in AIX compiler options to use 64-bit addressing in Makefile and in cprnc
  Makefile.  This was tested by comparing dev33+(new Makefiles) vs. dev33
  (roundoff differences observed) and comparing dev34-(new Makefiles) vs.
  dev33 (bfb exact).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================
cam2_0_2_dev33
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Aug 25 12:06:15 MDT 2003
Model: CAM
Version: CAM2.0_2.dev33
One-line Summary: updated clm code from clm2_deva_30 to clm2_deva_36
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-physics (clm only)
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Only clm changes have been made in this tag.
	
cam2_0_2_dev32 contains clm2_deva_30 (with some changes on the cam branch for dust
that are only invoked when the cpp variable DUST is defined).

cam_0_2_dev33 contains clm2_deva_36 (which has incorporated the above dust mods). 

The following summarizes the changes between clm2_deva_30 and clm2_deva_36. 
The changes that lead to greater than roundoff differences are denoted by (*).

 1)  Put in dust mods in cam2_0_2_dev32.
*2*) Put in bug fix to BareGroundFluxesMod.F90 so that z0hg and z0qg at the column
     level would not be set by pft level quantities. This changes answers to more
     than roundoff.
 3)  Put in bug fix in Biogeophysics2Mod.F90 so that would not divide by
     zero when calculating the ratio of soil evaporation for a pft relative 
     to the total of all evaporating PFTs. This would occur if the weight
     became 0. in the dgvm calculation. This results in bfb answers in non-dgvm mode.
 4)  Put in bug fix to BareGroundFluxesMod.F90 so that z0hg and z0qg at the column
     level would not be set by pft level quantities. This changes answers to more
     than roundoff.
 5)  Put in bug fix in Biogeophysics2Mod.F90 so that would not divide by
     zero when calculating the ratio of soil evaporation for a pft relative 
     to the total of all evaporating PFTs. This would occur if the weight
     became 0. in the dgvm calculation. This results in bfb answers in non-dgvm mode.
 6)  Put in a change to DGVMMod.F90 to fix a bug in history file output
     in compete mode (the default now).
*7*) Reversion to old fraction snow cover algorithm (clm2_deva_32)
 8)  Made clmtype variables relating to soil hydraulic and thermal properties 
     column physical state properties rather than land physical state properties 
 9)  Fixed DGVM restart problem in compete mode:
     Modified restFileMod.F90 and DGVMMod.F90 so that average over all
     column pfts for h2ocan (needed by begwb computation in routine
     driver.F90) is done in restfileMod.F90 only for non-DGVM mode and in
     resetWeightstDGVM (in module DGVMMod.F90) for DGVM mode (since this
     needs to be done after the weights are reset in the DGVM case).
 10) Modified tssbef dimension in clmtype.F90 to be consistent. 
===============================================================
	
===============================================================

cam2_0_2_dev32
Originator: pworley ( Patrick H Worley)
Date: Tue Aug 19 20:38:06 MDT 2003
Model: CAM
Version: CAM2.0_2.dev32
One-line Summary: Chunking data structures and optimizing interprocessor communication in ozone routines
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes (performance improves for large process counts)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The original version of oznini reads in two timelevels of ozone data
and saves them in masterproc. masterproc then interpolates the data to the
current timelevel and broadcasts the entire field to each process.
Each shortwave or longwave timestep, advnce calls oznint. 
In oznint, masterproc again interpolates the ozone data
to the current timelevel and broadcasts the entire field to each process.
(Every month or so, oznint also reads a new timelevel of 
ozone data into masterproc.)

In the new version, oznini reads in the two timelevels, then distributes
both timelevels to all of the processes, so that they can do the interpolation
on their own. Moreover, the ozone data has been chunked, and each process
holds only the data that it needs for the columns that it is responsible for.
The performance impact is a significant decrease in the number of times
masterproc sends ozone data to the other processes, and a decrease in the
amount of data sent in each remaining communication. Routines modified were
comozp.F90, oznini.F90, oznint.F90, and radozn.F90, all in control/ . 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev31
Originator: rosinski ( Jim Rosinski)
Date: Thu Aug 14 21:54:00 MDT 2003
Model: CAM
Version: CAM2.0_2.dev31
One-line Summary: Bugfix from Natalie M. for sulfur fields.  Consistent treatment of r4 vs. r8 in function calls
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

o Sulfur bugfix from Natalie M. addresses negative concentrations.
o Consistent treatment of constants as r8.

===============================================================
===============================================================

cam2_0_2_dev30
Originator: pworley ( Patrick H Worley)
Date: Wed Aug 13 15:23:59 MDT 2003
Model: CAM
Version: CAM2.0_2.dev30
One-line Summary: Replaced global spectral arrays and indices with local arrays in EUL dycore, to decrease memory requirements.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes:Yes (spectral memory requirements now decrease as number of MPI processes increase)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux cluster
Ran test-model.pl script: yes 
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: No (bit-for-bit) for SGI and Linux cluster, Yes (same-to-roundoff) for IBM
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

The primary goal of this update is to decrease the memory requirements
in the spectral Eulerian dycore by allocating space only for the
spectral coefficients that each processor is responsible for. While
we earlier decomposed the work, we have still been allocating the
full spectral arrays on each processor. This modification is important
for higher horizontal resolutions (T85, T170) as it decreases the memory
required for each process and may improve performance by improving memory
locality. To this end, the following files in dynamics/eul were modified:

comspe, spmd_dyn, trunc, initcom, inital, dynpkg, grcalc, hordif,
quad, and tstep

The routine spetru was also divided into 4 routines (in a new spetru module):
spetru_u., spetru_t, spetru_ps, and spetru_phis, spectrally truncating
the fields u and v, t, ps, and phis, respectively. The old spetru used
the global spectral arrays vz, d, t, and phis, which have been eliminated.
The new routines use at most a few single level global spectral arrays to
truncate the fields, again decreasing the required memory.

Finally a few random changes were included in this update:

Makefile - 
   Added -lcxml to the LDFLAGS for OSF, to link in DGETRF and DGETRS
   on the Pittsburgh AlphaServer SC (needed by aerosols.F90)

caerbnd.F90, dmsbnd.F90: 
   Moved declaration for ncol so that it appears before its use in 
   array declarations. (HP/Compaq compiler complained.)

physpkg.F90:
   Removed redundant USE of time_manager variables. (HP/Compaq compiler 
   complained.)

carbon_intr.F90, seasalt_intr.F90
   Removed redundant USE of shr_const_mod variables. (HP/Compaq compiler
   complained.)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev29
Originator: aconley ( Andrew J. Conley)
Date: Thu Aug  7 10:25:49 MDT 2003
Model: CAM
Version: CAM2.0_2.dev29
One-line Summary: linearly interp asym and ssa parameters, Do not extrap optics beyond rh = 1.0
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, chinooke, anchorage
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers:Yes new-physics ( < 10^-3 relative change in aerosol heating)

Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
  Aerosol optics are no longer extrapolated beyond rh = 1.0.
  Asymmetry and single scattering albedo are now linearly interpolated
   in rh rather than exponentially interpolated.
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev28
Originator: rosinski ( Jim Rosinski)
Date: Wed Aug  6 11:49:49 MDT 2003
Model: CAM
Version: CAM2.0_2.dev28
One-line Summary: Back out nf90 interface from sulfur codes.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:

o Backed out the Fortran 90 interface from sulfur codes per CRB.
o IMPORTANT NOTE: There is a reproducibility problem on the IBM when the sulfur routines are
  enabled.  This problems exists both in the previous library (2.0.2.dev27) and this commit.
  Only the sulfur fields are affected, and the impact appears to be minor.  The problem is 
  likely related to threading, since 1-day test runs on IBM machines with OMP_NUM_THREADS=1
  give reproducible answers.  Threaded tests on chinook (SGI) were successful.  Note that
  test-model does not enable the sulfur routines, so results were bit-for-bit.

===============================================================
===============================================================

cam2_0_2_dev27
Originator: hender ( Tom Henderson)
Date: Wed Jul 30 15:10:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev27
One-line Summary: First cut at getting dust to work with physics chunking.
cam-bugs Requests resolved: none
Requires change in build system: no

Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, anchorage-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Hacks for dust, see "#if (defined DUST)"
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
Updated Natalie Mahowald's dust package (including her land model changes) to 
work with PCOLS=16.  It does not crash on anchorage but does crash on 
blakcforest when cpp token DUST is defined (by default, dust, sulfates, 
sea salt, and carbon packages are turned off via cpp tokens).  MORE WORK NEEDS 
TO BE DONE.  

This tag is identical to cam2_0_2_dev25_brnchT_paero7.  

Note that pgf90-pgcc and pgf90-gcc are known to fail because the Makefile has 
not been updated to deal with the new F90 netcdf interfaces used in the new 
code.  The next tag should replace the F90 interfaces with the standard CAM 
wrap_ncf() calls, if possible.  

===============================================================
===============================================================

cam2_0_2_dev26
Originator: hender ( Tom Henderson)
Date: Mon Jul 28 18:18:26 MDT 2003
Model: CAM
Version: CAM2.0_2.dev26
One-line Summary: Added Phil Rasch's prognostic SOx aerosols.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	(If not abort this tag and follow the procedures in)
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:
Added prognostic aerosols.  All four packages (sulfates, carbon, sea salt, and 
dust) are independently #ifdef'd out in aerosol_intr.F90.  Sulfates have 
been tested with the other three off.  Results are bfb with cam2_0_2_dev25 
when all four are off.  Feedback to radiation is disabled in radctl.F90 (see 
commented-out calls to set_aerosol_from_prognostics).  

Time constraints forced the choice of cpp and comments instead of namelist 
variables...  

NEW FILES:  
cam1/models/atm/cam/src/physics/cam1/acbnd.F90
cam1/models/atm/cam/src/physics/cam1/acsf.F
cam1/models/atm/cam/src/physics/cam1/aerosol_intr.F90
cam1/models/atm/cam/src/physics/cam1/caerbnd.F90
cam1/models/atm/cam/src/physics/cam1/caer.F90
cam1/models/atm/cam/src/physics/cam1/carbon_intr.F90
cam1/models/atm/cam/src/physics/cam1/dmsbnd.F90
cam1/models/atm/cam/src/physics/cam1/drydep_mod.F90
cam1/models/atm/cam/src/physics/cam1/dust.F90
cam1/models/atm/cam/src/physics/cam1/dust_intr.F90
cam1/models/atm/cam/src/physics/cam1/dust_sediment_mod.F90
cam1/models/atm/cam/src/physics/cam1/scyc.F90
cam1/models/atm/cam/src/physics/cam1/seasalt_intr.F90
cam1/models/atm/cam/src/physics/cam1/soxbnd.F90
cam1/models/atm/cam/src/physics/cam1/sulbnd.F90
cam1/models/atm/cam/src/physics/cam1/sulchem.F90
cam1/models/atm/cam/src/physics/cam1/sulemis.F90
cam1/models/atm/cam/src/physics/cam1/sulfur_intr.F90
cam1/models/atm/cam/src/physics/cam1/surface.F
cam1/models/atm/cam/src/physics/cam1/volcemission.F
cam1/models/atm/cam/src/physics/cam1/wetdep.F90

CHANGED FILES:
cam1/models/atm/cam/doc/UsersGuide/UG-20.html
cam1/models/atm/cam/bld/DefaultCAMEXPNamelist.xml
cam1/models/atm/cam/bld/camexp.pm
cam1/models/atm/cam/bld/run-ibm.csh
cam1/models/atm/cam/bld/run-pc.csh
cam1/models/atm/cam/src/dynamics/eul/inidat.F90
cam1/models/atm/cam/src/physics/cam1/advnce.F90
cam1/models/atm/cam/src/physics/cam1/aerosols.F90
cam1/models/atm/cam/src/physics/cam1/cldcond.F90
cam1/models/atm/cam/src/physics/cam1/comsrf.F90
cam1/models/atm/cam/src/physics/cam1/initindx.F90
cam1/models/atm/cam/src/physics/cam1/inti.F90
cam1/models/atm/cam/src/physics/cam1/physpkg.F90
cam1/models/atm/cam/src/physics/cam1/radctl.F90
cam1/models/atm/cam/src/physics/cam1/tphysac.F90
cam1/models/atm/cam/src/physics/cam1/tphysbc.F90
cam1/models/atm/cam/src/control/filenames.F90
cam1/models/atm/cam/src/control/intp_util.F90
cam1/models/atm/cam/src/control/parse_namelist.F90
cam1/models/atm/cam/test/system/ncar_batch.csh


===============================================================
===============================================================

cam2_0_2_dev25
Originator: jmccaa ( James Mccaa)
Date: Thu Jul 17 15:38:48 MDT 2003
Model: CAM
Version: CAM2.0_2.dev25
One-line Summary: Introduction of orographic form drag and modification of gravity wave drag routines.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, linux-lf95, linux-pgf90
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes, new-physics
Changes to CLM land-model: None (one-line description)
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Modified three files:
models/atm/cam/src/physics/cam1/gw_drag.F90
models/atm/cam/src/physics/cam1/tphysac.F90
models/atm/cam/src/physics/cam1/vertical_diffusion.F90

Introduced orographic form drag in vertical_diffusion module.
Modified gravity wave drag in gw_drag module.
These changes necessitated changes to the interfaces in tphysac.

Form drag and the new gravity wave drag algorithm are implemented only 
when using the finite volume dycore.  However, for the spectral dycores
the gravity wave algorithm was changed to disallow the formation of 
gravity waves over pure ocean points with non-zero orographic standard
deviation.

====================================================
====================================================

cam2_0_2_dev24
Originator: eaton ( Brian Eaton)
Date: Fri Jul 11 12:48:54 MDT 2003
Model: CAM
Version: CAM2.0_2.dev24
One-line Summary: dycore independent energy fixer, only active for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: roundoff changes in spectral dycores, fv has new physics
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Reinsert changes made at cam2_0_2_dev21 (dycore independent energy fixer active
for fv only).

Fix bad error growth (add PERGRO condition in cldfrc.F90)

Fix namelist problem for 64x128 sld (new dataset in DefaultCAMEXPNamelist.xml).


===============================================================
===============================================================

cam2_0_2_dev23
Originator: hender ( Tom Henderson)
Date: Sat Jun 21 09:41:17 MDT 2003
Model: CAM
Version: CAM2.0_2.dev23
One-line Summary: Fixes for coupled runs, removal of CCM366 and LSM, other minor fixes.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Intel-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Tony Craig, Art Mirin, and a cast of thousands
Restart files change: no
Changes answers: no (bfb with dev22)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:
   - Bug fix #122.  (outfld calls from Jerry Olson's commit)
       Modified routine diag_surf() in diagnostics.F90 so fields TSICE
       and TSICE_RAD are excluded from the history files during a coupled
       run.
   - bugfix for ccsm_msg from Tony for fractional land
       /fs/cgd/data0/tcraig/ccsm2_runs/f22.006/src.atm/ccsm_msg.F90
   - Strip out CCM366 code now that test-model tests are no longer run...
       Removed all files in models/atm/cam/src/physics/ccm366/ (CCM366
       physics) and models/lnd/lsm/src/ (LSM).
   - Deal with huge volume of print statements
       Commented out print of "TIMEFILTER" messages per CAM CRB meeting on
       6/20/03.  Modified tfilt_massfix.F90
   - Restore fv_prints.F90 as per Art Mirin's email
       Got new fv_prints.F90 from sunray3:/home/mirin/outgoing/.
   - Added Art Mirin's "one-line-change" to resolution_parameters.xml
       Added new line for resolution=".5x.625"


===============================================================
===============================================================

cam2_0_2_dev22
Originator: hender ( Tom Henderson)
Date: Fri Jun 20 15:50:11 MDT 2003
Model: CAM
Version: CAM2.0_2.dev22
One-line Summary: Rolled back dev21 changes (per CAM CRB).
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none.  I verified that the entire cam1 module is identical to 
dev20.  Testing will be done for dev23
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: 
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:  dev22 is identical to dev20
===============================================================
===============================================================

cam2_0_2_dev21
Originator: eaton ( Brian Eaton)
Date: Wed Jun 18 13:15:50 MDT 2003
Model: CAM
Version: CAM2.0_2.dev21
One-line Summary: dycore independent energy fixer, only active for FV
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC/lf95
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, boville
Restart files change: no
Changes answers: Yes. spectral dycores change to round-off.  FV dycore has a physics change.
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
Changes made:

Add dycore independent energy fixer.  Currently it is only applying an energy fix when run
with the FV dycore.  For the spectral dycores it is diagnostic.

A round-off level change was introduced into the spectral dycores due to 2 changes:
1. The definition of dry static energy was changed to include the surface geopotential.
2. The conversion between dry and wet constituent mixing ratios was moved into the coupling layer,
   and an extraneous conversion that previously happened at the end of tphysbc and at the beginning
   of tphysac has been removed.

See http://www.cgd.ucar.edu/~cam/cam_checkins/ for details.

===============================================================
===============================================================

cam2_0_2_dev20
Originator: erik ( Erik Kluzek)
Date: Mon Jun 16 12:54:27 MDT 2003
Model: CAM
Version: CAM2.0_2.dev20
One-line Summary: Get rid of ccm366/lsm test in test-model.pl, clean more files in $MODEL_BLDDIR, send *.cprout files in test-model to $MODEL_EXEDIR
cam-bugs Requests resolved: 112, 118(partial)
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux(lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?no

Got rid of the ccm366/lsm test in test-model.pl.

Clean more files in the $MODEL_BLDDIR when using test-model.pl or run-model.pl
(fixes bug #112)

Send all *.cprout files to $MODEL_EXEDIR instead of $SCRIPT_DIR this prevents
overwrites of files by different machines. This is a partial fix to bug #118.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
	http://www.cgd.ucar.edu/~cam/cam_checkins/
	for most recent and proposed checkins

===============================================================
===============================================================

cam2_0_2_dev19
Originator: hender ( Tom Henderson)
Date: Fri Jun 13 10:28:19 MDT 2003
Model: CAM
Version: CAM2.0_2.dev19
One-line Summary: Merged "science" branch into "dev" branch.
cam-bugs Requests resolved: none
Requires change in build system: Yes (see science branch documentation)
Substantial timing or memory changes: Yes (see science branch documentation)
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: many
Restart files change: yes
Changes answers: Yes (new-climate)
Changes to CLM land-model: Yes
Have you filled out the pre-check-in documentation as required by the CAM CRB?  yes
	http://www.cgd.ucar.edu/~cam/cam_checkins/checkin_process.shtml
Changes made:
See http://www.cgd.ucar.edu/~cam/cam_checkins/ for details of all changes 
made on the science branch.

===============================================================
===============================================================

cam2_0_2_dev18
Originator: rosinski ( Jim Rosinski)
Date: Tue Apr  8 17:09:30 MDT 2003
Model: CAM
Version: CAM2.0_2.dev18
One-line Summary: Speedup mods.  Particularly for large number of threads (e.g. typical SGI)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes. Speedup mods.  See below for details.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Have you filled out the pre-check-in documentation as required by the CAM CRB?  no but I will
Changes made:

o Speedup mods.  Should see order 10% speedup on SGI, 3% on IBM.  Even better than that for
  more than 32 threads on SGI.  Specifics were:
  - fuse threaded loops to minimize threading overhead
  - Don't dereference pointers in expensive history calculations.
  - Thread some calculations called from physpkg that were previously single-threaded.  This
    likely is the reason for such a big speedup on SGI.

o Changed ifdef DEBUG to HDEBUG inside history.F90.  Reason was model barfed somewhere in
  physics when DEBUG ifdef was set.

o Fix max/min combined with flag_xyfill=.true. pathological history case (prv commit).

===============================================================
===============================================================

cam2_0_2_dev17
Originator: rosinski ( Jim Rosinski)
Date: Sat Apr  5 11:48:41 MST 2003
Model: CAM
Version: CAM2.0_2.dev17
One-line Summary: Added ISCCP cloud simulator
cam-bugs Requests resolved: none
Requires change in build system: yes (new namelist variables)
Substantial timing or memory changes: history speedup.
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes 
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

o Added ISCCP cloud simulator.  Cost overhead is around 5%.  You need to set 
  namelist variable doisccp = .true. to enable the simulator.  Then
  isccpdata  = '/fs/cgd/csm/inputdata/atm/cam2/rad/isccp.tautab_invtau.nc'
  to tell the simulator where the required boundary dataset is.

  Had to set default doisccp = .false. because test-model will barf when cprnc
  gets confused at the different values of the "levels" coordinate variable.
  This needs to be fixed.

  Output from the simulator is 6 fields.  The key field is FISCCP1, dimensioned
  lon x 49 x lat x time.  The 49 is really 7 pressure levels by 7 optical 
  depths.  Pressure and optical depth of each "level" can be determined from
  dimension variable "isccp_prstau".  Pressure is the number to the left of
  the decimal point in mb.  Optical depth is the number to the right of the
  decimal point times 1000.

  The simulator is only called during daytime (coszrs > 0).  As a consequence,
  routine outfld in history.F90 was modified to ignore input array locations
  set to fillvalue.  To enable this feature, a new argument to addfld named
  flag_xyfill was added.  Set it to .true. to enable outfld ignoring fillvalue
  input.  Currently this is only done for appropriate ISCCP fields.  If this
  feature is enabled, for multilevel fields the setting of fillvalue MUST be
  invariant in the z-direction.  The reason is that the accumulator (nacs) is
  currently only dimensioned x-y.  The history handler checks for this 
  consistency and barfs if it is not met.  Changing the accumulator to be
  x-y-z capable would not be too hard, but might have severe performance
  ramifications.

===============================================================

cam2_0_2_dev16
Originator: tcraig ( Anthony Craig)
Date: Thu Apr  3 15:51:34 MST 2003
Model: CAM
Version: CAM2.0_2.dev16
One-line Summary: Updates for CCSM coupling with cpl6, CCSM coupling with FV, rain/snow in coupling
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

      ccsm_msg.F90 
        - Significant rewrite for cpl6, has no impact on stand-alone CAM
          (Rob Jacob).  
        - Fixed bug in outfld call for CPLRAIN*, CPLSNOW*, CPLPRCER
          (Mariana Vertenstein).
        - Removed artificial repartitioning of snow and rain in fields
          sent to coupler to be ready for CLM2.2.
        - Fixed bug in read/write of precca, precla, precsca, precsla
          (Mariana Vertenstein, Bryon Boville)
        - Modified coupling for LR dycore, removed special mods for LR
          dycore in sendgrid setting mask to zero at most pole latitudes.
          This was required for CCSM coupled runs with the LR dycore.

      spmdinit.F90
        - Removed the MPI_INIT call for COUP_CSM mode, cpl6 now handles this.
        - Removed use of shr_msg_comm_atm (cpl5).  Added a call to 
          cpl_interface_init (cpl6) to return the MPI communicator group.

      cam.F90
        - Modified some code on COUP_CSM definitions, remove calls to 
          shr_msg_init, shr_msg_groups, and shr_msg_finalize (cpl5).
          Added call to cpl_interface_finalize (cpl6).

      phys_grid.F90
        - Added two new routines, buff_to_chunk and chunk_to_buff (Rob Jacob).  
          These are used in ccsm_msg to rearrange data from a lon-lat buffer 
          into chunk structure.


===============================================================
===============================================================

cam2_0_2_dev15
Originator: jet ( John Truesdale)
Date: Wed Apr  2 08:27:51 MST 2003
Model: CAM
Version: CAM2.0_2.dev15
One-line Summary: Added capability to output history tape fields on a column by column basis
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:

I've added code and a set of namelist variables that allow fields for 
a particular history tape to be written on a column by column basis.  
The new namelist variables are named fincl1lonlat ... fincl6lonlat and 
are used in conjunction with the fincl1 ... fincl6 namelist variables.

Here is an example of how to use the new variables to define individual
columns or a lat/lon range of columns for output.

1. Define a history tape with a set of fields that you would like to see
   output at specific columns

    ex. fincl3 = 'LHFLX','SHFLX','PS','T','U'

2. Define the columns for that history tape using  fincl[1..6]lonlat
   Like the fincl[1..6] specifiers all of the column identifiers are strings.
   Specify the longitude in degrees followed by a single character
   (e)ast/(w)est modifier. Follow this with an underscore ('_') and then
   specify the latitude in degrees followed by a single character
   (n)orth/(s)outh modifier.

    ex. fincl3lonlat = '30.5e_45.5n'

        will output the model column closest to 30.5 degrees east longitude
        and 45.5 degrees north latitude for all fields defined by history tape
        3.

    You can specify a range of longitudes (or latitudes) by separating
    the min and max values with a colon (':') like so

    ex. fincl3lonlat = '30e:40e_45n'

        will output the closest model columns from 30 to 40 degrees east
        and at 45 degrees north for all fields defined on history tape 3.

    The latitudes/longitudes must be positive (real or integer).

        longitude values range from [0w to 180w] and [0e to 180e]
        latitude values range from [90s to 0s] and [0n to 90n]

3) Variables will be put on the history tape with the longitude and latitude
   coded as part of the name.

    Ex. Using these namelist variables

        fincl3 = 'LHFLX','SHFLX','PS','T','U'
        fincl3lonlat = '30.5e_45.5n','30e:40e_45n'

        will produce the following fields on history tape 3.

          LHFLX_30.5e_45.5n
          LHFLX_30e_to_40e_45n
          PS_30.5e_45.5n
          PS_30e_to_40e_45n
          SHFLX_30.5e_45.5n
          SHFLX_30e_to_40e_45n
          T_30.5e_45.5n
          T_30e_to_40e_45n
          U_30.5e_45.5n
          U_30e_to_40e_45n

   The netcdf attributes for each field will be set to include the
   actual latitude and longitude.  This allows tools like ferret
   to correctly plot the correct part of the world grid.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev14
Originator: eaton ( Brian Eaton)
Date: Thu Mar 27 15:07:31 MST 2003
Model: CAM
Version: CAM2.0_2.dev14
One-line Summary: fix fv restart under lf95/debug and fix bug in pseudo-ozone test tracer
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

>> physics/cam1/restart_physics.F90 - in subroutine read_restart_physics add
>>   calls to get_ncols_p inside the chunk loops and only assign the correct
>>   number of columns worth of restart data into srfflx_state2d and
>>   surface_state2d member arrays.
>> 
>> physics/cam1/test_tracers.F90 - fix bug in subroutine test_tracers_timestep_tend.
>>   All levels of the pseudo-O3 were being zeroed rather than just the bottom level.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev13
Originator: hender ( Tom Henderson)
Date: Tue Mar 25 10:17:12 MST 2003
Model: CAM
Version: CAM2.0_2.dev13
One-line Summary: Fixes and upgrades to test scripts, change for omega in history output.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-lf95
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik Kluzek, Jim McCaa
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

   1) Fixes to test-model.pl so -compare works (Kluzek).
   2) Shorten run length for SOM tests in test-model.pl (Kluzek).
   3) Script improvements to allow Wei to easily test lf95, pgf90-pgcc, and 
      pgf90-gcc in his automated runs (Henderson).
   4) Makefile changes to make pgf90 bfb restarts with different number of
      processes work with the fv dycore (Henderson).
   5) Makefile changes to add Fortran optimization override environment
      variable F_OPTIMIZATION_OVERRIDE (Henderson).
   6) test-model.pl upgrade to use F_OPTIMIZATION_OVERRIDE when pgf90 is
      used for fv04-fv06 and fv10-fv13 tests (Henderson).
   7) test-model.pl upgrade to allow multiple test-model.pl incarnations to
      be launched simultaneously from ncar_batch.csh (i.e. via queuing
      systems) (Henderson, Kluzek).
   8) Modified ncar_batch.csh to pass the "-unique_id" option to
      test-model.pl (Henderson).
   9) Changed $COMPARE_DIR/cam1 to $COMPARE_DIR in ncar_batch.csh to help
      folks who use non-standard directory naming (Henderson).
  10) Upgraded CAM XML parser to latest version (Kluzek).
  11) Modified history file output to replace Omega@600mb with Omega@500mb
      (McCaa and Henderson).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev12
Originator: erik ( Erik Kluzek)
Date: Thu Mar 20 15:48:06 MST 2003
Model: CAM
Version: CAM2.0_2.dev12
One-line Summary: Fix bug in test-model with -compare and update XML::Lite from 0.11 to 0.14
cam-bugs Requests resolved: 104
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Sun, Linux-PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, hender, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Update XML::Lite from 0.11 to 0.14. Creator of XML::Lite, gave us
a newer version as he said the old version had "a significant bug"
in it.

Fix bug in -compare option for test-model.pl (bug #104). Previously
worked ok if you specified the dynamics, or for eul dynamics. It would
fail when it changed dynamics.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev11
Originator: mirin ( Arthur Andrew Mirin)
Date: Thu Mar 13 17:21:11 MST 2003
Model: CAM
Version: CAM2.0_2.dev11
One-line Summary: Changes to transposes for 2D FV decomposition.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no; however one can now make with 64-bit addressing on IBM.
Substantial timing or memory changes: no
Requires change in run script: no; however, there are some new input options.
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes; however, bug in script, so could not verify.
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Will Sawyer
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None
Changes made:

        The main changes are in the area of transposes for the 2D FV decomposition.

        a. Transposes now include ghost points, which obviates extra ghost point
                communication following the transposes. This improves performance,
                but with limited impact because so few of the transposes involve ghost
                points.

        b. Transposes now use the NASA/Goddard mod_comm package, which lies underneath
                Pilgrim. This enables use of one-sided MPI-2 communications as well as
                standard MPI. NASA/Goddard personnel report substantial gains on
                the SGI when MPI-2 is used in place of standard MPI.

        c. Arrays containing extra points in any of the dimensions still cannot
                be handled and must be copied into (out of) arrays without extra
                points. Instead, the associated copies are, to the extent possible,
                overlapped with other messages. This improves performance.

        d. The number of tracers to be transposed simultaneously is now specifiable.
                Formerly, all tracers had to be transposed together. This facilitates
                overlapping copying with communication (see above point). If there are
                N tracers altogether, to be transposed in groups of M, one solves
                N = Q * M + R, and does Q groups of M and 1 group of R. Preliminary
                tests indicate that M=1 is good for coarse domain decompositions,
                but that as the decomposition becomes finer, the latency of multiple
                transpose calls outweighs the computation/communicaiton overlap
                benefit. The default is M=6.

        e. A new method for initializing the transposes has been implemented.
                Unlike the old methodology, this new method works for ghost points.
                The method scales fine spatially but very poorly with the number of
                tracers to be simultaneously transposed. Until this is fixed,
                one would best limit M (see above point) to 6 (the default).

        f. We have been experimenting with MPI derived types, versus the current
                method of copying data in and out of contiguous buffers. At present
                we are getting mixed results. This option has been implemented for
                MPI-1 only (not MPI-2). Further testing is underway.

        The files affected are:
                Directory ...../src/dynamics/fv, files cd_core.F90, dp_coupling.F90,
                        dynamics_vars.F90, dynpkg.F90, geopk.F90, inidat.F90,
                        p_d_adjust.F90, pmgrid.F90, spmd_dyn.F90, stepon.F90, trac2d.F90.                              These are virtually all transpose-related changes.

                Directory ...../src/control, files cam.F90, spmdinit.F90.
                        The change to cam.F90 is to make sure TWOD_YZ is not set when SPMD
                        is unset. The change to spmdinit.F90 has to do with MPI
                        initialization on SGI machines when using MPI-2.

                Directory ...../utils/pilgrim, files Makefile, Makefile.conf.AIX,
                        Makefile.conf.IRIX64, decompmodule.F90, ghostmodule.F90, memstuff.c,
                        mod_comm.F90, parutilitiesmodule.F90, puminterfaces.F90,
                        redistributemodule.F90.

                Directory ...../utils/pilgrim/unit_testers, files Makefile,
                        decomptest.F90, ghosttest.F90, parpatterntest.F90,
                        parutilitiestest.F90, redistributetest.F90, unstructured.F90.

                Directory ...../bld, files Makefile, configure_fv.pl, script.m4.
                        The change to Makefile is to provide option for 64-bit addressing
                        on IBM. To do so, switch actual and commented lines to set
                        ADDRESS    := Q64. The other two files are NASA/Goddard-specific.

                Directory ...../test/system, file llnl_frost.csh.

        A full diff of changes is on goldhill in ~mirin/diffs/diff_archive_cam2_0_2_dev10.

        Here is some information on new, as well as existing knobs:

        Two parameters have been added to the mprun2d namelist (used for 2D FV
                decomposition) - geopktrans and tracertrans. Geopktrans refers to the
                geopotential computation/communication method in geopk.F90. A value
                of 0 (default), which results in the setting of geopk16byte false,
                means that transposes are computed before and after the calls to
                geopk (from cd_core) in order to do the vertical indefinite integrals
                in geopk. A value of 1 causes geopk16byte to be set to true,
                meaning that instead of computing transposes, partial sums in each
                vertical subdomain are calculated and then communicated in z as
                needed; 16-byte arithmetic may be used to guarantee bit-for-bit agreement
                across domain decomposition; the default (for purposes of speed) is
                8-byte arithmethic. One can change to 16-byte arithmetic by editing
                geopk.F90 to change DSIZE from 8 to 16 (switch actual and commented
                statements). For performance purposes, the code should be used
                as is with geopktrans equal to 1. The other parameter, tracertrans,
                refers to the number of tracers simultaneously transposed (denoted by
                M above); the default is 6 and in general need not be changed.

        One can implement MPI derived types in the transposes by activating
                USE_MPI_TYPES in models/utils/pilgrim/parutilitiesmodule.F90.
                This is unsupported - do so at your own risk. This bypasses mod_comm
                and works for only MPI-1. One can make use of MPI-2 in mod_comm by
                activating MPI2 at the beginniing of mod_comm.F90. Use of this is
                definitely at your own risk.

        To run waccm configuration tests, please see instructions on goldhill
                in ~mirin/waccm.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev10
Originator: hender ( Erik Kluzek, tagged by Tom Henderson)
Date: Wed Mar 12 13:46:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev10
One-line Summary: Added SOM test to test-model.pl.  Various bug fixes. Update to ESMF_0_0_2p8
cam-bugs Requests resolved: 101, 100, 99
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: yes, if running with new SOM
-som option in configure now works.  Default will behave as before.
Substantial timing or memory changes: no
Requires change in run script: yes, if running with new SOM
Must use initial and SST datasets that are compatible with SOM.  See
/ftp/pub/erik/cam2_0_2.scidac-atm.datasets.tar.gz
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Intel-Linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Jim Rosinski, Erik Kluzek, Brian Eaton, Tom Henderson
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF library: Update to ESMF_0_0_2p8, a pruned version of ESMF_0_0_2p5
Changes made:

Added SOM test to test-model.pl and fixed bugs:

Add a SOM test for all dycores and for the control library.
Add new datasets needed for running with SOM. Reset namelist
each test in test-model.pl to make test-model.pl more robust.
Add a no-fail option to cam_timing so that when using -nofail
if a simulation aborts test-model.pl won't stop. Fix reporting
problem of different history files with -nofail. Improve the
diagnostic output of test-model.pl especially for the -nofail
case. Also be more careful at cleaning up data, such that data files
are deleted only after needed comparisions are done.

New datasets are available under "datasets" on the cam developers
web page.

Put, support message about ESMF in Makefile.

U atm/cam/bld/DefaultCAMEXPNamelist.xml
U atm/cam/bld/Makefile
U atm/cam/doc/UsersGuide/test-model.html
U atm/cam/test/system/CAM_test.pm
U atm/cam/test/system/cam_timing.pm
U atm/cam/test/system/test-model.pl

Bug fixes to make Lahey compiler happy:
U atm/cam/src/ocnsice/som/ocn_srf.F90
U atm/cam/src/dynamics/fv/inidat.F90
U atm/cam/bld/configure

Changed these ESMF files to allow for removal of lots and lots of other
ESMF files:

Update to ESMF_0_0_2p8, so can prune out unused files and directories.
Also turn off dependency of OMP, PCL, and MPI libraries. This simplifies,
shortens, and makes the ESMF make more robust. It also removes half of the
amount of disk storage for ESMF than was used before, several of the unused
code directories were removed and only the minimal set needed for using
the ESMF time manager.

U utils/esmf/README
U utils/esmf/build/IRIX/ESMF_conf.h
U utils/esmf/build/IRIX64/ESMF_conf.h
U utils/esmf/build/alpha/ESMF_conf.h
U utils/esmf/build/linux_gnupgf90/ESMF_conf.h
U utils/esmf/build/linux_lf95/ESMF_conf.h
U utils/esmf/build/linux_pgi/ESMF_conf.h
U utils/esmf/build/rs6000_64/ESMF_conf.h
U utils/esmf/build/rs6000_64/base_variables
U utils/esmf/build/rs6000_sp/ESMF_conf.h
Ripped out lots and lots of ESMF files:
...

Upgraded to simplify automated testing on anchorage with pgf90-pgcc and
pgf90-gcc:
U atm/cam/test/system/ncar_batch.csh


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev9
Originator: rosinski ( Jim Rosinski)
Date: Wed Feb 26 17:59:48 MST 2003
Model: CAM
Version: CAM2.0_2.dev9
One-line Summary: Added SOM capability.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) except Linux-pgf90 is only roundoff
Changes to CLM land-model: None
Changes made:

o Added Slab Ocean Model (SOM) capability. To enable, change som/ to dom/
in Filepath, and add #define COUP_SOM in misc.h.

For prescribed-ice control runs that will create fluxes for SOM, to get
good results CNTL_FORSOM must also be #defined.

Climates have only been examined in EUL mode. SLD and FV do compile, but they
have not yet been tested.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev8
Originator: jet ( John Truesdale)
Date: Wed Feb 19 16:51:27 MST 2003
Model: CAM
Version: CAM2.0_2.dev8
One-line Summary: fix bug in srface diagnostic variables - fsnslnd fsnsocn etc
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no

Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
These mods were to fix a bug with the newly added surface diagnostics.
They were not giving bit for bit when restarting fv and sld runs.  To
fix this I had to add some variables to the restart dataset
as well as put a n-1 timelevel of landfrac,ocnfrac,and icefrac into the
physics buffer.  These n-1 timelevel values are used from the physics
buffer on restart.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev7
Originator: hender ( Tom Henderson)
Date: Mon Feb 10 09:49:09 MST 2003
Model: CAM
Version: CAM2.0_2.dev7
One-line Summary: Grab bag -- Makefile, script, and source code fixes for SGI, Linux (PGI and Lahey), IBM
cam-bugs Requests resolved: 92, 88
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Lots of accumulated minor fixes for SGI, Linux, IBM.  All bfb.  Biggest change 
is support for Linux-Lahey in source code and ncar_batch.csh.  Brian Eaton, 
Pat Worley, John Truesdale, Jim Rosinski, and Erik Kluzek contributed various 
bits.  
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Makefile, run-ibm.csh, ncar_batch.csh, ice_srf.F90, comsrfdiag.F90, 
fv_prints.F90, test-model.pl (and files it uses)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux-Lahey
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Brian Eaton (SGI bits in Makefile), Jim Rosinski 
(Linux-Lahey bits in Makefile), John Truesdale (John made the fixes for 
ice_srf.F90, comsrfdiag.F90, and fv_prints.F90), Erik Kluzek (Erik made the 
fixes for test-model.pl)
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:
Note:  This is item #018 on CAM Check-in List "Fix performance bug in Makefile 
       for SGI (formerly CAM task list #02.12.19.5)".  It's scope has expanded 
       a bit.  
A- Modified Makefile for SGI so LDFLAGS has options and libraries in the 
   correct order ( -mp -lmp -lmpi ) as described by Pat Worley.
B- Added Brian Eaton's fix for run-ibm.csh:
   "On the IBM there are 3 environment variables that allow you to specify the
    node/task configuration.  The 2 that are set in the run-ibm.csh file imply
    that the total number of mpi tasks (procs) is 2.  It's likely that your job
    has procs=1 due to the 3rd environment variable, MP_PROCS, being set
    somewhere else, like your .cshrc or .profile file (perhaps by the SCD
    supplied default version of these files).  The fix I'd suggest is to add
    the command "unsetenv MP_PROCS" to run-ibm.csh file in the POE Environment
    settings section."  -- Brian Eaton
C- Added Brian Eaton's fix for run-ibm.csh to ncar_batch.csh too.
D- Added support for the Lahey compiler on anchorage to ncar_batch.csh.  PGI
   becomes an option, Lahey the default.
E- Added John Truesdale's fixes for ice_srf.F90, comsrfdiag.F90, and
   fv_prints.F90.  This allows versions cam2_0_2_dev1 and later to work
   with the Lahey compiler.  Prior to these fixes, lf95 was complaining about
   unintialized variables (etc.).
F- Erik Kluzek fixed test-model.pl to work around a problem on bluesky.
G- Changed pgf90 optimization from -fast to -O1 in Makefile to fix bfb problem
   with test-model.pl test #fv06 (compare initial run to restart run with
   different number of processors for fv dycore).  All other tests were 
   passing bfb with -fast.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev6
Originator: pworley ( Patrick H Worley)
Date: Wed Feb  5 15:19:36 MST 2003
Model: CAM
Version: CAM2.0_2.dev6
One-line Summary: New 1D decomposition for Fourier and Spectral domains in SLD dycore, for improved performance
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, faster for large processor counts
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: No (bit-for-bit) on SGI and Compaq; Yes (same-to-roundoff) on IBM
Changes to CLM land-model: changed division by parameter to division by local copy in lnd_grid, to eliminate compiler complaint
Changes made:

Implemented a consistent wavenumber decomposition for Fourier
and Spectral domains in SLD dycore, decreasing MPI communication and
storage requirements. Wavenumber decomposition also modified, 
to improve load balance and decrease amount of communication.
This modification is similar to that in cam2_0_1_dev3, except for
SLD instead of EUL.

Routines modified in dynamics/sld: comspe, courlim, dyn, dyndrv,
dynpkg, grcalc, hordif, quad, realloc4, realloc7, scan2, scandyn, 
scanslt, spegrd, spmd_dyn, trunc, tstep, tstep1, vertnm.
Routines deleted in dynamics/sld: realloc3, realloc6 .

Also, changed division by parameter to division by a local
copy of the parameter in two places in lnd_grid, to eliminate
a compilation failure with some versions of the IBM compiler.
(Fix provided by Art Mirin.)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev5
Originator: eaton ( Brian Eaton)
Date: Tue Jan 21 12:33:04 MST 2003
Model: CAM
Version: CAM2.0_2.dev5
One-line Summary: makefile/configure changes
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Add ability to specify additional flags to the C compiler and to the loader
(this ability already exists for the Fortran compiler).  This provides
flexibility in porting to new platforms.

Change Makefile so that the Filepath, Srcfiles, and Depends files are
explicitly in the current directory.  This fixes a bug which occurs when
make finds a Srcfiles file in the VPATH, and that Srcfiles is newer than
the Filepath (which results in Srcfiles not being created in the current
directory and the command to build the Depends file fails).

Add an option to configure to allow the configuration cache file to be
created in a different directory than the CAM build directory.  The default
behavior of configure is unchanged.

Fix a broken configuration.  The combination of omp on linux using pgf90
and gcc resulted in the timing library being built without threading
enabled.  Removed the setting of the THREADED_PTHREADS and THREADED_OMP cpp
macros from utils/timing/gpt.h and set these in the Makefile.  This also
allows them to be set only when SMP is true.  They were previously set to
use threads whether the rest of the model was threaded or not.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev4
Originator: hender ( Tom Henderson)
Date: Fri Jan 17 11:23:15 MST 2003
Model: CAM
Version: CAM2.0_2.dev4
One-line Summary: ncar_batch.csh:  added support for test-model.pl with -compare option
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

The new ncar_batch.csh can be used to do bitwise comparison with a previous 
source version.  The test-model.pl script is run internally with the -compare 
option.  

For NQS or PBS, the new usage is: 
>> env SCRIPT_DIR=`pwd` COMPARE_DIR=$MYBASEDIR qsub ncar_batch.csh

For LoadLeveler, the new usage is:  
env SCRIPT_DIR=`pwd` COMPARE_DIR=$MYBASEDIR llsubmit ncar_batch.csh

In both cases, directory $MYBASEDIR should contain the source code for the 
previous version.  

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev3
Originator: jet ( John Truesdale)
Date: Mon Jan 13 08:53:33 MST 2003
Model: CAM
Version: CAM2.0_2.dev3
One-line Summary: Added diagnostics for surface budget calculation, moved sst/ocn interpolation to correct minor flux bug
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Apache
Ran test-model.pl script: yes: Only on IBM
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-physics)
Changes to CLM land-model: None (one-line description)
Changes made:

Added diagnostics to allow for surface energy budget calculations.  The
following diagnostics were added:

FSNSLND,FSNSOCN,FSNSICE,FLNSLND,FLNSOCN,FLNSICE,SHFLXLND,SHFLXOCN,SHFLXICE,
LHFLXLND,LHFLXOCN,LHFLXICE.

Also added the following diagnostics to provide ocean/ice forcing for som
model

FSNSOI,FLNSOI,SHFLXOI,LHFLXOI

Moved the interpolation of ocean and ice right before the surface routines
that use them.  SSTINT and ICEINT were previously at the top of the time
loop before tphysbc in the routine advnce.  I removed them from advnce and
placed them after tphysbc right before camocn and camice.  This corrected
a minor bug in the models use of fluxes calculated by camocn and camice.
Previously new fluxes were computed by camocn and camice with a set of 
land, ocean, and ice fractions.  The time loop ended, advnce was called,
new surface fractions computed and then tphysbc used the fluxes calculated
the previously time around only using the new fractions instead of the
surface fractions used to compute the fluxes.  tphysbc now uses the time
level of fractions appropriate for the fluxes that are being read in.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev2
Originator: rosinski ( Jim Rosinski)
Date: Thu Jan  9 17:16:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev2
One-line Summary: Add evap bugfix to ice_srf.F90 per C. Bitz
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) or Yes (same-to-roundoff, same-physics, new-physics, new-climate)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:

o One-line chage adds sublimation over sea ice to evaporative flux in ice model.
  Changes answers beyond roundoff.  Analysis of effects of this change available at:
  www.cgd.ucar.edu/cms/rosinski/analysis/20shrconstevap-cam20shrconst/sets.htm

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_2_dev1
Originator: hender ( Tom Henderson)
Date: Mon Jan  6 15:25:38 MST 2003
Model: CAM
Version: CAM2.0_2.dev1
One-line Summary: Minor improvements to batch execution of test-model and User's Guide updates
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Erik
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Description:
  CAM_lab.pm      Update linux defaults
  CAM_test.pm     Fixed bug so "FAIL" is printed when a test fails (instad of
                  "ran").  Only affected the -nofail option.
  ncar_batch.csh  Updated to chinook "ded_16" queue and added PBS stuff for
                  anchorage.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev17
Originator: erik ( Erik Kluzek)
Date: Fri Dec 20 15:42:18 MST 2002
Model: CAM
Version: CAM2.0_1.dev17
One-line Summary: Small script change for testing, Makefile change to run on Compaq
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux-Lahey, Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Point to new test-production.pl baseline.

Change Makefile to run on Compaq.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev16
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Dec 19 14:31:58 MST 2002
Model: CAM
Version: CAM2.0_1.dev16
One-line Summary: updated cam documentation for cam2_0_2 release
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: None
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Changes made:
Updated cam documentation for cam2_0_2 release.
Clm documentation has already been updated. 	
Did not modify any code. 
===============================================================
===============================================================

cam2_0_1_dev15
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Dec 18 21:19:12 MST 2002
Model: CAM
Version: CAM2.0_1.dev15
One-line Summary: updated clm to clm2_deva_08
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: (see below)
  tested that clm2_deva_08 worked with CCSM
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: Yes
Changes made:
1) Updated clm user's guide to clm2.1 
2) Fixed restart problem for clm2.1 auxiliary history files
===============================================================
===============================================================

cam2_0_1_dev14
Originator: erik ( Erik Kluzek)
Date: Tue Dec 17 16:14:46 MST 2002
Model: CAM
Version: CAM2.0_1.dev14
One-line Summary: Fix script problems use new datasets, update to ccsm2_0_beta61
cam-bugs Requests resolved: 76, 79, 84, 85
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes (IBM)
Machines tested: IBM, SGI, Sun, Linux (PGI,Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) -- Except Z050 field changes!
Changes to CLM land-model: None

New datasets:

	Add capability for 1x1.25 for FV. Use new datasets for FV 2x2.5.
	Download the new cam2.0.2 set of SCIDAC datasets for use with
	this version of the model.

Fix test-model.pl bug in comparision:

	Fix comparision problem in test-model.pl. Also fix so that
	doesn't use as much disk-space. And change so that does
	a error-growth test with the control code.

Fix build-namelist bug:

	Fix bug in writing out long lists.

Fix bug in Z050:

	Z050 was 5 mbar surface rather than 50 mbar surface.

Fix PGI bug for open-MP processing:

	Delete a specific OpenMP loop in dynamics/fv/inidat.F90 that
	caused answers to change with number of processors.

Update to ccsm2_0_beta61:

	Update models/bld and scripts to ccsm2_0_beta61.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================
	
cam2_0_1_dev13
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Dec  9 09:49:17 MST 2002
Model: CAM
Version: CAM2.0_1.dev13
One-line Summary: clm code updated to development tag clm2_deva_07 (clm2.1 code)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
New (converted) clm initial datasets must be used
see DefaultCLMEXPNamelist.xml 
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: Yes (for clm only)
Changes answers: Yes (same-to-roundoff, same-climate)
Changes to CLM land-model: YES (updated to clm2.1 data structures)
Changes made:
	
1) clm2.1 has replaced clm2.0 in the current code.
   updated models/lnd/clm to clm development tag clm2_deva_07 
   The differences are roundoff.
   Two climate simulations were done to verify this commit.
   case: /OLESON/csm/eul_201dev10    - cam2_0_1_dev10 (clm2.0)
   case: /OLESON/csm/eul_201dev10_06 - cam2_0_1_dev10 (clm2.1 - tag clm2_deva_06) 
   The two cases were been compared with the standard climatological SST simulation 
   using CAM2.0.dev24 (case eul20dev24_a) and show the same climate  
   Performance on blackforest is effectively the same.
	
2) initial clm datasets used with clm2.0 are no longer compatible with clm2.1
   surface datasets used with clm2.0 will work with clm2.1
   restart files used with clm2.0 are not compatible with clm2.1
   a conversion tool has been created (see directory models/lnd/clm2/tools/convert_inic)
   running gmake in this directory will generate the conversion tool executable, convert_inic
   datasets needed by configure have already been converted and have been placed in the 
   directory /fs/cgd/csm/inputdata/lnd/clm2/inidata_2.1/cam
	
3) the xml file DefaultCLMEXPNamelist.xml in models/atm/cam/bld has been modified 
   to point to the converted clm2.1 initial datasets
	
4) the following tests were done using test-model.pl:
    tests              platform                    status
    ------------------------------------------------------------------
    eul:1-6:64x128L26  ibm (blackforest)           success
    eul:1-6:64x128L26  sgi (chinookfe)             success
    eul:1-6:64x128L26  linux (apache) lf95, pgf90  success 
    eul:1-6:64x128L26  sun (flagstaf)              success 
    eul:1-6:64x128L26  compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    eul:1-6:48x96L26   ibm (blackforest)           success
    eul:1-6:48x96L26   sgi (chinookfe)             success
    eul:1-6:48x96L26   linux (apache) pgf90        success 
    eul:1-6:48x96L26   sun (flagstaf)              success
    eul:1-6:48x96L26   compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    fv:1-6:2x2.5L26    ibm (blackforest)           success
    fv:1-6:2x2.5L26    sgi (chinookfe)             success   
    fv:1-6:2x2.5L26    linux (apache) lf95         success (know problem with pgf90 on restart due to openmp)
    fv:4-6:2x2.5L26    sun (flagstaf)              success   
    fv:1-6:2x2.5L26    compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    sld:1-6            ibm (blackforest)           success
    sld:1-6            sgi (chinookfe)             success
    sld:1-6            linux (apache) lf95         success
    sld:1-6            sun (flagstaf)	           success
    sld:1-6            compaq (ornl-colt)          cannot test due to know problem starting with 
                                                   cam2_0_1_dev10 on compaq
    sld:1-6:64x128L26  ibm (blackforest)           success 
    	
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev12
Originator: eaton ( Brian Eaton)
Date: Tue Nov 26 17:48:40 MST 2002
Model: CAM
Version: CAM2.0_1.dev12
One-line Summary: new physics buffer and misc makefile changes
cam-bugs Requests resolved: none
Requires change in build system: yes
ccm366 physics now requires pnats=0 (done by configure)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: yes, one fewer timelevel saved for cld, tcwat, qcwat, 
and lcwat fields.
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Implement new physics buffer (phys_buffer.F90) to manage fields that
persist across timesteps or that are communicated between different physics
packages within a time step.  Eventually the buffer.F90 module will be
replaced.  For now only the fields used by the stratiform cloud condensate
scheme are being managed by the physics buffer.  

The new module in cldcond.F90 is the start of an implementation of the new
physics interface for the cloud condensate parameterization.  It currently
just deals with the fields that use the physics buffer.  These fields save
a dycore dependent number of timelevels in the buffer, and that number has
been reduced by one from the buffer.F90 implementation (i.e., eul saves 2
old timelevels while fv and sld just save one).

Removed the need to declare pnats=1 for a cloud water constituent which
wasn't used when running with ccm366 physics.  The configure script now
sets pnats=0 in that case.

Modify Makefile, configure, and config_cache_defaults.xml to support using
netCDF f90 interface.  The environment variable MOD_NETCDF should be set to 
the directory that contains the netCDF module files.  This capability is not yet
required as CAM isn't currently using the netCDF Fortran 90 interface.

Added -qmaxmem=-1 to the AIX fflags for optimization.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev11
Originator: eaton ( Brian Eaton)
Date: Thu Nov 21 19:12:10 MST 2002
Model: CAM
Version: CAM2.0_1.dev11
One-line Summary: constituent initialization mods
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no, except for a specific non-production configuration described below
Changes to CLM land-model: None
Changes made:

Implemented mods to allow specifying for each constituent whether the
initial values are to be read from the initial file or set by an
initialization routine.  The namelist variable readtrace now serves to set
the default value for all constituents except water vapor (its default
value is .true.).  The default may be overridden by an optional argument in
the calls that register the constituents.  The optional argument may be set
by namelist variables that are managed by the constituent's package, or may
be hardwired in the call.  The ghg chemistry package uses the default value
determined by readtrace.  The test_tracers package hardwires the initial
values to be set by an initialization routine.  Thus it is no longer
necessary to set readtrace=.false. to run the test_tracer package in CAM.
The namelist variables nusr_adv and nusr_nad have been disabled.

In the FV dycore only, the initialization of constituents has been modified
to initialize one constituent at a time.  This is to reduce the memory
requirements since we couldn't fit the waccm configuration (2x2.5, 66
levels, 50 constituents) on the ibm-winterhawk2 nodes.

The mods do not change answers in the production model.  However the
following configuration has non-bfb changes: When the ghg chemistry is run
using initial values that are set by its initialization routine (rather
than being read from the initial file), the answers change due to changed
initial values.  The ghg initial values are set with uniform distributions
rather than having a decay in the stratosphere as was previously done.
Byron believes this distribution will spin up to an equilibrium state more
quickly than the previous initial distribution.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev10
Originator: eaton ( Brian Eaton)
Date: Thu Nov 14 19:03:59 MST 2002
Model: CAM
Version: CAM2.0_1.dev10
One-line Summary: fix some uninitialized variables so lf95 debug mode works
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, pc-linux-lf95
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself.  Pat Worley provided the mods.
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

These mods fix a couple of references to uninitialized variables that caused a
runtime error in executables built w/ lf95 and strict error checking.
The test-model.pl debug test (test 1) now works on all dycores with lf95.
Also fixed a couple of incorrect intent attributes.

Mods:
dynamics/{eul,sld}/linemsdyn.F90 - init vcour to 0.
vmax2d, vmax2dt, and vcour declared  intent(inout) in
1) sld/realloc7.F90
2) sld/dyndrv.F90 (in both PVP and nonPVP branches)
3) sld/courlim.F90
cam1/radctl.F90 - fix outfld call for qrl

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev9
Originator: eaton ( Brian Eaton)
Date: Thu Nov 14 09:31:24 MST 2002
Model: CAM
Version: CAM2.0_1.dev9
One-line Summary: change AIX optimization from O3 to O2
cam-bugs Requests resolved: 75
Requires change in build system: no
Substantial timing or memory changes: didn't do performance tests
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

Makefile changes for AIX only:
O3 --> O2, and remove -qstrict which is only needed with -O3
Use -qsmp=omp:noopt in debug mode.

Surprisingly (at least to me) the answers are bfb when changing from "-O3 -qstrict" to "-O2". 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev8
Originator: forrest ( Forrest Hoffman)
Date: Wed Nov 13 12:37:22 MST 2002
Model: CAM
Version: CAM2.0_1.dev8
One-line Summary: Fix for new code introduced in cam2_0_1_dev7 that caused run-time failures on SGI and Linux
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (cheetah), SGI (thanks to Mariana Vertenstein)
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Fixes to lp_coupling
Changes made:

Replaced intent(out) with intent(inout) for srfflx to avoid passing
undefined elements back to the atmosphere physics since only land point
values are filled.  This problem was exhibited under SGI IRIX and
Linux.

Added working scalars to the private clause of the OpenMP do parallel
statements to assure appropriate scope.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev7
Originator: forrest ( Forrest Hoffman)
Date: Fri Nov  8 15:46:07 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: introduced clump land model decomposition and implemented new alltoall comm between atm and lnd
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, about 7x speedup in cam<->clm communications (only)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein, Pat Worley
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: New land model decomposition on clumps and alltoall comunication for CAM+CLM configuration
Changes made:

1. Added new subroutine get_chunk_coord_owner_p() to phys_grid for
   both cam1 and ccm366 versions.

2. Added lnd_grid module containing the following:

   public surface_grid_init          ! initializes land surface decomposition
   public get_nclumps                ! returns the number of clumps defined
   public get_clump_cell_id_coord    ! returns clump/cell ids based on lon/lat
   public get_clump_owner_id         ! returns clump owner based on clump id
   public get_clump_ncells_proc      ! returns number of cells for process
   public get_clump_ncells_id        ! returns number of cells in clump
   public get_clump_tpatch_proc      ! returns number of patches for process
   public get_clump_tpatch_id        ! returns number of patches in clump
   public get_clump_coord_id         ! returns lon/lat coordinates based on id
   public get_clump_patchinfo        ! returns patch id and number of patches
   public get_clump_patchwt          ! returns patch weight based on patch num

   surfage_grid_init() performs the land model domain decomposition into
   clumps of grid cells containing patches.  Clumps are private derived
   data types which may be accessed through a suite of functions and
   subroutines also contained in lnd_grid (see above).

3. Added lp_coupling module containing the following:

   public lp_coupling_init             ! initialize clump<-->chunk mapping
   public lp_coupling_finalize         ! destroy clump<-->chunk mapping
   public alltoall_clump_to_chunk_init ! communicate fluxes from lnd to atm
   public alltoall_clump_to_chunk      ! communicate fluxes from lnd to atm
   public alltoall_chunk_to_clump      ! communicate fluxes from atm to lnd

   lp_coupling_init() initializes the mapping between atmosphere
   physics chunks and land model clumps.  It also allocates buffers
   for use by subroutines within the module which perform the alltoallv
   communication/transposition of surface state and fluxes between the
   atmosphere and the land.  This coupling is used when CAM and CLM are
   run together as a single executable (when COUP_CAM is defined).

4. Removed lnd_atmMod module which previously did processor mapping
   for coupling.

5. Modified atm_lndMod module to use routines from lp_coupling for coupling.
   Added TIMING_BARRIERS barriers for communications timing tests.

6. Modified clm_map subroutine to call surface_grid_init() (lnd_grid) for
   domain decomposition and lp_coupling_init() (lp_coupling) to initialize
   the atm<->lnd coupling.

7. Added npes=1 definition even for the case when SPMD is undefined so
   that new domain decomposition works correctly when running SMP-only.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev6
Originator: pworley ( Patrick H Worley)
Date: Wed Nov  6 22:34:11 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Fixed minor bugs introduced in cam2_0_1_dev3 that were found with Lahey and SGI compilers
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes 
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None 
Changes made:

    All changes in dynamics/eul only:

    1) Modified courlim and dyndrv to change intent of vmax2d,
       vmax2dt, and vcour from in to inout.
    2) Modified grcalc to set dalpn(2) to zero on processors
       that do not calculate it. This eliminates a failure in
       the SGI test-model DEBUG tests from using an uninitialized 
       variable. (dalpn(2) is used to calculate zurcor, which is
       used only on the processor which also calculates dalpn(2). )
    3) Moved an array initialization using array syntax
       out of an OpenMP loop, as a 
       work around for a pgf90 compiler error.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev5
Originator: bshen ( Bo-Wen Shen)
Date: Wed Nov  6 09:22:18 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Changed DAO scripts
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: Yes (in DAO scripts)
Tested to work coupled with CCSM: no
Machines tested:  SGI 
Ran test-model.pl script: no 
Tested on fv dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) 

Changes to CLM land-model: None (one-line description)
Changes made:

	
  Modified DAO scripts (configure_fv.pl and script.m4) to run
the model on DAO SGI machines.

    1. Defined SMP in Make.macros when OpenMP is used
       to run a hybrid mode on SGI.
    2. Changed the way to call system_cmd, which is
       written in C and does not accept a function name
      (trim in this case) as an argument on DAO SGI.
    3. Modified mswrite/msread which will generated at run time
    4. Calculated total # of CPUs and passed the # to PBS
       directives


===============================================================
===============================================================

cam2_0_1_dev4
Originator: eaton ( Brian Eaton)
Date: Wed Oct 30 07:46:47 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: implement ghg surface values module
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, pc-linux
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

This set of mods is in preparation for further mods to implement the new
physics interface design for initializing constituents.  The current loop
to initialize constituents that are not read from the initial file (in
{eul,fv,sld}/inidat.F90) contains a call to ramp_ghg().  This function sets
surface values for the ghg constituents which are used by the radiation
codes as well as by the ghg chemistry code.  The mods being committed
gather the code which is responsible for setting surface values of the ghg
constituents, and time interpolating them (ramping) from an annual dataset
if requested, into the single module in the file ghg_surfvals.F90.

The new module ghg_surfvals does the following:
. maintains the values co2vmr, co2mmr, n2ovmr, ch4vmr, f11vmr, and f12vmr
  as public data
. maintains the namelist variables scenario_ghg and rampyear_ghg.  The
  meaning of these variables has not changed.
. provides ramping functionality (time interpolation) when scenario_ghg is
  set to 'RAMPED'.  The data used by the ramp is determined by an include
  statement in the module.  Either file ramp_ghg_bau.h or ramp_ghg_stab.h
  may be included.  These .h files contain data formated as module data.
  When using ramped data the default is to interpolate to the current
  time.  This may be modified by setting the rampyear_ghg variable to a
  valid year which is then used to produce values that will cycle within
  that fixed year.

Files added:
physics/{cam1,ccm366}/ghg_surfvals.F90

Files removed:
physics/{cam1,ccm366}/ramp_ghg.F90
physics/ccm366/comvmr.F90

Files changed:
control/preset.F90
control/parse_namelist.F90
control/comctl.h
control/restart.F90
physics/cam1/constituents.F90 
physics/cam1/{chemistry.F90,radae.F90,radini.F90,trcmix.F90}
physics/cam1/ramp.h
physics/cam1/{ramp_ghg_bau.h,ramp_ghg_stab.h}
physics/cam1/crdcon.h
physics/cam1/radini.F90
physics/cam1/{radcswmx.F90,trcpth.F90}
physics/cam1/advnce.F90
physics/ccm366/ramp_ghg.F90
physics/ccm366/{ramp_ghg_bau.F90,ramp_ghg_stab.F90}
physics/ccm366/constituents.F90
physics/ccm366/{radabs.F90,radems.F90,radinp.F90}
physics/ccm366/radini.F90
physics/ccm366/crdcon.h
physics/ccm366/{radcsw.F90,trcpth.F90}
physics/ccm366/trcmix.F90
physics/ccm366/chemistry.F90
physics/ccm366/physconst.F90
physics/ccm366/inidat.F90
physics/ccm366/advnce.F90
dynamics/{eul,fv,sld}/inital.F90
dynamics/{eul,fv,sld}/inidat.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev3
Originator: pworley ( Patrick H Worley)
Date: Sun Oct 27 18:17:22 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: New 1D decomposition for Fourier and Spectral domains in EUL dycore, for improved performance
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: Yes, faster for large processor counts
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: John Drake, Michael Ham
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

    Implemented a consistent wavenumber decomposition for Fourier
    and Spectral domains in EUL dycore, decreasing MPI communication and
    storage requirements. Wavenumber decomposition also modified,
    to improve load balance and decrease amount of communication.
    Routines modified: comspe, dp_coupling, dyn, dyndrv,
    dynpkg, grcalc, hordif, linemsdyn, quad, realloc4, realloc7, scan2,
    scandyn, scanslt, spegrd, spmd_dyn, trunc, and tstep. Also,
    realloc3 and realloc6 no longer needed and deleted. 


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev2
Originator: pworley ( Patrick H Worley)
Date: Sun Oct 27 09:10:31 MST 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: In-lined two temporaries in grcalc, so that new EUL dom. decomp. will be bit_for_bit on the IBM in next check-in
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Jim Rosinski
Restart files change: no
Changes answers: no on Compaq, yes on IBM (same-to-roundoff, same-physics)
Changes to CLM land-model: None 
Changes made:

  Eliminated tmpr and tmpi in grcalcs and grcalca in dynamics/eul/grcalc.F90:

    tmpr = alps(ir)*alp(mr+n,irow)
    tmpi = alps(ii)*alp(mr+n,irow)

  in-lining the expressions in the two places where each
  of them is used.This causes roundoff level changes to the solution
  on the IBM, but not on the HP/Compaq. With this change, the restructuring
  of the domain decomposition used in the spectral Eulerian (next check-in)
  will be bit-for-bit. This check-in is used to isolate and document
  the source of the roundoff change.
 
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_1_dev1
Originator: sawyer ( William Barton Sawyer)
Date: Sun Oct 20 00:53:30 MDT 2002
Model: CAM
Version: CAM2.0.1
One-line Summary: Bug fix for tracer advection (from S.-J. Lin)
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit
Changes to CLM land-model: None
Changes made:

	Retagged cam2_0_dev26 to confirm with new tagging scheme.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev26
Originator: sawyer ( William Barton Sawyer)
Date: Fri Oct 18 07:48:14 MDT 2002
Model: CAM
Version: CAM2.0.dev26
One-line Summary: Bug fix from FVGCM for multiple advected constituents (S.-J. Lin)
cam-bugs Requests resolved: unlisted
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Lin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv/trac2d.F90:  bug fix, dp2 copy to dp1
	moved from above label 5000 to between labels 5000 and 6000

	bld/script.m4:  changes to avoid runtime errors in DAO runs
	which resulted from bug fix 64 (shell cmd now returns error code).

	Note:  test-model.pl is successful but does not test the
	multiple advected constituent case.  This change will be 
	further tested by DAO runs.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev25
Originator: erik ( Erik Kluzek)
Date: Wed Oct  2 08:33:38 MDT 2002
Model: CAM
Version: CAM2.0.dev25
One-line Summary: Fix run-pc.csh script.
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Fix run-pc.csh so will run without a core-dump on apache. To do this
I changed it from pur-SPMD to pure-OpenMP mode.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev24
Originator: erik ( Erik Kluzek)
Date: Tue Sep 24 22:42:42 MDT 2002
Model: CAM
Version: CAM2.0.dev24
One-line Summary: Fix minor problems (tau units, SGI system call, FV array)
cam-bugs Requests resolved: 64,65,66
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (SGI, IBM)
Machines tested: IBM, SGI, lf95, PGIF90, Solaris
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself,mvertens,boville (units)
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Use "C" wrapper for SGI system call
Changes made:

Units change: (cam-bugs 66)

	Surface stress was identified as N, consistently use N/m^2.

FV fix: (cam-bugs 65)

	Make cut array allocatable and dimension acording to npes.

SGI System routine: (cam-bugs 64)

	Use a "C" wrapper to system call on SGI so that the return
code can be queried.

INT long-name:

	Change long-name on PRECCINT and PRECLINT to note that to
get intensity (average precipitation of precipitating events), you 
divide by PRECCFRQ or PRECLFRQ respectively.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev23
Originator: eaton ( Brian Eaton)
Date: Fri Sep 20 15:41:12 MDT 2002
Model: CAM
Version: CAM2.0.dev23
One-line Summary: updates to User Guide
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

Made changes to the sections on configuring and building CAM.  Added new
material on the run scripts.  Edited details of config files and make
procedure in appendix B.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev22
Originator: rosinski ( Jim Rosinski)
Date: Fri Sep 20 14:50:14 MDT 2002
Model: CAM
Version: CAM2.0.dev22
One-line Summary: fix potential memory overwrite bug in radae.F90
cam-bugs Requests resolved: 63
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

o Fixed potential memory overwrite bug in radae.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev21
Originator: erik ( Erik Kluzek)
Date: Mon Sep 16 23:41:41 MDT 2002
Model: CAM
Version: CAM2.0.dev21
One-line Summary: Add new output fields: PRECCINT, PRECCFRQ, PRECLINT, PRECLFRQ, and Z050
cam-bugs Requests resolved: 46, 61
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Linux-PGI, Linux-Lahey, Solaris
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

New output fields and namelist items:

	PRECCINT, PRECCFRQ, PRECLINT, and PRECLFRQ. Precipitation that
exceeds a given threshold (PRECC_THRESH = 0.1mm/hr and PRECL_THRESH=0.05mm/hr
by default, both can be set on the namelist).

Fix minor problem with FV with Lahey:

Update ccsm scripts  to ccsm2_0_beta54:

Fix so Solaris would work:

	Reduce optimization level.

Minor changes to test-production.pl:

	Remove files after completion, new reference simulation.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev20
Originator: rosinski ( Jim Rosinski)
Date: Mon Sep 16 14:38:10 MDT 2002
Model: CAM
Version: CAM2.0.dev20
One-line Summary: Implement shared constants in ice code.  NOTE: no control run for this tag yet exists.
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: not yet.
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode:no
Code reviewed by: myself
Restart files change: no
Changes answers: Yes (new-climate)
Changes to CLM land-model: None (one-line description)
Changes made:

o Use shared constants in CSIM4 ice code.
o Have not yet run test-model, but will today.  Wanted to get commit in
  because folks are waiting for it.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev19
Originator: eaton ( Brian Eaton)
Date: Sat Sep 14 10:24:24 MDT 2002
Model: CAM
Version: CAM2.0.dev19
One-line Summary: implement the Makefile SMP option for linux-pgf90
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: pc-linux-pgf90
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

	Added SMP option to the pc-linux-pgf90 section of the Makefile.  Set
	the default value of SMP to true since that replicates previous Makefile 
	behavior (the -mp flags were hardwired into the pgf90 settings).  But
	note that the default in the configure script sets SMP false for pc-linux.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev18
Originator: olson ( Jerry Olson)
Date: Fri Sep  6 17:29:17 MDT 2002
Model: CAM
Version: CAM2.0.dev18
One-line Summary: bugfix in sld/scan2.F90
cam-bugs Requests resolved: none
Requires change in build system: no
(one-line description of changes: fixed treatment of non-advected tracers in sld/scan2.F90
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: no
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

	sld/scan2.F90 was copying cloud water from one time level to 
	another.  Loop was generalized to copy *all* non-advected 
	tracers.
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev17
Originator: sawyer ( William Barton Sawyer)
Date: Thu Sep  5 06:48:57 MDT 2002
Model: CAM
Version: CAM2.0.dev17
One-line Summary: Allowed 3 latitudes per process; improvements from fvgcm-1_3_71
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, S.-J. Lin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	In src/dynamics/fv:

		spmd_dyn.F90    Test for >= 4 latitudes now 
				>= 3 latitudes per process; tested
				72x46x26 with 12 processes and 
				144x91x26 with 24 processes.  Works.
		cd_core.F90	Integrated optimizations and restructuring
				from fvgcm-1_3_71.  Zero diff changes.
				Note that some experimental changes 	
				from FVGCM (HIGH_P, value of tau)
				have not yet been integrated.
		sw_core.F90	Now includes upol5, vpol5
		upol5.F90	Removed
		vpol5.F90	Removed

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev16
Originator: erik ( Erik Kluzek)
Date: Wed Aug 28 11:22:02 MDT 2002
Model: CAM
Version: CAM2.0.dev16
One-line Summary: Fix deadlock with scenario_so4, fix various bugs, 
    T85, T170 in scripts, update to clm2_3_dev32, ccsm2_0_beta53
cam-bugs Requests resolved: 37, 49, 51, 52
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Compaq, Solaris, PGF90
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: update to clm2_3_dev32
Changes made:

Build changes:

	Fix bug in "configure -test", so that tests will be done
in cam_bld directory, and then return to pwd. Add ability to do
T85, and T170 resolutions. Change prun in CAM_lab.pm for running
in hybrid mode.

History restart fix:

	History restart files weren't going to mass store -- now
they do.

Decomposition set in phys_grid_init rather than in call to it:

	Previously there were four locations to determine the
chunking decomposition type.

	Also remove the "is_lsm" and "is_phys366" methods. Always
assume that lsm will ONLY be run with phys366 and CLM will ONLY be
run with the new physics.

Update CLM to CLM2_3_dev32

	This fixes a problem with getting clmi files at T170.

Fix deadlock problem with scenario_so4:

	A parameter was only set on masterproc that needed to be
set on all nodes.

Update to ccsm2_0_beta53 and scripts_a020822

	both scripts and models/bld directories. scripts_a020822 fixes
a minor problem in ccsm2_0_beta53 scripts.

Test scripts:

	Add test-example.pl script to run the examples from the
users guide. Does limited checking to ensure things work as expected.
This is setup to run on blackforest.

	Add ability to set the remote lab in the "-errgro" option
in test-model.pl. This allows for port validation for remote
machines. Also delete more files that test-model.pl produces when
running in the default "clean" configuration. This prevents having
lots of wasted disk space for test-model.pl tests.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev15
Originator: sawyer ( William Barton Sawyer)
Date: Wed Aug  7 07:58:09 MDT 2002
Model: CAM
Version: CAM2.0.dev15
One-line Summary: Completed merge of fvgcm-1_3_56 te_map, cleaned up remaining t3/tvm arrays
cam-bugs Requests resolved: none
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv:

		te_map.F90:	completed merge of fvgcm-1_3_56 te_map.F90
				code is same except for 2D decomposition
			 	additions
		dynpkg.F90:  	removed tvm, tvmxy arguments (information is
			     	in pt, ptxy)
		dp_coupling.F90:Use pt/ptxy instead of t3/t3xy
		stepon.F90:	remove t3xy entirely, t3 from d_p_coupling
				arguments

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev14
Originator: sawyer ( William Barton Sawyer)
Date: Tue Aug  6 09:01:22 MDT 2002
Model: CAM
Version: CAM2.0.dev14
One-line Summary: Patched FV communicator bug in coupled mode; T3 reset to phys_state%t in p_d_coupling; config. improvments
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/utils/pilgrim:

		parutilitiesmodule.F90, mod_comm.F90: extended initialization
		routines to accept an optional communicator from which
		the FV global communicator is determined.

	models/atm/cam/bld

		configure_fv.pl, fvtest.sh, script.m4:  for DAO 
		code execution, renamed run script fvcam.j, 
		number of threads, processes renamed to DAO
		convention AGCM_N_PROCESSES, AGCM_N_THREADS_PER_PROCESS

	models/atm/cam/src/dynamics/fv

		dp_coupling.F90 :  t3 reset to phys_state%t in p_d_coupling
                                   (suggestion from Brian).

		stepon.F90 :       modified arg list to p_d_coupling, removed
				   explicit transpose of T3XY->T3 for 2D decomp.

		spmd_dyn.F90 :     pass mpicom to ParInit.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev13
Originator: jet ( John Truesdale)
Date: Thu Aug  1 16:03:16 MDT 2002
Model: CAM
Version: CAM2.0.dev13
One-line Summary: Fix  initialization problem with fractional land, doesn't affect climate, only for CAM not CCSM
cam-bugs Requests resolved: 43
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: Yes ( new-physics)
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
initext now uses the ts value from the land initialization routine instead
of the value returned from the update surface fluxes routine.  I added an
array to save off these values and apply them after iceint is called.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev12
Originator: erik ( Erik Kluzek)
Date: Wed Jul 31 14:20:10 MDT 2002
Model: CAM
Version: CAM2.0.dev12
One-line Summary: Add 2D-decomp for FV to bld, Fix Solaris climate, add production test, add timing parser, fix various bugs
cam-bugs Requests resolved: 17, 20, 27, 30, 31, 33, 35, 36, 37, 39
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: yes
	(makes use of the _OPENMP CPP token when SMP on, compiler options 
	must set this)
Substantial timing or memory changes: no
Requires change in run script: Yes 
	(dif4 now required on namelist if Eulerian and not T42)
Tested to work coupled with CCSM: Yes! (IBM)
Machines tested: IBM, SGI, Solaris, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

FV 2D parallel decomposition option added to bld scripts:

	Requires a new namelist (mprun2d).
	Also added a "-fv2d" option to test-model.pl to run fv tests
	with 2D decompostion. Also fix the constraint in src/dynamics/fv
	so that the npr_yz array from the namelist is checked properly.

Solaris:
	Change Makefile so that model gives climate similar to IBM.

Makefile:
	Add CPPDEF for CPP definitions used by all platforms. Also
	include a new token "CAM" declared when compling code with CAM.
	Remove "-d" on AIX, and turn on "-g, -qfullpath" in 
	production mode so that when the model core-dumps you can 
	query the core files to find where it died.

dif4:
	Now require dif4 to be set on namelist for Eulerian dynamics not
	at T42 resolution.

restart-pointer files:
	Get rid of getfil for restart-pointer file and add an optional
	argument to opnfil, so that "old" can be given for type so that
	the model will die if a restart pointer file doesn't exist.

Fix some problems with using scenario_so4:
	Fix write statements before "call endrun" so that they will be
	written even if not on masterproc. Also broadcast sulfdata to all
	nodes. There still seems to be other problems with this configuration.

namelist:
	Fix namelist parsing so that repeat declarations can be used
	(i.e. mfilt = 4*1). Also update the change method so that it parses
	as a regular namelist which allows arrays to be entered and more
	complex namelist entries.
test/system:
	Add ccm366 test and SMP=FALSE test to test-model.pl (unless on 
	AIX, ensure that SMP test gives same answers as SPMD). Add "-fv2d"
	option to test-model.pl to check FV 2D decompostion. Add some simple
	performance checking to test-model.pl. Add test-production.pl
	a script to run the production model from Sep to Feb/1 weekly
	to ensure the model is running as expected.

check-timing.pl:
	Add a script to do straight forward parsing of timing.* files to
	look at performance. Simplist operation is as follows:

	check-timing.pl directory1 directory2

	Options also exist to load the log-files in, and casenames, as
	well as a list of timers to parse in the file. To get help invoke
	it with "-help" or without any arguments.

ESMF: 	Update to ESMF_0_0_2p5 (fixes problem with compiling on Sanitas)
	This small update changes the name of "conf.h" to ESMF_conf.h
	so that it won't find the wrong file in the search path. It also
	removes the hard-wired use of /usr/local/include. Also previous 
	model versions didn't have all files updated to ESMF_0_0_2p4, and
	this update fixes that problem.

FV now passes LF95 strict checking tests with test-model.pl:

	Arrays in restart_physics:write_restart were going over pcols
	rather than cols for FV. By having the arrays only go to ncols
	this worked with LF95 and FV.

phys_grid.F90:
	Change a difficult to understand OMP loop used to get the
	number of threads to a more straight-forward OMP subroutine call.
CCSM:
	Update to ccsm2_0_beta50. Add table for dif4 to atm.setup.csh.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev11
Originator: sawyer ( William Barton Sawyer)
Date: Tue Jul 30 09:22:20 MDT 2002
Model: CAM
Version: CAM2.0.dev11
One-line Summary: te_map.F90 aligned with latest FVGCM version; optimizations: overlapping communication/computation
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, W. Putman
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv/te_map.F90

		o  Removed CPP token OLDWAY
		o  Aligned with latest FVGCM version
		o  Restructured communication (particularly for 2D
		   decomposition) to overlap communication with computation
		   as much as possible.  Slight performance gains conceivable.
 
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev10
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jul 15 10:20:32 MDT 2002
Model: CAM
Version: CAM2.0.dev10
One-line Summary: Merged latest work from DAO FVGCM version fvgcm-1_3_44 
cam-bugs Requests resolved: none
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Lin, Putman, Shen
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	atm/cam/src/dynamics/fv

		sw_core.F90, tp_core.F90, upol5.F90, vpol5.F90 --
			changes by Putman allow runs with only 3
			latitudes per PE

		trac2d.F90 -- cache optimizations by Lin for tracer advection

	utils/pilgrim

		mod_comm.F90  -- latest version from FVGCM
		Makefile.conf.IRIX64 -- support recent change #include <file.h>
		unit_testers/Makefile   rather than #include "file.h"  

	atm/cam/test/system

		dao_batch.csh -- batch script to run test-model.pl on DAO
				 machines (currently tropic and dycore)

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev9
Originator: sawyer ( William Barton Sawyer)
Date: Thu Jul  4 14:12:43 MDT 2002
Model: CAM
Version: CAM2.0.dev9
One-line Summary: Bug fixes for 2D domain decomposition, LF95 strict error checking
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:  

	in src/dynamics/fv:

	inidat.F90 : chunking patch suggested by Pat Worley

	restart_dynamics.F90: bufres now allocated on all PEs
		(for LF95 strict error checking)

	sw_core.F90, tp_core.F90 : revision by S.-J. Lin 
		crx in tpcc now ghosted +/- ng_c latitudes

	benergy.F90, cd_core.F90, trac2d.F90, uv3s_update.F90:
		fix for 2D domain decomposition on IBM --
		pole PEs now do not accidently send data
		to lower or upper levels.  Code still does
		not work on all IBM 2D configurations but 
		it is getting closer.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev8
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jun 24 02:12:01 MDT 2002
Model: CAM
Version: CAM2.0.dev8
One-line Summary: FV patches for Lahey strict error checking
Requires change in build system: no
ubstantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	src/dynamics/fv:

		mapz_module.F90:Q2 now INOUT in map1_ppm, mapn_ppm,
				because Q1 (IN) and Q2 (was OUT)
				were being passed same array

		sw_core.F90:  	crx now declared (im,jfirst-ng_d:jlast+ng_d)
				passed to tpcc crx(1,jfirst-ng_d).
				No error when ng_d == 0 (SMP-only)

		tp_core.F90:	In tpcc, dummy argument crx now declared
				crx(im,jfirst-ng:jlast+ng).  No error when
				ng (== ng_d) == 0.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev7
Originator: erik ( Erik Kluzek)
Date: Thu Jun 20 23:48:55 MDT 2002
Model: CAM
Version: CAM2.0.dev7
One-line Summary: #include "" to <>, Fix Solaris make, Fix SLD for Lahey, change   coupled restarts, fix sort, update csm_share/bld/scripts, fix clm restart
cam-bugs Requests resolved: 19, 18, 25, 26
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! (IBM, restarts tested as well)
Machines tested: IBM, SGI (some testing on Solaris, and Linux/Lahey)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, olson (sld)
Restart files change: yes (but only if COUP_CSM set)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Fix restart pointer files for long casenames
Changes made:

SLD changes for Lahey strict error checking:

	Small changes to q arrays sent to a few routines so that
	dimension of arrays would pass strict error checking in Lahey
	compiler.

Restarts:

	Change restarts when running coupled (COUP_CSM on), so that
	data not used for coupled runs not output/read. This also allows
	model to use the restart files from the b20.007 simulation.

Sort routines:

	Change sort routines in responce to bug found by Phil Rasch.

csm_share:

	Update csm_share to share2.1.3.

Misc:

	#include "" to #include <>
	Initialize ctitle and let it be up to 256 characters.
	Put "if (masterproc)" around write(6 statements for ramping.
	test-model.pl, get rid of global data used for setting up tests.
		Replace it with methods. This is a better more robust solution.
	Add -qfullpath when debug on for IBM.
	Update models/bld, and scripts directories to ccsm2_0_beta47.
	Get coupled scripts to work with CAM directory structure, and
		change so that restart can work.

CLM:
	Don't limit length on string read in from restart pointer file, 
	as this causes problem when casenames are long.

Solaris:

	Change Makefile so that model will work, get rid of special
	F77 compilation and use new autopromotion flag in the new compiler.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev6
Originator: mvertens ( Mariana Vertenstein)
Date: Thu Jun 20 15:31:15 MDT 2002
Model: CAM
Version: CAM2.0.dev6
One-line Summary: put chunking into coupled model
Requires change in build system: no
cam-bugs Requests resolved: 24
(See http://www.cgd.ucar.edu/cgi-bin/wreq/req?list-5)
Substantial timing or memory changes: Yes 
	(significant performance improvement when chunking is turned on)
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI
Ran test-model.pl script: no (does all of the following tests)
        Changes only affected coupled model model
Code reviewed by: myself, erik
Restart files change: no
Changes answers: no (bit-for-bit) 
Changes to CLM land-model: None 
Changes made:

	Put chunking into coupled model
	
	Verified bfb with ccsm2_0 and that PCOLS=16 and PCOLS=128 was bfb the same
	on the SGI and IBM in coupled mode 
	
	Verified that coupled model restarts and branches correctly
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev5
Originator: eaton ( Brian Eaton)
Date: Wed Jun 19 19:49:37 MDT 2002
Model: CAM
Version: CAM2.0.dev5
One-line Summary: build procedure mods, memory allocation mods
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

  Remove ccm366/cldwat.F90 - not used

  Add capability to bld/build-namelist to build LSM namelists

  bld/configure
  Add -[no]smp option
  Add -pcols option

  Makefile:
  Add SMP macro to allow enabling/disabling openMP without having
    to edit Makefile.  Currently only implemented for AIX and SGI.
  Get rid of the -macro_expand option to SGI f90 because
    it's not needed when you use -cpp.

  physics/cam1/phys_grid.F90 - move globalfield allocation from stack to heap
    in write_field_from_chunk and read_chunk_from_field

  dynamics/{eul,fv,sld}/stepon.F90 - move stack memory allocation of
    3-D physics and dynamics data structures to heap

  models/ice/csim4/ice_tstm.F - change first character of comment lines
    starting with c to !

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev4
Originator: erik ( Erik Kluzek)
Date: Sat Jun 15 08:04:21 MDT 2002
Model: CAM
Version: CAM2.0.dev4
One-line Summary: Remove precision module, and use csm_share/shr_kind_mod 
	instead with renames to r8,r4,i8
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Yes, same change to precision as above.
Changes made:

Precision change:

	Remove precision module and use csm_share shr_kind_mod module
	to get precision types. Use the rename feature to get the names
	that were used in the precision module.

Tools change:

	Make same change to the tools: cprnc, definesurf, interpic, mkrgrid,
	and cprlndnc. In this case keep a local copy of shr_kind_mod for
	their use. Made sure each tool changed would build after the change.

Bug-Fix:

	Added definition of CPP_INTEGER4 to pilgrim.h as was needed to
	get fv to build.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev3
Originator: sawyer ( William Barton Sawyer)
Date: Thu Jun 13 07:39:36 MDT 2002
Model: CAM
Version: CAM2.0.dev3
One-line Summary: Solved SUN compilation problem; further merging of FVGCM into CAM; bug fix for SMP-only
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, SUN
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman, Mirin
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/atm/cam/bld:
		configure_fv.pl, script.m4, revised for cam2_0 data sets (Mirin)

	models/atm/cam/src/dynamics/fv:

		pft_module.F90 : merged from FVGCM (minor additions)
		sw_core.F90 :    merged from FVGCM
		cd_core.F90 :    bug fix in call of c_sw
				 modified to use pft_module and sw_core

	models/atmlnd_share:

		precision.F90 :	 added i4 needed by DAO (mod_comm)

	models/utils/pilgrim:

		mod_comm.F90 :	 fixed SUN compilation problem, upgrade (Putman)					 additions for STAND_ALONE mode (Sawyer)
		
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev2
Originator: sawyer ( William Barton Sawyer)
Date: Tue Jun  4 09:40:49 MDT 2002
Model: CAM
Version: CAM2.0.dev2
One-line Summary: Merge of FVGCM (DAO) software engineering improvements into CAM2
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (test-model.pl) SGI (DAO A26, B26 cases)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Bill Putman, others
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

	This merges cam1_8_dev6_brnch_fvgcm_merge with cam2_0_dev1.

	models/utils/pilgrim:

		Newest version of mod_comm (but does not yet solve
		real -> real(r8) promotion problem on SUN).
		Upgrade of other modules for use in CAM-DAS
		restructuring and upgrades of unit testers.
 
	models/atm/cam/src/dynamics/fv:

		Software engineering improvements from FVGCM (DAO)

		benergy.F90 cd_core.F90 d2a3dijk.F90 d2a3dikj.F90
		dp_coupling.F90 dynpkg.F90 highp2.F90 hswf.F90 
		p_d_adjust.F90 te_map.F90 trac2d.F90 uv3s_update.F90
		use new mod_comm interface.  

		mod_mpi.F90 removed.

		mapz_module.F90 consolidates vertical interpolation routines:
		kmppm.F90 map1_ppm.F90 map3_ppm.F90 ppm2m.F90 steepz.F90

		inidat.F90 initcom.F90 pmgrid.F90 spmd_dyn.F90 trunc.F90 
		  minor structural changes
		

	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam2_0_dev1
Originator: erik ( Erik Kluzek)
Date: Mon Jun  3 14:10:23 MDT 2002
Model: CAM
Version: CAM2.0.dev1
One-line Summary: Fix test-model.pl problems, fix problems running Lahey 
	for Eul dy-core, add T31 namelist options
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (some testing on Linux with Lahey--lf95)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

T31:

	Add namelist options and datasets needed to run T31.

test-model.pl

	Fix a couple problems with test-model.pl. Will now properly
run through the list of all dynamics. Start refactoring to a more
general way to run through the tests with object methods rather than
global data. Put quotes around run env variables, allow setting of
interactive option in CAM_namelist, make sure CAM objects have everything 
properly set withe either setenv or setcfg.

Lahey fix:

	A few changes to dynamics/eul so that qfcst arrays can be properly
dimensioned. Inside spegrd and tfilt_massfix copy qfcst from i1 to nlon+i1-1,
so that strange things with memory don't have to be done. This allows
tests 1 and 2 with test-model.pl to work for Eulerian dynamics. Test 13 fails. 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev11
Originator: erik ( Erik Kluzek)
Date: Fri May 17 10:37:16 MDT 2002
Model: CAM
Version: CAM1.8.dev11
One-line Summary: License update, icefrac bug-fix, build fixes, dataset name changes, fix test-model.pl so that validation could be done
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
	(dataset names change)
Tested to work coupled with CCSM: yes! (IBM)
Machines tested: IBM, SGI, Linux-PC-PGI 
	(some testing on Compaq, Linux-Lahey, and Solaris)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

License update:
	Update to CAM license as reviewed by Bill Collins and Catherine
	Shea (NCAR lawyer).

icefrac bug-fix:
	Fix problem introduced in cam1_8_dev10 on initialization of
	icefrac. 

Build fixes:
	Various fixes to build scripts to work on machines at ORNL.

Name changes:

	Dataset names change to be consistent with the following format:

	<model><file type>_YYYY-MM-DD_<resolution>_L<vertical levels>_<description>_<creation date>.nc

	resolution for spectral dycores is refered to as nlatxnlon, with
	the spectral truncation following. So for example, Eulerian T42 is
	refered to as: 64x128_T42, SLD T63 is 64x128_T63. Datasets that
	don't have a specific spectral truncation associated with them
	leave off the spectral truncation part (so initial datasets run
	through definesurf or most land datasets).

	Example:

	cami_0000-09-01_64x128_L26_c020514.nc

test-model.pl

	Fix test-model.pl so that release version of the model could be 
	validated.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev10
Originator: erik ( Erik Kluzek)
Date: Mon May 13 12:01:17 MDT 2002
Model: CAM
Version: CAM1.8.dev10
One-line Summary: Replace Numerical-Recipe code, Lahey fixes for multiple constituents, Update to ccsm2_0_beta45, update to clm2_3_dev30, some Solaris and Compaq fixes
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes
Machines tested: IBM, SGI, Linux-PGI, Linux-PGI/GCC
	Some testing with Solaris and Compaq, but not everything works.
Ran test-model.pl script: yes (does all of the following tests)
 (test-model.pl currently broken test-model ran with previous version)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to clm2_3_dev30
Changes made:

Known problem:
	This model core-dumps in the standard configuration due
to a problem with the initialization of icefrac.

Lahey fixes:

	Do some fixes for strict error checking with Lahey compiler when
using multiple constituents.

Numerical Recipes sorting routines replaced:

	Numerical Recipes routines CAN NOT be publically released, so
they were replaced by Tony Craig's implementation of the same alogrithm.

cprnc:

	Fix cprnc so it would work on Solaris. Solution was a Kludge to
get it to work. More work should be done to find the underlying problem.

CCSM2_0_beta45 update:

	Update models/bld and scripts to ccsm2_0_beta45.

CLM2_3_dev30 update:

	Update CLM to clm2_3_dev30.

test-model.pl

	With the new build stuff in place test-model.pl is currently
broken. It will be fixed as soon as possible (which may be after the
model release).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev9
Originator: eaton ( Brian Eaton)
Date: Mon May 13 11:22:15 MDT 2002
Model: CAM
Version: CAM1.8.dev9
One-line Summary: merge newbld branch
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: none
Ran test-model.pl script: no - it's officially broken
Tested on fv dynamics: no
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: no
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None (one-line description)
Changes made:

Added new build scripts and user docs.

atm/cam/bld/configure produces the Filepath, misc.h, params.h, preproc.h files,
and a Makefile.

atm/cam/bld/build-namelist produces a namelist file

test-model.pl is currently broken because Erik's mods to have it use CAM_namelist.pm
have not been completed.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev8
Originator: erik ( Erik Kluzek)
Date: Wed May  8 17:41:26 MDT 2002
Model: CAM
Version: CAM1.8.dev8
One-line Summary: Fix CCSM restart problem
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! IBM
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes (eul coupled only)
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Fix problem where restarts when running coupled were not bit-for-bit.
All changes are isolated to ccsm_msg.F90.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev7
Originator: jet ( John Truesdale)
Date: Wed May  8 16:22:05 MDT 2002
Model: CAM
Version: CAM1.8.dev7
One-line Summary: definesurf to extend ross ice shelf by default, clean up csim error messages
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no or Yes (describe)
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Restart files change: no
Changes answers: no 
(Note: test-model.pl only does checks this -- if you run it with the "-compare" option)
Changes to CLM land-model: None (one-line description)
Changes made:
Fix to definesrf to make it extend ross ice shelf by default.  Non-land
below S79 is set to land so that land will treat the area as glacier.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev6
Originator: sawyer ( William Barton Sawyer)
Date: Wed May  8 07:59:26 MDT 2002
Model: CAM
Version: CAM1.8.dev6
One-line Summary: FV patches to help pass lf95 strict error checking, Erik's fix of tphysbc.F90 to pass FV test 1
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI, Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, erik 
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

	bld:   configure_fv.pl and script.m4 upgraded for cam1_8

	src/physics/cam1:  tphysbc.F90  fix by Erik to pass FV test 1

	src/dynamics/fv:

		avgc.F90 : retired
		cd_core.F90 : inlined avgc.F90 
		dp_coupling.F90 : intent(inout) u3s (it's updated during ghost)
		dynamics_vars.F90: temporary arrays allocated for SPMD only
		dynpkg.F90: 2D decomposition arrays now allocated consistently
		pmgrid.F90: initialize 2D decomp variables for non-2D case
		stepon.F90: 2D decomposition arrays now allocated consistently

	utils/pilgrim:

		mod_comm.F90:  intent(inout) q in BufferUnPack*D
	
Note:   it will pass lf95 strict error checking in SPMD mode on Linux
	only if following routines are compiled with DEBUG FALSE:
	fv_prints.F90, restart_dynamics.F90 and restart_physics.F90.
	Strict error checking yields errors in those routines which
	may be related to the chunking mechanism.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev5
Originator: erik ( Erik Kluzek)
Date: Tue May  7 13:03:41 MDT 2002
Model: CAM
Version: CAM1.8.dev5
One-line Summary: Fix problem with restarts when running coupled.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: yes! IBM (full "K" test suite)
Machines tested: IBM
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: No -- not when running coupled!
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

Change ONLY ccsm_msg.F90 so that restarts would work. Ran the
full CCSM test GUI on the BIM (blackforest).

This version has a bug in it where restarts are not exact when
running coupled. This problem is fixed in cam1_8_dev8.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev4
Originator: rosinski ( Jim Rosinski)
Date: Thu May  2 15:12:01 MDT 2002
Model: CAM
Version: CAM1.8.dev4
One-line Summary: xlf90 bugfix for h_override.  make clean deletes esmf.  flint complaints.  modified timing calls.  Added lf95 to definesurf makefile.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None (one-line description)
Changes made:

o Bug in xlf90 caused h_override to behave improperly.
o "make clean" now deletes esmf/ directory as well as .o, etc. files
o Fixed some flint complaints.
o Added lf95 entry to definesurf makefile.
o Modified some of the calls to the timing library.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev3
Originator: erik ( Erik Kluzek)
Date: Wed May  1 22:25:25 MDT 2002
Model: CAM
Version: CAM1.8.dev3
One-line Summary: Output field changes, cam1 to cam2, FLAND to LANDFRAC, 
	fix vertinterp, longname for constituents
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: yes
	(Restart pointer files are now cam2 instead of cam1, restart files have cam2 in name)
Tested to work coupled with CCSM: Yes! (SGI and IBM)
Machines tested: IBM, SGI, Linux-PGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens (and input from wcollins, pjr, and boville)
Restart files change: no
Changes answers: no (bit-for-bit) (although DTCOND different)
Changes made:

Output field changes:

	DTCOND -- Changed to be defined by dry static energy instead of
                 temperature to be more consistent with current alogrithms.
                 This change is from Fabrizio Sassi.
	New fields:
		WSPEED -- Wind speed (default maximum)
		FSDSC --- Clearsky downwelling solar flux at surface
		PRECTMX - Maximum precipitation rate
		(Add above to monthly files)
	Put TREFMNAV and TREFMXAV on output monthly files for non-coupled case.

	These changes are in ccsm-bugs as request 19.

Change instances of cam1 to cam2:

	Change occurances of cam1 to cam2 in output file names and code comments.

FLAND on initial files is now LANDFRAC:

	Have initial files that are produced use the name LANDFRAC instead
of FLAND to be consistent with history files. This also put attributes on
the field which didn't happen with the FLAND name. For backwards compatability
allow the names on the initial files to be either LANDFRAC or FLAND.

vertinterp:
	Apply a fix to vertinterp as found by Art Mirin. This fixes a problem
	if the interpolation pressure happens to exactly equal the pressure
	at a data-point.  Recorded in ccsm-bugs as request 29.

Constituents module now has longname data element:

	Add longname to constiuents module and set it as an optional argument
	in add_cnst. When add_cnst called if appropriate set longname to
	something useful.

Coupled:
	Change scripts to look at inputdata/atm/cam2 input directory.
	Fix log-file output problem by adding a if( masterproc) on 
	the "stopping at end of day" print.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev2
Originator: erik ( Erik Kluzek)
Date: Sat Apr 27 09:39:39 MDT 2002
Model: CAM
Version: CAM1.8.dev2
One-line Summary: Update to cam1_8_dev1_brnchT_esmfup4 -- 
   Update to ESMF_0_0_2p4, clm2_3_dev29, ccsm2_0_beta41, simple fixes, 
   nix scatter/gather aliasing for CCSM
Requires change in build system: Yes (ESMF build changes)
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (SGI and IBM)
Machines tested: Some testing on all platforms: 
	IBM, SGI, Compaq, Solaris, Linux-PGI, Linux-Lahey, Linux-PGI/GCC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to clm2_3_dev29
Changes to ESMF: Update to ESMF_0_0_2p4
Changes made:

ESMF update: Update to newer version of ESMF with name changes from
	mf_ to esmf_. The newer ESMF simplifies the build by not needing
	dependence on OMP or MPI, so nothing is referenced outside the
	ESMF distribution.

CLM2 update: Update to clm2_3_dev29 which works with ESMF version above.

CCSM Update: Update models/bld and scripts directories to ccsm2_0_beta41
	version of the scripts. Also put PCOLS define in CCSM scripts rather
	than hardcoded in ppgrid.F90. Ran csm.csh test on babyblue and utefe.
	Bit-for-bit with non-SPMD version and bit-for-bit with previous
	model.

CCSM Scatter/Gather aliasing: Get rid of the aliasing (using the same array
	for input and output) in the mpigather and mpiscatter calls in 
	ccsm_msg.F90. In the process create a new allocatable array allocated
	on masterproc and an old array allocatable so that only dimensioned
	from beglat:endlat. This reduces the total amount of memory needed 
	for the mpi scatters and gathers.

Solaris: Fix a couple subscript problems caught on solaris in history.F90.
	Then as a particularly difficult problem was caught, turn subscript
	checking off for solaris when DEBUG=TRUE.

phys_grid.F90: Get updates from Pat Worley and Art Mirin to generalize 
	phys_grid.F90 in cam1 for odd numbers for FV dynamics. Tried same
	routine in ccm366 physics, but results in problems.

ORNL -Colt: Add settings needed to CAM_lab.pm to run on colt.ccs.ornl.gov.

Testing: Ran at least some test-model.pl tests on all platforms:

	Linux-PGI (Apache, longs), Linux-Lahey (Apache, compile test on longs)
	Linux-PGI/GCC (Apache, longs), SGI (utefe), IBM (babyblue, eagle@ornl),
	Solaris (sanitas, test 1 works), Compaq (colt@ornl tests 2-5 with SPDM off)

	There are problems with some of the standard tests in test-model.pl
	on particular platforms. These problems will need to be cleanup in
	before model release.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_8_dev1
Originator: erik ( Erik Kluzek)
Date: Mon Apr 22 13:11:18 MDT 2002
Model: CAM
Version: CAM1.8.dev1
One-line Summary: Move cam1_7_dev34_brnchT_fractional_8 branch to the development branch
Requires change in build system: Yes!
	Filepath requires new directories
Substantial timing or memory changes: Yes (running with new ice-model is slower)
Requires change in run script: Yes
	New set of SST and Initial condition files are required.
Tested to work coupled with CCSM: Yes! (IBM and SGI) 
	(bit-for-bit with ccsm2_0_beta38)
Machines tested: IBM, SGI, Compaq, Sun, Linux-Lahey, Linux-PGI
	(Sun compiles but doesn't run, Compaq core-dumps on error-growth
	test, Linux-PGI core-dumps on error-growth test with fv dynamics)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, John Truesdale, Mariana Vertenstein, Jim Rosinski
Restart files change: yes!
Changes answers: new-physics
Changes to CLM land-model: Interface changes
Control cases:
	/EATON/csm/fv2x-fland05   -- Finite-Volume with PCMDI SST's.
	/JET/csm/sldnewicefrac01  -- SLD dynamics with PCMDI SST's.
	/ROSINSKI/csm/newsstclim03 - Eulerian dynamics with Hurrell
		Hadley Center OI / Reynolds blended SST data climatology.
	/ROSINSKI/csm/newsstamip02 - Eulerian dynamics with Hurrell
		blended monthly SST data.
Changes made:

Physics:

	Fractional land and ocean: Old binary ORO flag is gone replaced
	by the fractions: landfrac, icefrac, and ocnfrac. Also the old
	flag on SST datasets is done away with and ice-cov is used for
	sea-ice concentrations. comsrf.F90 was reworked as part of this change.
	Also the offline tool "definesurf" was changed to work with the
	new datasets. "interpic" continues to work with IC files as well.

	New ice-model: A modified version of the CCSM Sea-Ice model
	Community Sea-Ice Model (csim4) is included with the model
        now in the "models/ice/csim4" directory. The old ice-model is
	included in the new directory "models/atm/cam/src/ocnsice/dataicemodel".

CCM3.6.6 Physics:

	The CCM3.6.6 physics is still supported although now it can ONLY
	be run with Eulerian dynamics/LSM and the old data ice/sst model.
	The old version of the data ice model codes are in the "physics/ccm366"
	directory.

Namelist changes:

	prognostic_icesnow -- If TRUE determine snow-depth over ice prognostically
		otherwise use a climatology.
	reset_csim_iceprops -- Reset the CSIM ice-model initial properties
		(used on a new initial run if the model blows up).

Script / Makefile changes:

	Filepath, datasets and new variable "ICEMODEL" added to deal with
	the two ice-models (CSIM4 or CCMDATA). Lahey error-checking added
	to Makefile. Initial datasets now require the land-fraction on
	them in the variable "FLAND". When using the new ice model 
	SST datasets are required to have the variables "SST_cpl" (for SST), 		and "ice_cov" for sea-ice concentration.

	"NEWBUILD=TRUE" option now the only way to use the standard makefile.
	The old "makdep" dependency generator logic ripped out of the Makefile
	and deleted from the "tools/makdep" directory.

	Users guide updated to reflect changes. DatasetLog updated with
	new datasets.

New datasets:
	To obtain the new tar-ball of datasets:

	ftp ftp.cgd.ucar.edu
	cd pub/erik
	bin
	get cam1_8.scidac-atm.datasets.tar.gz

Error-growth:

	Error-growth is much faster than previous versions of the model.
	Error-growth is still high using the dataicemodel and active-land.
	Using prognostic_icesnow=.false. improves error-growth, and using
	standard T42L26 datasets provides reasonable error-growth. Also
	running error-growth with aqua_planet on provides reasonable error-growth.

Coupled model:

	landfrac, and ocnfrac are now binary values of 0.0 or 1.0 in
	accordance to how ORO was previously assigned in the model. This
	should eventually be changed to use the values the coupler send
	explicitly.

test-model.pl:

	Change restart tests to restart after 5 time steps.
	Change error-growth full-physics test to use prognostic_icesnow=.false.
	and aqua_planet=.true. and use date from dataset rather than Dec/31.
	Delete the SOM test and add a new test to make sure using the
	dataicemodel works.
	Fix problem with recognizing old files.

interpsst gone:

	The old tools/interpsst code removed as it will not work with the
	new SST files. Also new tools for creating SST datasets are in 
	development. The new tools use the Hurrell SST datasets and also
	modify data so that when a linear time-interpolation is applied
	to the mid-monthly datapoints the observed monthly average is
	reconstructed. It's unclear when the new tools will become part
	of the distribution.

Changes to make most of the model Lahey compliant:

	Small changes to large amounts of the code so that strict error-checking
	with the Lahey compiler can be performed on most of the model. The
	files: binary_io.F90, wrap_nf.F90, wrap_mpi.F90 have not been converted.
	As part of this change the routines bouyan, and cldprp where moved
	to inside the zm_conv.F90 file.

Bug-fixes:

	Fix in phys_grid.F90 for SGI.
	Fix in filenames.F90 for IBM.

Known problems:

	IBM -- history.F90 still doesn't always compile when DEBUG=TRUE.
	Compaq -- Model core-dumps with "floating invalid" when running
		error-growth test on Compaq (Colt @ ORNL)
	The model compiles but has trouble running on the Sun. Subscript overflow
		problem when running compiler checking (Sanitas @ NCAR).
	Linux-PGI -- fv: When running FV dynamics and Error-growth the model
		aborts with an error 
                  "DEALLOCATE: memory at 43d18c10 not allocated"
                (Apache @ NCAR)

	SOM -- New model does not work with the slab-ocean model.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev34
Originator: rosinski ( Jim Rosinski)
Date: Fri Mar 29 16:44:22 MST 2002
Model: CAM
Version: CAM1.7.dev34
One-line Summary: Bugfix to tphysbc.F90 to keep uninitialized data (in ptend) from being used.
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: yes (does all of the following tests)
                          NOTE: fv tests on IBM failed for both this commit and the comparison
                          previous library due to compiler bugs.  But all ran OK on PC.
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit) presuming the short tests are sufficient to ensure no garbage
                 from stack being used
Changes to CLM land-model: None
Changes made:

o Contents of local variable ptend in tphysbc were being used uninitialized. No ill symptoms were
  noticed in the dev branch, but the fractional branch was randomly seg faulting or encountering
  a floating point error when restarting on 16 nodes on blackforest.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev33
Originator: pworley ( Patrick H Worley)
Date: Tue Mar 12 14:30:32 MST 2002
Model: CAM
Version: CAM1.7.dev33
One-line Summary: load-balanced physics option; PCOLS cpp token for setting pcols; SOM chunking bug fix
Requires change in build system: yes
PCOLS cpp token required to set pcols in ppgrid.F90. params.h.in.csh modified to do this automatically. 
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM and Compaq at ORNL
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Marcia Branstetter
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

1) Changed phys_grid_init call. Instead of specifying number of
   columns per chunk, now specify number of chunks per thread.
   This then sets the number of columns per chunk appropriately, 
   guaranteeing that the same number of chunks can be assigned
   to each processor. Files affected:

  control/restart.F90
  control/wrap_mpi.F90
  dynamics/eul/inital.F90
  dynamics/sld/inital.F90
  dynamics/fv/inital.F90
  physics/cam1/phys_grid.F90
  physics/ccm366/phys_grid.F90

2) Augmented physics domain decomposition options:
   opt == -1: same as before (latitude-slice chunk, for compatibility
               with ccm366 physics, lsm1, and CSM)
   opt == 0:  For a given MPI process, all chunks have the same number
              of columns, and each thread associated with a process has
              the same number of chunks. Columns are assigned to chunks 
              to improve load balance between chunks (compared to
              the default ordering), but without requiring 
              interprocessor communication in dp_coupling.  
   opt == 1:  All chunks have the same number of columns and each
              thread has the same number of chunks, across all MPI
              processes. Columns are assigned to chunks to balance
              day/night, summer/winter "static" load imbalances. 
              Chunks are assigned to processes to minimize interprocessor
              communication in dp_coupling, but it will occur
              anyway unless the dynamics decomposition is compatbile.   
   Files affected:


   dynamics/eul/dp_coupling.F90
   dynamics/eul/dyn_grid.F90
   dynamics/eul/inital.F90

   dynamics/fv/dp_coupling.F90
   dynamics/fv/dyn_grid.F90
   dynamics/fv/inital.F90

   dynamics/sld/dp_coupling.F90
   dynamics/sld/dyn_grid.F90
   dynamics/sld/inital.F90

   physics/cam1/phys_grid.F90
   physics/ccm366/phys_grid.F90  

   control/wrap_mpi.F90
   control/restart.F90

3) Added PCOLS cpp token, used to set pcols parameter in ppgrid.F90 .
   When running coupled, pcols (still) set to PLOND. params.h.in.csh
   modified to set PCOLS default, taking care of LSM1 and CCM366 physics
   special cases. (Code courtesy of Erik Kluzek.)

   Files affected:  

   ../bld/README
   ../bld/params.h.in.csh
   physics/cam1/ppgrid.F90
   physics/ccm366/ppgrid.F90

4) Fixed chunking bug in SOM. Files affected:

   ocnsice/som/somoce.F90
   ocnsice/som/srfsomi.F90
   ocnsice/som/srfsomo.F90
   ocnsice/som/srftsbi.F90

5) Miscellaneous clean-up (removing pchnk and pchnkd parameters,
   renaming a phys_grid routine). Files affected:

   physics/cam1/physgrid.F90
   physics/cam1/ppgrid.F90
   physics/cam1/cldwat.F90
   physics/ccm366/physgrid.F90
   physics/ccm366/ppgrid.F90
   control/history.F90
 



See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev32
Originator: erik ( Erik Kluzek)
Date: Thu Mar  7 23:00:41 MST 2002
Model: CAM
Version: CAM1.7.dev32
One-line Summary: Bug-fix to cam1_7_dev30 snowfall rates, also fix interpret_filename_spec
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes!
Machines tested: IBM, SGI (some testing on Linux, SunOS as well)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, tcraig
Restart files change: no
Changes answers: Yes (fixes bug from cam1_7_dev30 where everything appears as snow)
Changes to CLM land-model: fix problem where numpatch was "use"'d twice
Changes made:

tphysbc.F90:

	Fix bad merge from cam1_7_dev30 that caused all precipitation to fall
as snow.

filenames.F90:

	Check if prev is present before using. Without this the SGI and Compaq
would seg-fault when running the model.

test-model.pl:

	Fix problem in test 6. Tests skipped don't build-namelist.

run-model.pl:

	Don't resubmit till year 1 after first simulation.

clm:

	Fix double "use" of numpatch.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev31
Originator: mirin ( Arthur Andrew Mirin)
Date: Thu Mar  7 10:11:37 MST 2002
Model: CAM
Version: CAM1.7.dev31
One-line Summary: Completed full history capability for 2D FV decomposition
Known bug: All precipitation appears as snowfall!
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Added 32-bit accumulation buffers and initial history file capability for 2D FV decomposition. This involved a number of changes to history.F90, minor changes to stepon.F90, enhancements to restart_dynamics.F90, and enhancements (made by Will Sawyer) to the Pilgrim library (puminterfaces.F90, pilgrim.h, parutilitiesmodule.F90, redistributemodule.F90). Also made a minor unrelated improvement to trac2d.F90 (elimination of 2D temporary array).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev30
Originator: erik ( Erik Kluzek)
Date: Wed Mar  6 08:58:37 MST 2002
Model: CAM
Version: CAM1.7.dev30
One-line Summary: Fix labels on monthly files, physics changes from mzh6, 
	fix CCSM logs, update to ccsm2_0_beta38
Known bug: All precipitation appears as snowfall!
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes!
Machines tested: IBM, Linux (PGI)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens
Restart files change: no
Changes answers: Yes! (same-physics -- less snowfall, reduced Cn over sea-ice)
	Case names for changes: /CCSM/csm/b20.001
Changes made:

Bug introduced:

	This version introduces a bug where all precipitation appears as snow.
This was due to incorrectly resolving a conflict in the merge from mzh5 to
mzh6.

Fix labels on monthly files:

Monthly files were labeled with the current time-stamp. Now they are labeled
with the previous month. Also don't output a monthly file, if nstep == 0,
as it will just be an instantaneous time-sample rather than an average.

Get code updates from ccm3_12_47_brnchT_mzh6:

Snowfall is reduced by requring average temperature to be -2C. Reduce cloud
condensation nuclei over sea-ice from 40 to 5. These code changes were tested
coupled, but not stand-alone yet. Both a new coupled and uncoupled simulation
will be run shortly.

Fix log-files when running coupled:

Only redirect masterproc output to atm.log file. Redirecting all output was
causing conflicts in the log file and causing most of the information
to be lost. Also add more checks on masterproc for output when running coupled.

Update CCSM scripts to ccsm2_0_beta38:

Update the "models/bld" and "scripts" directories to point to the "beta38"
version of CCSM2.0.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev29
Originator: erik ( Erik Kluzek)
Date: Fri Mar  1 20:53:28 MST 2002
Model: CAM
Version: CAM1.7.dev29
One-line Summary: Fix initial filenames and increase caseid from 16 to 32 characters
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM (eul,sld,fv), SGI (eul only)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Increase caseid from 16 to 32
Changes made:

Increase caseid from 16 to 32 characters.

Fix filenames of initial files (the .nc extension was dropped off).

Change test-model.pl. SOM test now run on all platforms (AIX was left
off before). $CASE is a little longer and more descriptive. Filewildcard
more explicit (solves a simple problem I ran into, where the old file
was found).

Ran run-model.pl with a 32-character caseid (both with CLM and LSM) 
producing initial files to make sure worked with long caseid, and 
initial files had proper name.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev28
Originator: erik ( Erik Kluzek)
Date: Fri Feb 15 17:56:56 MST 2002
Model: CAM
Version: CAM1.7.dev28
One-line Summary: Add new flexible filenames with CCSM names as defaults, update to CLM2.3.17
Requires change in build system: yes
	(SHELL_MSS is no longer required)
Substantial timing or memory changes: no
Requires change in run script: no
	(namelist options changed: rirt, nrmvn, nsmvn removed, irt => mss_irt, 
	nswrps => mss_wpass, add hfilename_spec, archive_dir option)
Tested to work coupled with CCSM: yes!
Machines tested: IBM, SGI (some testing on Linux PGI, Sun)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, mvertens, eaton
Restart files change: yes!
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Update to CLM2.3.17, get to work with changes
Changes made:

Flexible filenames:

	New namelist option, hfilename_spec to specify filenames, newly
adopted CCSM standard filenames are the default. Filename specifiers set
the filenames, with the following interpretations:

	%c = casid
	%t = tape number
	%y = current year
	%m = month
	%d = day
	%s = seconds into current day
	%% = % character

By default non-monthly files have a hfilename_spec of: "%c.cam1.h%t.%y-%m-%d-%s.nc"
Hence, for example, with a caseid="test", tape number 2, writing it's first data
for 12/1 UT 0:0 for year 1, will have the filename: 
"test.cam1.h1.0001-12-01-00000.nc".

Namelist:

	nsmvn, nrmvn, and rirt removed from namelist.
	old irt renamed to mss_irt
	old nswrps renamed to mss_wpass

	Added hfilename_spec filename specifyer to history filenames.
	Added archive_dir to give MSS archive directory 

	(now defaults to /USERNAME/caseid/csm/atm).

Filenames module:

	New module to deal with filenames, and MSS options and interpret
filename specifiers (as above). Unit-test for this module was created.

Restarts:

	history and abs-ems restart full filepaths added to master restart file.
Restart pointer file changed to include information on all files needed to
successfully do a restart. Restart files are disposed to MSS when closed
rather than in wrapup.

History:

	History filenames are created and opened when data is first written to 
them. Added methods: get_mtapes, get_hist_restart_filepath, get_hfilepath
to get private data in history module. Increase length of filenames to 256.

CCSM scripts:

	models/bld updated to ccsm2_0_beta35, scripts updated to 
scripts_a011228_brnchT_a020201. system_test script updated to changes in these
scripts. atm.setup.csh updated for new namelist changes.

test-model.pl:

	New SOM dataset names added. Changed test-model.pl to use NEWBUILD
mechanism which should speedup build, changed so that error-growth tests
run without trace-gas, but with readtrace to exercise more code options. Set
nhtfrq(1) for restart tests so that all history files produce restart files.
Change Makefile so that explicit path to mkSrcfiles and mkDepends scripts
is given (using Rootdir).

CLM:

	CLM updated to CLM2.3.17 (uses new CCSM filename convention). Update
to filenames module and namelist change.

Move files unused by CLM from atmlnd_share to control:
	(Testing of files in atmlnd_share is insufficient to work with
	CLM2. So we are working on seperating the two.)
	ioFileMod.F90, gauaw_mod.F90, wrap_mpi.F90
	ioFileMod.F90 changes so that comments, and mvn is not needed, and
	SHELL_MSS option becomes standard.

MSS:

	Remove MSS comments when mswrite done, and remove SHELL_MSS CPP token,
since always used.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev27
Originator: eaton ( Brian Eaton)
Date: Fri Feb  8 18:19:23 MST 2002
Model: CAM
Version: CAM1.7.dev27
One-line Summary: bugfix for CAM makefile
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik
Restart files change: no
Changes answers: no
Changes to CLM land-model: None
Changes made:

The CAM build was failing when the new ESMF macro MF_BUILD was set to a
relative path.  Added fix to CAM makefile to convert the relative pathname
to an absolute one.

Misc:  modified bld/condense-path.pl to look for CAM.pm in $MODEL_CFGDIR.
This allows bld/configure.csh to be used in a directory other than bld.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev26
Originator: eaton ( Brian Eaton)
Date: Wed Feb  6 14:52:17 MST 2002
Model: CAM
Version: CAM1.7.dev26
One-line Summary: update esmf to MF_LLU_0_0_12p1 and add fixes for lf95
Requires change in build system: yes
CAM Makefile modified to set MF_BUILD macro used by esmf makefile.
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

David Neckels' summary of changes in MF_LLU_0_0_12p1:
> Version: MF_LLU_0.0.12
> One-line summary: Added relocatable build support.
> Changes made:
> 
> -Added variable MF_BUILD, which allows the code to be built in a 
> directory other than the default.  To use, invoke:
>    gmake BOPT=g MF_BUILD=/tmp/esmf_build 
> This will build the library under "/tmp/esmf_build".  The object files,
> the library and the mod files will all be created under the new
> directory.
> 
> -Added an install target to makefile.  The variables MF_LIB_INSTALL
> and MF_MOD_INSTALL determine where the libraries and mod files are
> copyed during the install:  (e.g)
>    gmake BOPT=g MF_BUILD=/tmp/esmf_build MF_LIB_INSTALL=/usr/lib \
>    MF_MOD_INSTALL=/usr/mod install
> (Notice that once the MF_BUILD is used, it must be passed to the
> subsequent make commands).

The CAM Makefile was changed to set the MF_BUILD directory to $(MODEL_EXEDIR)/esmf.

The latest lf95 compiler (lf9561) required the following changes to the source code:

physics/cam1/{radae.F90,chemistry.F90} - removed save attribute in variable
declarations that were in the same scope as a save statement.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev25
Originator: eaton ( Brian Eaton)
Date: Tue Feb  5 12:04:52 MST 2002
Model: CAM
Version: CAM1.7.dev25
One-line Summary: remove prognostic sulfur cycle stubs
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC-Linux
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes made:

Only the interface to the prognostic sulfur cycle is being removed.  The
following independent features have not been removed: 1) a specified
sulfate aerosol distribution may be read from a dataset, 2) a ramp function
may be applied to the specified sulfate distribution, and 3) the indirect
radiative effects of sulfate aerosols may be estimated.

Modify files:
control/history.F90
control/initext.F90
control/parse_namelist.F90
control/restart.F90
dynamics/eul/inidat.F90
dynamics/fv/inidat.F90
dynamics/sld/inidat.F90
physics/cam1/advnce.F90
physics/cam1/initindx.F90
physics/cam1/inti.F90
physics/cam1/moistconvection.F90 - left icwmr in arg list of cmfmca.
physics/cam1/radctl.F90
physics/cam1/tphysac.F90
physics/cam1/tphysbc.F90
physics/cam1/tracers.F90
physics/cam1/zm_conv.F90
physics/ccm366/advnce.F90
physics/ccm366/initindx.F90
physics/ccm366/tracers.F90

Remove files:
control/acbnd.F90
control/clddiag.F90
control/dmsbnd.F90
control/drydep.F90
control/massbgt.F90
control/scyc.F90 - move the indirect flag into comctl.h.  Use this flag
                   directly rather than via the doindirect query method.
control/soxbnd.F90
control/sulbnd.F90
control/sulchem.F90
control/sulemis.F90
control/wetdep.F90

Misc:
  Change variable count to count1 in history.F90(wshist) to fix a problem
  with the pgf90 compiler.  count is the name of an F90 intrinsic function
  and apparently using it as a local variable was causing a problem.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev24
Originator: olson ( Jerry Olson)
Date: Thu Jan 31 17:06:44 MST 2002
Model: CAM
Version: CAM1.7.dev24
One-line Summary: modifications and bufixes to eulerian, sld, and physics
                  routines
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (IBM only)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Restart files change: no
Changes answers: EUL: no  (bit-for-bit; unless "DIVDAMPN" is used in namelist)
	         SLD: Yes (same-physics)
Changes to CLM land-model: None
Changes made: 

    bugfixes:
       - divergence damper in Eulerian code
	      src/dynamics/eul/hordif.F90
       - SLD energy fixer
	      src/physics/cam1/comsrf.F90
	      src/physics/cam1/physpkg.F90
	      src/physics/cam1/radctl.F90
	      src/physics/cam1/tphysbc.F90

    other mods
	- SLD vector-field advection routine
	      src/dynamics/sld/nunv1.F90
	- src/advection/sld/engy_tdif.F90
	- removed an option from idealized physics
	      src/physics/cam1/phys_idealized.F90
	      src/physics/cam1/tphysidl.F90
	- modified "test_trace3" tracer
	      src/physics/cam1/tphysac.F90
	      
===============================================================
===============================================================

cam1_7_dev23
Originator: sawyer ( William Barton Sawyer)
Date: Wed Jan 16 13:46:35 MST 2002
Model: CAM
Version: CAM1.7.dev23
One-line Summary: Upgraded fvCAM to newest mod_comm primitives
Requires change in build system: no
Substantial timing or memory changes: possibly faster
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman (mod_comm primitives)
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

	models/utils/pilgrim:

		removed bufferpack/unpack 2d,3d,4d primitives (in mod_comm)
		mod_comm.F90: added generic mp_send/recv primitives

	models/atm/cam/src/dynamics/fv

		cd_core.F90 d2a3dijk.F90  d2a3dikj.F90 dynpkg.F90  
		highp2.F90 hswf.F90 p_d_adjust.F90 te_map.F90  uv3s_update.F90

		replaced parbegin/endtransfer primitives with mp_send/recv
		primitives from mod_comm.  The only tricky part about this
		was determining the proper source and destination PE numbers:
		in the 2D decomposition this depends on the ordering of
		the mapping of the decomposition to the PEs (row-major or
		column-major).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev22
Originator: mirin ( Arthur Andrew Mirin)
Date: Tue Jan 15 14:49:36 MST 2002
Model: CAM
Version: CAM1.7.dev22
One-line Summary: Support history files for 2D FV decomposition
Requires change in build system: no
(one-line description of changes: Makefile, include files, directories, etc.)
(Detailed description below)
Substantial timing or memory changes: no
Requires change in run script: no
(one-line description of changes: data files, run-scripts, namelist etc.)
(Detailed description below)
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation:not-applicable
Changes answers: no (bit-for-bit)
(Note: test-model.pl only does checks this -- if you run it with the "-c" option)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

Changed history.F90, uv3s_update.F90 and restart_dynamics.F90.
Also changed CAM_lab.pm and script.m4.

Main changes were to history.F90, in order to support 2D FV decomposition.
The field_info structure was generalized to include a vertical extent. Support
for dynamics variables having global vertical extent 1, plev and plevp was added;
however, only tested variables had global extent plev. New coding supports 64-bit
accumulation buffers. 32-bit accumulation buffers are still not supported for
2D FV but are supported for 1D FV decomposition.

Previous coding had bug involving non-preservation of subscript array
range for associated pointers. That bug affected the hbuf_accum routines and
hbuf_compute_avg. Bug has been fixed; inside those routines relevant arrays
have beginning subscript equal to 1.

uv3s_update.F90 needed minor fix to properly call the history routine.

restart_dynamics.F90 had a minor bug involving 2D FV decomposition.

script.m4 (DAO) was given 1-line change involving ccm to cam transition.

CAM_lab.pm had 1-character change involving working directory on LLNL frost.




See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev21
Originator: sawyer ( William Barton Sawyer)
Date: Mon Jan  7 07:38:50 MST 2002
Model: CAM
Version: CAM1.7.dev21
One-line Summary: Merge of current DAO fvGCM FV dycore into CAM baseline: ghosting of variables, mod_comm for communication
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Linux
Ran test-model.pl script: no (test-model.pl -l dao not currently working)
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: n/a
Changes to CLM land-model: None (one-line description)
Changes made:

	Phase 2 of fvGCM-CAM fv dycore merge:  ghosted prognostic
	variables U3S, V3S, Q3.  Uses mod_comm for communication
	(as well as pilgrim).  More consistent use of "only" statement
	in "use" lines.  Upgrade of pilgrim (synchronized with DAO
	Chemistry Transport Model development) and mod_comm (should
	compile on Compaq now).  

	models/utils/pilgrim:

		pilgrim.h, parutilitiesmodule.F90, ghostmodule.F90:
			synchronized with DAO CTM development.
		mod_comm.F90 : should now compile on Compaq (sorry,
			not tested -- no access to a Compaq)

	models/atm/cam/src/control:

		history.F90: rather ugly code to support write of 
			ghosted U3S array.  Well be improved in later version.

	models/atm/cam/src/dynamics/fv

		prognostics : ghosted variables U3S, V3S, Q3

		cd_core.F90, trac2d.F90 : ghosting of U, V, Q3, replaced many
				pilgrim calls with mod_comm.

		benergy.F90, dryairm.F90, inidat.F90, restart_dynamics.F90
		map1_ppm.F90, d2a3dijk.F90, d2a3dikj.F90, dynpkg.F90,
		te_map.F90, fv_prints.F90, p_d_adjust.F90, dp_coupling.F90, 
		hswf.F90, uv3s_update.F90 :  accommodated ghosted variables.
		
		mod_mpi.F90 : retired (now uses mod_comm)

                dynamics_vars.F90 : new temporary unghosted variables as 
			interim solution for 2D decomposition redistributions.

 	        stepon.F90 : ghosted variable u3sxy


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev20
Originator: rosinski ( Jim Rosinski)
Date: Wed Jan  2 16:48:01 MST 2002
Model: CAM
Version: CAM1.7.dev20
One-line Summary: Mods to SOM: MLD renamed MLDANN on SST dataset., and contains
                  yearly values.  SPMD SOM indexing fix.  No resetting SICTHK,
                  SNOWH, TSSUB in SOMINI
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, PC
Ran test-model.pl script: no
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit) at least for non-SOM configurations
Changes to CLM land-model: None
Changes made:

NOTE: All changes are to slab ocean model (SOM) code.

o Changed name of mixed layer depths to MLDANN on SST boundary file
o Fixed indexing bug in SPMD mode (SOMINI, SOMINT)
o Removed code from SOMINI which reset SICTHK, SNOWH, TSSUB, ORO.

===============================================================

cam1_7_dev19
Originator: sawyer ( William Barton Sawyer)
Date: Thu Dec 27 07:47:01 MST 2001
Model: CAM
Version: CAM1.7.dev19
One-line Summary: FV core upgrade: Q3 indexing changed to (i,j,k,iq); no changes in order on history/restart files
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Art Mirin
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:

	Changed indexing of prognostic var. Q3 from (i,k,iq,j) to
	(i,j,k,iq) in FV dynamical core.  This change affected 
	numerous files in FV,

          cd_core.F90 fv_prints.F90 pmgrid.F90 stepon.F90
          dp_coupling.F90 inidat.F90 prognostics.F90 sw_core.F90
          dryairm.F90 mod_mpi.F90 restart_dynamics.F90 te_map.F90
          dynpkg.F90 p_d_adjust.F90 spmd_dyn.F90 trac2d.F90

        and one common file: src/control/history.F90.

	The section in history is protected by an "if ( dycore_is('LR) ) then"
	line (and is also embedded in an #ifdef STAGGERED CPP statement --
	does any other dycore use STAGGERED?)

	The order of Q3 on the initial/restart files has *not* changed.
	For the time-being there is logic to read and write Q3 in the
	original order.  This might change (in restart_dynamics.F90) later on.


	models/util/pilgrim/mod_comm.F90 has also been upgraded with
	new routines; which are not yet used by the FV core.  A code
	review/revision of these changes by Putman/Shen is pending.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev18
Originator: eaton ( Brian Eaton)
Date: Tue Dec 18 12:40:35 MST 2001
Model: CAM
Version: CAM1.7.dev18
One-line Summary: changes for share constants
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, pc/linux/pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: Erik, myself, and Mariana
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: Yes, new constants sometimes agree to only 2 digits with old ones.  This tag requires scientific validation.
Name of tests cases on NCAR Mass-Store: Erik will do production runs.
Changes to CLM land-model: Updated to clm2_3_dev10.
Changes made:

  Update CLM to clm2_3_dev10.

  The following changes were implemented by Erik and reviewed by me.

  Use values of constants from models/csm_share/shr_const_mod.F90 for
  consistency with other CCSM component models.  The changes are mainly in
  the physics/cam1/physconst.F90 module.

  Also changed some hard-wired constants in individual parameterizations:

  ocnsice/dom/srftsb.F90
  cmair = cpair             (was 1.00e3)
  cmice = shr_const_cpice   (was 2.07e3)
  rhair = shr_const_rhodair (was 1.25)
  rhice = shr_const_rhoice  (was 9.20e2)

  ocnsice/som/oceanconst.F90
  tof    = shr_const_tkfrz -1.9_r8  (was 271.26)
  rhoocn = shr_const_rhosw          (was 1.026e3) same
  cpocn  = shr_const_cpsw           (now 3.996e3, was 3.930e3)
  tsm = shr_const_tkfrz             (was 273.16)

  physics/cam1/cldwat.F90
  rhonot = rhodair/1000.   (was 1.275e-3)
  t0 = tmelt                         (was 273.16)
  replace hard-wired 273.16 with t0

  physics/cam1/esinti.F90
  pass tmelt as an arg

  physics/cam1/gffgch.F90
  replace hard-wired 273.16 with tmelt

  physics/cam1/radae.F90
  amd = mwdry           (now 28.966, was 28.9644)

  Made some interface changes to provide initialization routines for
  setting constants in parameterizations.

  Moved routines for water vapor pressure calcs into new wv_saturation
  module.

  Moved routines for shallow convection into moistconvection module.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev17
Originator: sawyer ( William Barton Sawyer)
Date: Tue Dec 18 07:25:41 MST 2001
Model: CAM
Version: CAM1.7.dev17
One-line Summary: Bug fix of mod_comm library for AIX and Linux
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, Linux
Ran test-model.pl script: no
Tested on fv dynamics: yes
Tested on eul dynamics: no
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: no
Tested that different domain decompositions match bit-for-bit: no
Tested in adiabatic mode: no
Code reviewed by: myself, Shen
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: N/A
Changes to CLM land-model: None 
Changes made:

	models/utils/pilgrim:  memstuff.c, mp_assign_to_cpu.c mod_comm.F90

	Minor bug fixes to get mod_comm to compile and run on AIX and Linux

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev16
Originator: sawyer ( William Barton Sawyer)
Date: Mon Dec 17 03:19:29 MST 2001
Model: CAM
Version: CAM1.7.dev16
One-line Summary: FV dycore improvements: mod_comm comm. library; more support for 2D decomposition
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: SGI
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Putman, Lin
Updated the DatasetLog (for new input data-files): no
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: N/A
Changes to CLM land-model: None
Changes made:

	model/utils/pilgrim: 

		mod_comm.F90: optimized comm. library (Lin, Putman, Shen)
		memstuff.c:   related utilities for MLP parallelism
		mp_assign_to_cpu.c:  CPU pinning utility (MLP and MPI modes)

	model/atm/cam/bld

		CAM_lab.pm: improvements for -l dao
		configure_fv.pl, script.m4: Additional support for 2D decomp.

	model/atm/cam/src/dynamics/fv

		benergy.F90, cd_core.F90, dynpkg.F90, geopk.F90, 
		hswf.F90. prognostics.F90, restart_dynamics.F90,
		spmd_dyn.F90, stepon.F90, te_map.F90:

			Phase 1 of transition to mod_comm library,
			mod_mpi replaced by mod_comm in cd_core.F90.
			Variable PT ghosted throughout various routines.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev15
Originator: rosinski ( Jim Rosinski)
Date: Thu Dec  6 11:47:59 MST 2001
Model: CAM
Version: CAM1.7.dev15
One-line Summary: Add per-tape averaging flag.  Delete inlining for SGI
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, PC
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no or Yes or not-applicable
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None
Changes made:

o Added namelist option avgflag_pertape. Usage ex: if set avgflag_pertape(2) = 'I', 
  all fields on history file 2 will by default be instantaneous.  Can still
  be overridden (for example) with fincl2 = 'T:A'

o Deleted inlining for SGI (a mod to bld/Makefile). Inlining slowed compilation 
  down by 60% and resulted in zero or negative speedup.  Could also delete for
  other machines, but Makefile mods, compilation time and execution time effects
  of including inlining were not nearly as obnoxious as on SGI so left alone for now.

o Added addfld call for NSTEP. Writing this field to history file is often useful 
  for diagnosing mods to history.F90.  By default this field is not written.

o Moved dycore print from parse_namelist.F90 to cam.F90

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev14
Originator: mvertens ( Mariana Vertenstein)
Date: Tue Dec  4 09:08:53 MST 2001
Model: CAM
Version: CAM1.7.dev14
One-line Summary: put in esmf calendar manager into clm2
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, erik
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation:  Yes (for clm2 only)
Changes answers: On utefe(sgi) and prospect (compaq) the result were
bfb when running test-model.pl with the -c option. On the ibm,
the changes were roundoff compared with cam1_7_dev13 when running with
the esmf libO version and bfb when running with the esmf libg version
(differences only appeared after 98 times steps and were due to
roundoff differences in the computation of the calendar day)
Changes to CLM land-model: Yes

1) Put in the esmf time manager into clm2 
   Brought cam code up to date with clm2_3_dev6.
   Only clm2 code was changed. 

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
	
===============================================================

cam1_7_dev13
Originator: eaton ( Brian Eaton)
Date: Sun Dec  2 15:54:13 MST 2001
Model: CAM
Version: CAM1.7.dev13
One-line Summary: make history files conform to CF metadata conventions
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, linux-pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Changes are all in history.F90 except for some units changes in addfld
  calls in gw_drag.F90.  The modifications are:
  .Fix units attributes.
  .Fix convention attribute.
  .Fix description of hybrid vertical coordinates.
  .Write all coordinate variables as type double.
  .Fix description of time averaged values.
  .Add time interval boundaries.
  .Remove _FillValue attribute for variables on a full grid.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev12
Originator: eaton ( Brian Eaton)
Date: Thu Nov 29 19:08:09 MST 2001
Model: CAM
Version: CAM1.7.dev12
One-line Summary: update ESMF lib to MF_LLU_0_0_11p3
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, sun, linux/pgf
Ran test-model.pl script: yes
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: David Neckels
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Update the ESMF library from version MF_LLU_0_0_11p2 to MF_LLU_0_0_11p3.
  Date increment incorrectly normalized itself when on the first month of the
  year.  The time management increment function did not completely construct
  itself.  These bugs were uncovered during unit testing of the ESMF library
  by David Neckels.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev11
Originator: mirin ( Arthur Andrew Mirin)
Date: Wed Nov 28 23:02:45 MST 2001
Model: CAM
Version: CAM1.7.dev11
One-line Summary: Changes for multi-2D decomposition for FV dycore
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Sawyer
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: Yes (minor roundoff differences in FV dycore routine te_map.F90)
(Note: test-model.pl only does checks this -- if you run it with the "-c" option)
Name of tests cases on NCAR Mass-Store: (For changes that change answers)
Changes to CLM land-model: None (one-line description)
Changes made:
Changed 13 files in dynamics/fv; most changes were fairly minor.
Changed control/spmdinit.F90.
Changes 3 files in physics/cam1, to allow more general chunking. These changes were actually made by Pat Worley.
Changed 2 files in Pilgrim (minor).
Added batch capability for test-model.pl for LLNL IBM Frost.
Minor change to CAM_lab.pm for LLNL Frost.
Minor changes to DAO scripts configure_fv.pl, script.m4.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev10
Originator: mvertens ( Mariana Vertenstein)
Date: Mon Nov 26 08:32:45 MST 2001
Model: CAM
Version: CAM1.7.dev10
One-line Summary: changed mpi distribution of subgrid patches in clm2
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq 
Ran test-model.pl script: yes (does all of the following tests)
On Compaq only tested eul dynamics
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit) 
Ran test-model.pl with -compare optio
Changes to CLM land-model only: 
Brought cam code up to date with clm2_3_dev4
1) changed the distribution of subgrid patches among processors
   so that patches for a given land point must all be on the same processor
2) changed all mpi gather/scatter calls to mpi gatherv/scatterv calls
   and introduced subroutines to determine the asymmetric vector lengths
3) Put in CF1.0 conventions into clm history file
4) removed rtm_doavg from namelist - rtm averaging is now done
   if rtm_nsteps is set to greater than 1 (this does not appply
   to cam model unless cam is run with RTM - by default this is
   not the case)	
	
See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev9
Originator: erik ( Erik Kluzek)
Date: Wed Nov 21 16:02:10 MST 2001
Model: CAM
Version: CAM1.7.dev9
One-line Summary: Get coupled model to work, update to scripts_a011121 
	and bld_b011121
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: Yes! (IBM only)
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Terminate string in clm_csmMod.F90 so would compile.
Changes made:

Make changes needed to get CAM to work with coupled with CCSM. Update models/bld
to bld_b011121, and scripts/test.a1 to scripts_a011121. Run csm.csh on babyblue
to make sure would work. Also ran on utefe, but lnd.setup.csh failed due to
a "getdata" problem, the compile of CAM was successful however. Update "csm.csh"
coupled version to ccsm2_0_beta26.

Change ccsm_msg.F90 to use time_manager to get nstep (from Lawrence Buja).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev8
Originator: eaton ( Brian Eaton)
Date: Wed Nov 21 08:47:35 MST 2001
Model: CAM
Version: CAM1.7.dev8
One-line Summary: add perpetual calendar option to time manager
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, pc-linux, sun
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): no
Updated the documentation: Yes
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

Add namelist variables to enable perpetual calendar:

logical perpetual_run - Set to .true. to specify that a perpetual run is
                        being done (default is .false.).  If perpetual_ymd
                        is not set then read the perpetual date from the
                        initial file.

integer perpetual_ymd - Perpetual date specified as (year*1000 + month*100
                        + day).  This overrides value from initial file.

If aqua_planet=.true. then the values of perpetual_run and perpetual_ymd
are ignored.  aqua_planet mode uses a perpetual date of 321.

Modify files:

control/time_manager.F90 - add perpetual_run, perpetual_ymd to public data.
add is_perpetual method to indicate that perpetual calendar is in use.
Modify internal logic so that perpetual calendar doesn't depend on
aqua_planet mode.  Add an optional argument to specify an offset in the
get_curr_date method (needed by the CLM).

control/parse_namelist.F90 - add perpetual_run, perpetual_ymd.

Modify code in the following files to use the perpetual date when
interpolating boundary datasets if perpetual calendar is in use.
control/initext.F90
control/oznini.F90
control/oznint.F90
control/so4bnd.F90
dom/sst_data.F90
physics/advnce.F90
physics/chemistry.F90
physics/tphysac.F90

Misc:
control/initext.F90 - There was code in a #ifdef COUP_CSM section that was
nested inside a #if (!defined COUP_CSM) section.  Remove this code which
wasn't being executed anyway.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev7
Originator: eaton ( Brian Eaton)
Date: Fri Nov 16 17:35:37 MST 2001
Model: CAM
Version: CAM1.7.dev7
One-line Summary: update ESMF library
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, pc, sun
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and David Neckels
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

  Update the ESMF library from version MF_LLU_0_0_11 to MF_LLU_0_0_11p2.
  This includes bugfixes for the mfm_datedecrement and mfm_timemgrlaststep
  functions.


See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev6
Originator: erik ( Erik Kluzek)
Date: Fri Nov 16 09:37:28 MST 2001
Model: CAM
Version: CAM1.7.dev6
One-line Summary: Update ESMF to MF_LLU_0_0_11, change test-model.pl interface, 		fix problem with run-model.pl
Requires change in build system: Yes
(Changed Makefile on sun to be compatable with new ESMF)
(Changed Makefile for Linux-PGF90 so sgexx.F doesn't get compiled with -fast)
Substantial timing or memory changes: no
Requires change in run script: Yes (run-model.pl scripts need to use 
   setup_directories( "support" )
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, Sun, Linux-PGI (NERSC-IBM, ORNL-IBM)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF: Update to MF_LLU_0_0_11
Changes made:

ESMF Update:

	Get newer version of ESMF library. This fixes a problem with calculating
the ending date (which fixes a problem that the CLM had in writing out restart
files at the end of the run). It also fixes problems in building on several
platforms. The previous version did not build on the DAO SGI (tropic) for 
example.

Makefile changes:

	SUN: Use -dalign for DEBUG, and otherwise -fast to be compatable
	with the new version of ESMF.

	Linux-PGF90: Set to compile sgexx.F withotu -fast, so that SLD 
	simulations won't hang.

run-model.pl change:
	Change so that CAM_run.pm sets up a directory to build makdep in
	like test-model.pl does. This allows run-model.pl to use the same
	source directory, but submit to different machines simultaneously.
	The change requires the setup_directories( "support" ) method to
	be called from run-model.pl type scripts.

test-model.pl changes:

	Change interface from mixed short names like "-l" and "-nofail" to
consistent longer names: "-lab", "-compare", "-help" etcetera.

	-l     ==> -lab
	-c     ==> -compare
	-h     ==> -help
	-t     ==> Eliminated you now get the list of test from -help
	-r     ==> -resume
	-dirty ==> -noclean
	-e     ==> -errgro
	-s     ==> -skip

For backwards compatability, -l, -c, -r, -e, and -s are still allowed, although
the longer names are prefered.

ornl: Change default CASE_DIR to a GPFS directory so that builds will work.
llnl: Change default SPMG_CMND depending on whether machine has prun or dmpirun.
      Will now automatically detect which exists and use the one that works.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev5
Originator: eaton ( Brian Eaton)
Date: Tue Nov 13 10:19:40 MST 2001
Model: CAM
Version: CAM1.7.dev5
One-line Summary: makefile changes for ESMF library build
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq, PC/linux-pgf
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself and Erik 
Updated the DatasetLog (for new input data-files): no
Updated the documentation: no
Changes answers: no (bit-for-bit)
Name of tests cases on NCAR Mass-Store:
Changes to CLM land-model: None
Changes made:

Modified the CAM Makefile to prevent unnecessary rebuilding of the ESMF
library.

The ESMF Makefile has been improved (by David Neckels) to include support for
more Fortran compilers under Linux, and to allow simultaneous builds of the
library from different platforms with access to the same source on a shared
filesystem.  There is also a README file for the ESMF build in
top_dir/models/utils/esmf/README.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev4
Originator: erik ( Erik Kluzek)
Date: Fri Nov  9 11:44:51 MST 2001
Model: CAM
Version: CAM1.7.dev4
One-line Summary: Fix problem with run-model.pl, add condense-path utility, 
	update ESMF to MF_LLU_0_0_10p1
Requires change in build system: no
Substantial timing or memory changes: no
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI, Compaq (partial tests on Linux and Sun)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Known problems: SOM test fails on AIX, LSM/phys366 test fails on Linux
	SLD test 3 (in test-model.pl) hangs on Linux-PGf90
Code reviewed by: myself, Brian Eaton
Changes answers: no (bit-for-bit)
Changes to CLM land-model: None
Changes to ESMF: Update to MF_LLU_0_0_10p1
Changes made:

Fix path problems with run-model.pl

	Add a condense-path.pl utility to shorten pathnames with "/.." in them.
This is important since the longer directory names of CAM and the multiple
levels cause line length problems when building.

test-model.pl: Turn SOM test on for all platforms but AIX

	Let the SOM test happen for all platforms except the IBM where it fails.
Once this is fixed we should re-enable it.

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

cam1_7_dev3
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Nov  7 13:00:31 MST 2001
Model: CAM
Version: CAM1.7.dev3
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: no
Tested to work coupled with CCSM: no
Machines tested: IBM
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: no
Tested on eul dynamics: yes
Tested on sld dynamics: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers: no (bit-for-bit) 
Simulations:
		/ERIK/csm/eul17dev3_a ---- 5 year simulation with 
		PCMDI climatological SST's
Changes made:
	
1) put in restart consistency checks between cam and clm2
   i.e ensure that both models restart with same time step

===============================================================
===============================================================

cam1_7_dev2
Originator: mvertens ( Mariana Vertenstein)
Date: Wed Nov  7 10:16:12 MST 2001
Model: CAM
Version: CAM1.7.dev2
One-line Summary: Put in three clm2 bug fixes that change answers
Requires change in build system: no
Substantial timing or memory changes: no 
Requires change in run script: Yes
  CLM2 namelist must have the following changes:
  1) fpftcon = $LM_DATDIR/pftdata/pft-physiology-vegdyn-cleanup-ratio
  2) remove mksrf_firr from namelist
Tested to work coupled with CCSM: no
Machines tested: IBM, SGI
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Erik Kluzek
Updated the DatasetLog (for new input data-files): not-applicable
Updated the documentation: not-applicable
Changes answers:  Yes (new-physics - bug fixes)
Changes to CLM land-model: YES
Changes made (CLM2 code):
Put in changes from clm2_2_12, clm2_2_13, clm_2_14	
	
clm2_2_12:
1) Update to clm2 changes from CCM3.12.62, from Brian Eaton 
   "Use public data and methods from time_manager mod for initialization."
	
clm2_2_13:
1) cleaned up pft physiology file and related code 
   removed anything related to biogeochemistry when DGVM is off (not defined)
2) used ratio of roughness length and displacement height to canopy top height
   instead of actual values for roughness lenght and displacement height
3) fixed openmp bug in RtmMod.F90
4) fixed branch bug in AccumulMod.F90
5) fixed DGVM bug in Fire.F90
	
clm2_2_14:	
The clm2 code in this tag is clm2_2_14 with Erik's cam1_7_1 mods
where ccm->cam in various files min the clm2/main directory	
1) (Biogeophysics_Lake.F90) - Fixed bug in lake model where latent heat of
   fusion was being used (incorrect) instead of latent heat of sublimation
   (correct).
   Also Fixed two "problems" noticed in the b202.20.0 simulations: 
2) (CombineSnowLayers.F90) -  Global water and ice contents in the 
   top soil layer were increasing with time. Eliminated ponding in 
   wetlands by assigning snow melt to runoff.
3) (SurfaceRunoff.F90) - Eliminated formation and growth of basal ice layer 
   beneath snow cover by assigning snow melt reaching impermeable ground 
   surface to surface runoff. 
   The above three fixes were tested by examining output from several single
   point and 21-year standalone simulations. No trends in surface soil
   water and ice were noted. Lake bug fix has small effects on surface
   fluxes from grid cells with lakes that have snow cover.
4) Put in volr in initial dataset
5) Put in restart id tag on restart file for consistency -
   if restart file is modified, the parameter rest_id in restFileMod.F90
   must be updated.
6) Set maximum number of auxillary history files to 2 to be
   consistent with parameter settings.

===============================================================
===============================================================

cam1_7_dev1
Originator: erik ( Erik Kluzek)
Date: Wed Nov  7 09:11:22 MST 2001
Model: CAM
Version: CAM1.7.dev1
One-line Summary: Move from CCM to CAM, mask error-growth problems by not 
	letting CLM see snowfall, Change build
Requires change in build system: Yes!
	(Change COUP_CCM to COUP_CAM for CLM, Makefile uses Rootdir file for
	ESMF build, ESMF build is done from within Makefile, directory 
	structure different)
Substantial timing or memory changes: no
Requires change in run script: Yes!
	(namelist is now camexp instead of ccmexp, input data files directory
	changed, Env variable for datasets is now $CSMDATA)
Tested to work coupled with CCSM: no (need to update CCSM build for ESMF)
Machines tested: IBM, SGI, Compaq, Sun, Linux-PGF90
	(SOM test fails on IBM, LSM/PHYS366 test fails on Linux)
Ran test-model.pl script: yes (does all of the following tests)
Tested on fv dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Code reviewed by: myself, Mariana Vertenstein, Brian Eaton (som changes)
Updated the DatasetLog (for new input data-files): no (but need to)
	Did create 26 level T21 datasets for testing, and got test-datasets
	at T42L18 for SOM
	(new datasets at ftp.cgd.ucar; cd pub/erik; 
         get cam1_7.scidac-atm.datasets.tar.gz)
Updated the documentation: Yes (first pass at changes from CCM to CAM)
Changes answers: no (bit-for-bit)
Changes to CLM land-model: Yes (COUP_CCM to COUP_CAM, nix references to ccm)
Changes made:

Change references from CCM to CAM.

datafiles: ccmr and ccmi files are now camr and cami
filenames: ccm3, conv_ccm, ccmoce, are now cam, conv_cam, camoce
lnd filenames: ccm_lndMod, lnd_ccmMod, are now atm_lndMod, and lnd_atmMod
CPP Tokens: COUP_CCM is now COUP_CAM
Directory structure: New directory structure compatable with the "cam1"
	cvs module rather than the "ccm" cvs module.
Other references in code and comments to CCM were changed to CAM.

New build:

	Build changed to create a Rootdir file with the top level directory
of "cam1". This is used by the Makefile to figure out the location of the ESMF
directory. The Makefile then builds the ESMF library directly from the 
Makefile. This new build system comes from David Neckels via Brian Eaton.
It is a much easier more robust way of building the model. The env variable 
DYNAMICS for Lin-Rood should now be set to "fv" in agreement with the new directory name. For the SUN take out the "-fast" option to be compatible with the
ESMF library build (put this back in when ESMF build is updated).

Run scripts:

Run scripts use "CSMDATA" instead of MODEL_DATDIR. AM_DATDIR, and LM_DATDIR 
env variables removed. New directory structure for cam with subdirectories
for: inic, ggas, rad, hrtopo, ozone, scyc, and sst for initial conditions, 
greenhouse gas, radiation, high-resolution topography, ozone, sulfur-cycle
and sea surface temperatures respectively. The environment variable OCEAN
was added to refer to the ocean model to use "dom" or "som". The env variable
PHYSICS now either should be "cam" or "ccm366" to refer to the type of physics
used.

Error-growth problem:

	Mask the current error-growth problem to some extent by only letting
CLM see rain and not snowfall. Error-growth for FV still seems to be large.

Remove Sulfur-cycle codes:

	Remove the sulfur-cycle codes (they are still accessible on the 
cam_brnch_scyc branch and with the cam1_scyc module). In their place the
dummy stubs from dscyc were put into the control directory. Eventually, we
will rip these out of the main development and only leave them on the 
sulfur-cycle branch.

Changes to test-model.pl:

	Change vertical resolution of the sld and eul tests to 26, in agreement
with the vertical resolution used for production simulations (the difference
in vertical resolution can have an impact on how changes to physics are 
perceived). Remove "-clean" option and make cleaning old directories out the
default, add the option "-dirty" to not clean files before the build. 

Users Guide:

	Users Guide now part of the distribution, first pass on moving from
CCM3.12 to CAM was completed. Namelist documentation is up to date, directory
structure is outlined. Further updates should update documentation at the
same time that code is changed.

SOM:

	SOM now part of the distribution, SOM was updated to use the new 
timing routines. "test-model.pl" has a test for SOM that is currently commented
out since it doesn't run on the IBM (does complete on other platforms however).

See: 	http://www.cgd.ucar.edu/cgi-bin/cms/ncar_only/view_change_file.cgi?ChangeLog
	for latest version of this file on the web.
===============================================================
===============================================================

ccm3_12
Originator: erik ( Erik Kluzek)
Date: Wed Jun 13 11:35:28 MDT 2001
Model: CCM
Version: CCM3.12
One-line Summary: New H2O LW abs/ems, geo-potential, precip evap, cloud-water changes, no oro-drag over ocean
Requires change in build system: no (but, Makefile updated for in-lining, see below)
Substantial timing or memory changes: no
Requires change in run script: Yes (New abs_ems_dataset, see below)
Tested to work coupled with CSM: Yes (IBM and SGI)
Machines tested: IBM, SGI, Compaq, Sun, Linux (see below)
Ran test-model.pl script: yes (does all of the following tests)
Tested on lr dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: yes
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: no (but need to)
Changes answers: Yes (new-physics)
Name of tests cases on NCAR Mass-Store:
	/JET/csm/zm31139evap06 ---- Climatological SST's T42L26, Eulerian dynamics
	/JET/csm/amipevap06 ------- AMIP2 SST's T42L26, Eulerian dynamics
	/JET/csm/amipevap06_3h ---- Daily output same as above.
	/CCSM/csm/b202.02 --------- Coupled simulations, T42L26, Eulerian dynamics	
Changes made:

IMPORTANT: Problems on SUN, and Linux, problems on batch submission to: 
           blue, eagle, gseaborg (see below). Need new datasets (see below).
----------------------------------------------------------------------------
Physical changes:
	Precipitation evaporation: 		J.J. Hack.
	Cloud water changes for mid-atm.:	P.J. Rasch
	LW water-vapor abs/ems changes: 	W.   Collins
	no orographic drag over ocean: 	B.B. Boville
	fix to geo-potential:		B.B. Boville

Land-model:
	Tested with both LSM1 and CLM2 land-models (see below). CLM2
	was updated to CLM2.1.20.
Interface changes:
	Makefile changed so that in-lining is done.
	radems/radabs became a module.
	LINUX CPP token changed to Linux (so you can use uname -s)
	Block data removed (except for phys366).
	Check that ORO is valid from IC file.
Testing:
	Code was tested both on many NCAR platforms and several off-site 
	platforms as well. test-model.pl was primarily used to validate 
	that the model started/restarted for all dynamics as well as 
	both the "physics" and "phys366" physics directories and "lsm1" 
	and "clm2" land models.  It also verified that restarts give exact 
	answers to the history files (both average and instant values), 
	and that changing the decomposition gives the same answers and 
	that SPMD and non-SPMD gives the same answers. It also checks 
	that the code can run with bounds checking on (on Sun and Linux), 
	and with the compiler initializing variables to indefinite.

	CCSM tests run ccm/test/csm.csh to ensure that the model works 
	with the CCSM coupler.  This version of the model works with 
	ccsm2_0_beta11.

Machine		lsm1-physics	CCSM	clm2-physics	clm2-phys366	lsm1-phys366
babyblue(aix)		X	X	X		X		X
blackforest(aix)	X	X	 		 		 
gseaborg(aix)		X
eagle(aix)		X
blue(aix)		X
longs(PC)		X		X				X
prospect(osf)		X		X		X		X
compass(osf)		X
utefe(sgi)		X	X	X				X
tropic(sgi)		X		X				X
sanitas(sun)		X		X				X

Error growth:
	The error-growth is faster than the previous model, especially 
	SLD but, it was deemed acceptable. HOWEVER, 
	THE ERROR-GROWTH ON THE SUN IN COMPARISON TO THE IBM IS 
	UNACCEPTABLE. Until this is fixed the Sun should not be 
	used for simulations.

Script changes: 
	test-model.pl was made more robust. Tests
	to compare SPMD non-SPMD were added and to check both avg
	and instant history files for restart tests, and new 
	input options added:

	set the env variables:

	LANDMODEL --- to define whether to use LSM1 or CLM2
	PHYSICS ----- to define whether to use "phys366" or "physics".

	skip option (-s) now allows an end-point and allows resolution
	to be specified. So

	-s eul:3-5:T42L26

	Will run tests 3-5 with Eulerian dynamics at T42 and 26 levels.

	Error-growth option. To do a port validation you can validate
	against a given trusted machine. To do this use something like:

	-e "blackforest.ucar.edu(aix)"

	This assumes you already ran test-model.pl on blackforest (and
	left everything in the standard locations). Then the "errg*.cprout"
	files will contain a comparison to the above machine.

New datasets:
	Bundle of datasets needed to run the model and use "test-model.pl".

		ftp.cgd.ucar.edu; cd pub/erik; bin; 
		get ccm3.12.acpi-atm.datasets.tar.gz

	abs_ems_factors_fastvx.052001.nc --- Required for use with 
						the new LW code.
	clm datasets  ---- 	In order to run with clm2.
	fv.4x5L18 -------- 	4x5 degree resolution dataset with 18 levels 
				for LR dynamics from Sharon Nebuda.
Known-Bugs:
	Linux: S.-J. had trouble with 10x15 on Linux with LR and the 
		Portland group compiler. I had trouble with Linux at 
		2x2.5 with LR.
	Sun: 	Error-growth was bad. Ran out of memory at some resolutions, 
		especially when doing SPMD, or when using CLM2.
	Batch: Had trouble with batch submission on the IBM-SP machines: 
		blue, gseaborg, and eagle.  Interactive, didn't have the 
		same trouble, so I'm unclear why this is the case.
	test-model.pl: When using "-s all:" option you can't give an 
			end-point or it will only run for the first dynamics.
Changes since CCM3.11:
	Many enhancements, bug-fixes, and progress on 2D-decompostion to LR
	dynamics. Update to F90 and initial Protex pass for LR.
	Replace Rayleigh friction with 1st order upwind transport.
	Revised mapping algorithm near the surface for winds.

	slaveio namelist item removed.  Namelist variable "IDEALDYN" 
	changed to "IDEAL_PHYS"	

	Support for Lahey and Fujitsu compilers on Linux. Work on chunking. 
	Columns given by phys_grid methods.  timing library added.
	Ability for bounds-checking added. FORTFFT cpp parameter deleted
	use USEFFTLIB if library available.  SPMD now doesn't require that 
	the number of MPI tasks evenly divide into the number of latitudes.

	History modularized. Progress on physics/dynamics split. Restart
	dyanmics and physics split out better.  Sulfur-cycle codes fixed.
	SLD energy fixer added.

	phys366 and clm2 directories added. Generic interface to both 
	land-models.

	Options added to scripts: PHYSICS, LANDMODEL, tests to run.
	NO_SWITCH option for LLNL Compaq. "-clean", "-nofail" and "-t"
	options added. Fix interpic for multiple times if available in file.

===============================================================
===============================================================

ccm3_11
Originator: erik ( Erik Kluzek)
Date: Thu Dec 21 16:22:20 MST 2000
Model: CCM
Version: CCM3.11
One-line Summary: New LW absorption,new vertical diffusion,SLD energy fixer,
	scripts,Lin/Rood fixes,split dynamics
Requires change in build system: yes, new build system, use 26 level model
Tested on lr dynamics: yes
Tested on eul dynamics: yes
Tested on sld dynamics: yes
Tested to work coupled with CSM: no
Tested that restarts are bit-for-bit: yes
Tested multiple constituents: yes
Tested that different domain decompositions match bit-for-bit: yes
Tested in adiabatic mode: no (currently broken)
Substantial timing or memory changes: no
Machines tested: IBM, SGI, Sun, PC
Requires change in run script: yes
	(New namelist parameter: absems_data)
	(New namelist parameter for Lin-Rood: nsplit)
	(New namelist parameter: empty_htapes)
	(New namelist parameter: aqua-planet)
	(New build/run environment provided)
	(Need to use new 26 level datasets)
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: no (will need to though)
Changes answers: Yes (improved physics)
Name of tests cases on NCAR Mass-Store: See CCM3.10.60 below
Changes made:

Physics changes from CCM3.10:

	New LW absorption of water vapor as per Dr. William Collins.
	New vertical diffusion on dry static energy as per Dr. Byron Boville.
	Energy fixer for SLD from Dr. David Williamson and Jerry Olson.
	Many bug-fixes to Lin/Rood dynamics.
	Many routines migrated to modules.

New build run environment provided:

	A completly new set of scripts provided to configure, build, and
	run the model. Also a test script provided for testing before
	committing code changes.

	A script provided to help with the process of interpolating and
	creating new initial condition datasets.

Code changes:

	Work to split dynamics and physics better.
	Initial work on 2D decomposition.
	Open MP works on PC.
	More platforms supported with LR.
	Add version, revision_id to history files.
	Fix floating point trapping on Compaq.
	Various bug-fixes.

===============================================================
===============================================================

ccm3_10
Originator: erik ( Erik Kluzek)
Date: Tue Jun 20 08:35:26 MDT 2000
Model: CCM
Version: CCM3.10
One-line Summary:	Update code to F90 and coding standard, 
			optimize radcsw, fix bugs, new LR core,
			Finish reduced grid tools
Requires change in build system: no
Tested on lr dynamics: Yes
Tested on eul dynamics: Yes
Tested on sld dynamics: Yes
Tested to work coupled with CSM: Yes
Requires change in run script: Yes (requires I/C files with LANDM)
Updated the DatasetLog (for new input data-files): Yes
Updated the documentation: Yes
Changes answers: Yes (different climate)
Name of tests cases on NCAR Mass-Store: 	/JET/csm/ccm3911 	 (full grid Eulerian)
						/ROSINSKI/csm/ccm3911_r1up (reduced grid Eul)
Changes made:

	Double tagged as CCM3.9.28.

	Update code to F90 free-form and coding standard.
	New optimized version of radcsw. Fix bug with CSM with flxave on. Fix bug
	with first time-step on Eulerian. Get offline tools to work with reduced
	grid and L/R dynamics. Change so LANDM is calculated in offline tool rather
	than inside model. Update L/R to new version, add "precision" changes. Fix
	Linux Makefile for F90 files. Fix bug with SLD and hortal smoothing and hordif. 
	Fix problems with SLD on Sun, IBM and Compaq. Fix PHIS filter bug.

===============================================================
===============================================================

ccm3_9
Originator: erik ( Erik Kluzek)
Date: Thu Apr 27 15:04:53 MDT 2000
Model: CCM
Version: CCM3.9
One-line Summary: New cloud overlap, reduced grid option, addition of Lin-Rood dynamics.
Requires change in build system: Yes 
Requires change in run script: Yes
(New options for reduced grid, or Lin-Rood)
Updated the DatasetLog (for new input data-files): not-applicable
Updated the CCM development schedule: no
Updated the documentation: Yes
Changes answers: Yes (new-climate)
Name of tests cases on NCAR Mass-Store: /JET/csm/bill30e
Changes made:

	Added new cloud overlap assumptions from Bill Collins (random overlap when gap 
	between clouds in column, maximum overlap when clouds exist in both adjoining
	layers).

	Added the reduced grid option from Dave Williamson.

	Added Lin-Rood dynamics as a new dynamics configuration.

	Output cleanup. Code cleanup. Two default output streams monthly and daily
	files.

	Support IBM and Compaq. Will compile/run on Cray, but radiation changes
	(which are highly scalar) make it run very slow. Cray will no longer be
	supported.

	Atmosphere determines partitioning of rain/snow.

	SPMD mode now works. Support hybrid SPMD/OMP memory running on IBM, Compaq.

===============================================================
===============================================================

ccm3_8
Originator: rosinski ( ROSINSKI JIM 1397 ML CGD)
Date: Fri Aug 20 11:24:07 MDT 1999
Model: CCM
Version: CCM3.8
One-line Summary: Merged netcdfhtape branch to trunk
Requires change in build system: Yes.  makdep now required.  New Makefile
Requires change in run script: Yes.  Namelist changes.
Run through comtest.spectral.csh and comtest.sld.csh: Yes
Run through csm.test.nqs: no
Updated the DatasetLog: no
Changes answers: no (bit-for-bit)
Changes made:

	o Model now writes netcdf history tapes.
	o Requires f90 compiler since modules and allocatable arrays are
	  used.  Code now should be fully f90-compliant.  No more Cray 
	  pointers or user-defined Fortran interfaces to malloc.
	o Cloud water is a non-advected tracer as opposed to advecting it
	  and throwing away the results of the advection (mvertens).
	o Model at least runs on IBM.  Have not done error growth analysis.
	o Moved time filter and mass fixer to scan2.  This became possible
	  with the time-split physics.
	o Precision now specified in code rather than relying on vendor flag
	  (e.g. -r8). This change has not yet been put in the library code 
	  (e.g. ecmfft), so -r8 flag (or equivalent) is still needed for 
	  these files.
	o Build procedure now REQUIRES use of the makdep routine provided
	  in tools/makdep.  The reason is that no standard UNIX tool I
	  know of can provide the full dependency analysis needed.
	o Eliminated out-of-core option.  History, radiation, and main
	  model buffers are now modules.  Integer pointers to buffer
	  locations are gone, as are /comgrd/ and points.F
	o Namelist changes:

old namelist                              new namelist
------------                              ------------

 &CCMEXP                                    &CCMEXP
 nlfilt   ! write extra time sample------>  <gone>
          ! to 1st volume
 stfnum   ! starting file number--------->  <gone>
 incorrad ! abs/ems in core-------------->  <gone>
 incorbuf ! model buffer in core--------->  <gone>
 incorhst ! history buffer in core------->  <gone>
 ndens = [1,2, or 4] ! packing density--->  ndens = [1 or 2]  ! double or float
 primary = 'T', 'Q',...------------------>  fincl1 = 'T', 'Q',...
 auxf    = '1', 'T', 'Q',...,------------>  fincl2 = 'T', 'Q',...
           '2', 'V', 'U',...------------->  fincl3 = 'V', 'U',...
 exclude = 'PS','PHIS',...--------------->  fexcl1 = 'PS','PHIS',...
 <didn't exist>-------------------------->  fexcl2 = 'CMFMCA','SOLIN',...
 <didn't exist>-------------------------->  xzy = [T or F] ! non-coords order
 /                                          /


===============================================================
===============================================================

ccm3_7
Originator: erik ( Erik Kluzek)
Date: Fri May 28 13:38:40 MDT 1999
Model: CCM
Version: CCM3.7
One-line Summary: Prognostic cloud-water and sulfur cycle
Requires change in build system: Yes 
(new directory scyc)
Requires change in run script: Yes
(need to use readtrace=.F. and cldw_adv=.T.)
Run through comtest.spectral.csh and comtest.sld.csh: Yes
Run through csm.test.nqs: Yes
Updated the DatasetLog (for new input data-files): Yes
Changes answers: yes
Name of tests cases on NCAR Mass-Store: /JET/csm/prgcld01
Changes made:

        Prognostic cloud-water and sulfur cycle put on the CCM development trunk.
Changes are huge, in essense this puts ccm3_6_20_brnchT_scycRad1_13 on the
trunk.  Standard mode to run is now with 30 levels and with the NOAA Ozone
dataset. So use: SEP1.T42L30_diffPHIS.0599.nc and noaao3.1990.21999.nc.
Using these datasets readtrace must be set to FALSE and normal operation
is with cldw_adv TRUE.  To build you must put the "src/scyc" directory in
your path (optionally you can checkout the dscyc module which has dummy
stub routines for the sulfur codes).  The default operation is without any
of the sulfur cycle stuff turned on.

        Caveat's:  MODEL DOES NOT WORK WITH SPMD MODE!
                    CSM was tested to ensure it works, but there were
        changes that haven't had a long simulation done to verify they
        are working correctly.

        SLD mode was tested to ensure it works, but long simulations 
        were not performed.

        Model tested on SGI, Cray, and Sun. But, the most extensive testing
        was on the SGI (ute).

        SOM not tested.  Only dom mode was tested.

        A change was put into the LSM for arbitrary initialization. The
        change is bit-for-bit when not using arbitrary initialization.
        But, new spin-up datasets have not been created nor long-simulations
        with the change (the change makes points southward of 60S land ice and 
        initializes them with a snow depth of 1m).

        Current version does not work with the 44 mid-atmosphere model.

        (a fix is on the way soon).

        Sulfur code has it's own version of the solar zenith angle.  This
        routine is incompatible with the version in csm_share.  This means
        the model should not be used for Paleo simulations, with sulfur cycle
        turned on.
        (a fix is on the way soon).

===============================================================

























































